软件,学报,
JOURNAL,OF,SOFTWARE
1999,10,卷,Vol,10,No,1999



,双,粒度,协议,hint,启发,启发式,发式,缓存,替换,替换算法,换算,算法,王,建,勇,祝,明,发,徐,志,伟,摘要,合作,式,缓存,技术,提高,机群,机群文件,群文,文件,文件系统,系统,系统性,性能,关键,关键技术,技术,s2fs,scalable,single,image,file,system,一个,单一,映像,机群,机群文件,群文,文件,文件系统,系统,原型,利用,双,粒度,协议,实现,符合,严格,UNIX,语义,合作,式,缓存,该文,s2fs,设计,hint,启发,启发式,发式,缓存,替换,替换算法,换算,算法,并为,建立,性能,分析,分析模型,模型,分析,结果表明,表明,同现,现有,合作,式,缓存,替换,替换算法,换算,算法,N,chance,相比,启发,启发式,发式,算法,几乎,有情,情况,有效,降低,I,O,响应,时间,关键,关键词,启发,启发式,发式,缓存,替换,替换算法,换算,算法,N,chance,算法,双,粒度,协议,s2fs,scalable,single,image,file,system,合作,式,缓存,中图,中图法,图法,分类,分类号,TP316
Hint,based,Heuristic,Cache,Replacement,Algorithm,under,Dual,granularity,Protocol
WANG,Jian,yong1,ZHU,Ming,fa2,XU,Zhi,wei2,3
1,Department,of,Computer,Science,and,Technology,Beijing,University,Beijing,100871,National,Research,Center,for,Intelligent,Computing,Systems,Beijing,100080,Institute,of,Computing,Technology,The,Chinese,Academy,of,Sciences,Beijing,100080,
Abstract,Cooperative,caching,is,one,of,the,key,technologies,used,to,improve,the,performance,of,a,cluster,file,system,s2fs,scalable,single,image,file,system,a,single,image,cluster,file,system,prototype,uses,dual,granularity,cache,coherence,protocol,in,order,to,implement,efficient,cooperative,caching,which,meets,the,needs,for,strict,UNIX,semantics,In,this,paper,a,hint,based,heuristic,cache,replacement,algorithm,under,s2fs,dual,granularity,protocol,is,proposed,and,the,analytical,models,are,established,for,heuristic,algorithm,and,one,of,the,existing,coordinated,algorithm,N,chance,The,analytical,results,show,that,the,heuristic,algorithm,can,effectively,reduce,the,I,O,response,time,compared,with,N,chance,algorithm,almost,in,each,case,
Key,words,Heuristic,cache,replacement,algorithm,N,chance,algorithm,dual,granularity,protocol,s2fs,scalable,single,image,file,system,cooperative,caching,越来,越来越,越多,分布,分布式,分布式系统,布式,系统,利用,高性,高性能,性能,网络,计算,节点,连接,连接起来,接起,起来,远程,内存,正日,日益,成为,一种,新型,内存,结构,结构层,层次,高带宽,带宽,低,时延,网络,远程,内存,访问,比本,地磁,磁盘,快得多,这种,远程,缓存,结构,remote,caching,architecture,强调,存储,储层,层次,内存,远程,内存,磁盘,之间,性能,差异,允许,系统,中所,节点,互相,存取,内存,充分,充分利用,分利,利用,远程,内存,这种,对称,式,结构,显然,不同,不同于,同于,传统,客户,服务,服务器,务器,模型,许多文,文献,称为,合作,式,缓存,cooperative,caching,国家,智能,中心,正在,研制,机群,机群文件,群文,文件,文件系统,系统,COSMOS,保证,提供,单一,一系,系统,映像,功能,达到,提高,I,O,可扩展性,扩展,扩展性,展性,目的,采用,合作,式,缓存,技术,目前,COSMOS,系统,原型,开发,发完,完毕,未来,成熟,COSMOS,系统,区别,称,目前,COSMOS,原型,系统,s2fs,Scalable,Single,image,File,System,s2fs,双,粒度,协议,s2fs,一个,扩展,单一,映像,文件,文件系统,系统,s2fs,AIX,操作,操作系统,系统,实现,全局,文件,文件系统,系统,具备,严格,单一,映像,功能,实现,unix,文件,文件共享,共享,语义,改动,AIX,核心,前提,提下,保证,unix,应用,应用程序,程序,完全,二进制,进制,兼容,s2fs,获得,可扩展性,扩展,扩展性,展性,I,O,性能,实现,合作,式,缓存,并行,分布,分布式,布式,元,数据,数据管理,管理,并行,存储,功能,s2fs,核心,相关,层,主体,两部,部分,分组,组成,s2fs,核心,核心层,虚拟,拟文,文件,文件系统,系统,统一,一级,中实,实现,主要,接收,收来,逻辑,逻辑文件,文件,文件系统,系统,I,O,请求,s2fs,用户,层,用户,级,daemon,构成,协调,工作,共同,共同完成,完成,s2fs,相关,I,O,操作,daemon,别称,称为,客户,client,管理,管理器,理器,manager,存储,存储器,storage,应用,应用程序,程序,发出,s2fs,相关,系统,调用,经由,逻辑,逻辑文件,文件,文件系统,系统,统和,虚拟,拟文,文件,文件系统,系统,I,O,请求,传给,s2fs,客户,I,O,请求,不能,客户,得到,满足,转发,转发给,发给,管理,管理器,理器,管理,管理器,理器,通知,相应,客户,存储,存储器,完成,文件,操作,转发,转发给,发给,客户,虚拟,拟文,文件,文件系统,系统,统和,逻辑,逻辑文件,文件,文件系统,系统,返回,应用,应用程序,程序,图,给出,s2fs,系统,组织,结构,

,图,s2fs,系统,透视,透视图,视图,双,粒度,协议,分布,分布式,分布式文件系统,布式,文件,文件系统,系统,粗粒度,粒度,缓存,一致,一致性,协议,容易,造成,造成数,成数,数据,读写,共享,问题,细粒,细粒度,粒度,一级,维护,缓存,一致,一致性,服务,服务器,务器,带来,太多,负担,产生,生过,不必,不必要,必要,开销,粗粒度,粒度,细粒,细粒度,粒度,两个,级别,维护,缓存,一致,一致性,弥补,双方,不足,不足之处,之处,s2fs,设计,实现,双,粒度,协议,事实,事实上,粒度,协议,双,粒度,协议,下列,好处,降低,维护,缓存,一致,一致性,引起,服务,服务器,服务器端,务器,端的,工作,负载,能够,减少,客户,服务,服务器,务器,通信,更为,更为重要,为重,重要,能够,提供,hint,信息,文件,文件系统,系统,以利,利用,hint,信息,进一步,一步,缓和,和服,服务,服务器,务器,负担,网络,开销,s2fs,块,和文,文件,两个,粒度,维护,缓存,一致,一致性,xFS,类似,s2fs,块,一级,利用,读,写,令牌,维护,缓存,一致,一致性,不再,赘述,文件,一级,s2fs,利用,回调,callback,机制,维护,缓存,一致,一致性,一个,客户,打开,一个,文件,不存,存在,并发,共享,写,concurrent,write,sharing,管理,管理器,理器,赋予,客户,一个,打开,文件,回调,允诺,客户,冲突,方式,打开,该文,文件,会通,通知,客户,放弃,回调,callback,break,客户,关闭,写,方式,打开,文件,而使,该文,文件,不再,处于,写,共享,状态,管理,管理器,理器,重新,赋予,目前,正处,处于,打开,该文,文件,状态,客户,一个,回调,实现,s2fs,双,粒度,协议,回调,状态,存放,放在,一个,回调,结构,结构,记录,文件,索引,引号,目前,正处,处于,打开,该文,文件,状态,客户,户数,数目,文件,长度,文件,磁盘,盘上,位置,存储,分组,组,号,起始,节点,号,信息,能够,降低,块,定位,block,lookup,维护,缓存,一致,一致性,开销,hint,用于,缓存,替换,提高,I,O,操作,性能,启发,启发式,发式,缓存,替换,替换算法,换算,算法,相关,研究,合作,式,缓存,存为,文件,文件系统,系统,存储,储层,层次,引入,一个,新,层次,远程,客户,户内,内存,不同,客户,缓存,算法,不同,方式,管理,一新,存储,储层,层次,Daulin,M,D,文献,阐述,几种,主要,合作,式,缓存,算法,N,chance,转发,算法,最为,现实,可行,性能,最好,合作,式,缓存,算法,算法,客户,I,O,行为,动态,调整,合作,式,管理,那部,部分,缓存,大小,主要,思想,优先,缓存,孤本,缓存,块,整个,系统,缓存,一个,副本,一个,客户,替换,一个,孤本,直接,扔掉,随机,选择,一个,客户,孤本,转发,转发给,发给,允许,孤本,最多,N,转发,机会,实现,N,chance,算法,通常,附加,限制,措施,施以,以防,防止,涟漪,效应,转发,孤本,引起,一个,孤本,转发,启发,启发式,发式,缓存,替换,替换算法,换算,算法,N,chance,算法,法利,利用,孤本,优先,策略,减少,系统,缓存,同一,一块,缓存,拷贝,拷贝数,数目,扩大,系统,有效,缓存,空间,不足,不足之处,之处,每次,发生,缓存,替换,替换,块,客户,转发,发过,发过来,孤本,客户,询问,管理,管理器,理器,判断,替换,块,是否,孤本,增加,网络,开销,替换,响应,时间,转发,孤本,缓存,块,算法,随机,选择,将要,接收,孤本,目的,客户,没有,考虑,系统,客户,存取,模式,近期,存取,转发,孤本,概率,状态,空闲,程度,不加,加区,区别,转发,孤本,事实,事实上,孤本,缓存,块,近期,永远,不会,存取,孤本,转发,变得,毫无,毫无意义,无意,意义,设计,启发,启发式,发式,缓存,替换,替换算法,换算,算法,以下,简称,称为,启发,启发式,发式,算法,维护,利用,hint,信息,克服,N,chance,算法,上述,缺点,一种,增强,增强型,N,chance,算法,启发,启发式,发式,算法,hint,信息,双,粒度,协议,如在,客户,客户端,文件,是否,处于,打开,开状,状态,是否,处于,共享,打开,开状,状态,hint,信息,需要,启发,启发式,发式,算法,做,额外,工作,一类,hint,信息,缓存,块,是否,孤本,客户,管理,管理器,理器,共同,同来,维护,实现,启发,启发式,发式,算法,客户,客户端,端的,缓存,状态,状态表,增加,一项,有效,缓存,块,孤本,状态,标志,ncbc,number,of,cache,block,copies,表示,孤本,表示,系统,缓存,块,多个,缓存,拷贝,客户,客户端,进行,缓存,替换,关心,替换,块,是否,孤本,ncbc,标志,足以,满足,缓存,替换,要求,系统,缓存,块,拷贝,拷贝数,数目,管理,管理器,理器,维护,缓存,一致,一致性,记录,ncbc,维护,方法,缓存,块,存储,存储器,磁盘,盘上,读,写到,缓存,中时,ncbc,置,孤本,状态,ncbc,客户,之间,转发,数据,块,双方,ncbc,置,表示,系统,多个,拷贝,一个,客户,执行,完,写,操作,管理,管理器,理器,写,数据,块,客户,客户端,端的,缓存,块拷贝,拷贝,变为,无效,写,数据,块,变为,孤本,状态,ncbc,客户,执行,缓存,替换,整个,系统,块,缓存,拷贝,拷贝数,数目,变为,管理,管理器,理器,通知,拥有,孤本,缓存,块,客户,数据,块,ncbc,置,孤本,状态,ncbc,假设,一时,时刻,系统,i,客户,j,块,被选为,选为,替换,对象,标记,记为,bij,bij,所属,文件,标记,记为,f,bij,所处,状态,可能,A,bij,客户,转发,发来,孤本,A,bij,尚未,转发,N,A,bij,转发,N,B,目前,无任,客户,处于,打开,f,状态,意味,意味着,bij,近期,永远,不会,引用,C,f,正处,处于,打开,开状,状态,C,客户,打开,f,C,系统,k,k,客户,处于,打开,f,状态,C,bij,ncbc,等于,C,bij,ncbc,等于,启发,启发式,发式,算法,bij,处于,A,B,C,状态,一时,无需,转发,直接,bij,丢弃,bij,处于,状态,A,C,客户,i,随机,选择,一个,客户,X,bij,转发,转发给,发给,X,bij,处于,C,状态,客户,i,告诉,管理,管理器,理器,目前,转发,替换,块,bij,管理,管理器,理器,修改,完,缓存,状态,状态表,客户,i,发送,应答,消息,应答,消息,包含,将要,接收,bij,目的,客户,Y,Y,一个,正在,使用,f,客户,处于,打开,f,状态,客户,i,收到,应答,bij,转发,转发给,发给,客户,Y,启发,启发式,发式,算法,hint,信息,客户,判断,bij,是否,孤本,无需,管理,管理器,理器,联系,N,chance,算法,法相,相比,B,C,状态,启发,启发式,发式,算法,能够,节省,一对,网络,传输,启发,启发式,发式,算法,能够,客户,回调,结构,判断,替换,换文,文件,目前,是否,客户,正在,使用,没有,客户,使用,处于,B,状态,bij,孤本,转发,而使,系统,合作,式,缓存,存放,更多,有效,数据,块,C,状态,需要,征求,管理,管理器,理器,意见,浪费,一对,网络,传输,增加,转发,孤本,缓存,命中,命中率,分析,分析模型,模型,评价,启发,启发式,发式,算法,性能,启发,启发式,发式,算法,N,chance,算法,建立,分析,分析模型,模型,二者,性能,进行,比较,简单,分析,分析模型,模型,对读,操作,响应,时间,做,合理,系统,读,操作,占,比例,较大,影响,系统,系统性,性能,主要,因素,假设,一次,读,操作,不同,存储,储层,层次,可得,得到,满足,概率,缓存,命中,命中率,Pl,远程,命中,命中率,Pr,磁盘,命中,命中率,Pd,请求,不同,存储,储层,层次,得到,满足,响应,时间,Tl,Tr,Td,缓存,替换,所用,时间,T,替换,读,操作,平均,响应,时间,T,响应,下列,公式,成立,
Pl+Pr+Pd,
T,响应,Pl,Tl+Pr,Tr+Pd,Td+,Pl,T,替换,下面,缓存,替换,影响,性能,几个,主要,主要参数,参数,Rct,合作,式,缓存,用于,存放,客户,转发,发来,孤本,缓存,占,整个,客户,客户端,缓存,比例,Rnl,近期,不会,引用,缓存,块,占,缓存,包含,合作,式,缓存,比例,Pso,文件,处于,共享,打开,开状,状态,概率,Psgl,缓存,处于,共享,打开,开状,状态,文件,缓存,块,孤本,ncbc,概率,Pk2,客户,处于,打开,f,状态,系统,两个,客户,处于,打开,f,状态,概率,Psr,数据,块,共享,读,概率,客户,i,孤本,bij,转发,转发给,发给,客户,Y,中客,客户,i,Y,处于,打开,f,状态,客户,Y,读,命中,概率,N,N,chance,算法,远程,缓存,命中,命中率,Pr,缓存,命中,命中率,Pl,比值,下式,成立,当在,N,chance,算法,下发,发生,缓存,替换,替换,块,bij,客户,转发,发来,孤本,客户,管理,管理器,理器,发送,消息,询问,bij,是否,孤本,共,需要,两次,请求,应答,网络,传输,假设,一次,网络,传输,时间,指,消息,时延,Thop,N,chance,算法,替换,开销,
TN,替换,Rct,Thop,式,代入,式,得到,N,chance,算法,读,操作,响应,时间,
TN,chance,T1,Td+N,Tr,Td,Rct,Thop,Pl+Td+2,Rct,Thop,PA,PB,PC,PC1,PC2,PC21,PC22,表示,缓存,替换,替换,块,处于,状态,A,B,C,C,C,C,C,概率,节,替换,块状,状态,本节,中影,影响,性能,主要,主要参数,参数,定义,下列,公式,成立,
PB+PC,Rct,
PC,PB+PC,Rnl,Rct,Rnl,
PC1,PC,Pso,
PC2,PC,Pso,
PC21,PC2,Psgl,10,
PC22,PC2,Psgl,11,当在,启发,启发式,发式,算法,进行,缓存,替换,bij,处于,状态,C,引起,两次,网络,传输,处于,C,状态,k,管理,管理器,理器,应,通知,客户,缓存,块,变为,孤本,引起,网络,传输,启发,启发式,发式,算法,替换,开销,
T,替换,PC21,Thop+PC22,Pk2,Thop,12,Pl,启,Pr,启,启发,启发式,发式,算法,远程,缓存,命中,命中率,N,chance,算法,法相,相比,启发,启发式,发式,算法,状态,C,转发,孤本,能够,增加,命中,命中率,不会,改变,缓存,命中,命中率,包括,远程,以下,下列,公式,成立,
Pl,启,+Pr,启,Pl+Pr,13,
Pl,启,Pl+PC21,Psr,14,式,式,14,代入,式,可得,得到,
T,启发,TN,chance+,Tl,Tr,Pl,Rct,Rnl,Pso,Psgl,Psr+,Pl,Rct,Thop,Rct,Rnl,Pso,Psgl,Psr,Rnl,Pso,Psgl+,Psgl,Pk2,15,性能,评价,s2fs,系统,平台,台中,节点,之间,10Mbit,s,以太,以太网,互连,系统,系统配,系统配置,统配,配置,基本,假设,取自,文献,中关,以太,以太网,数据,缓存,块,大小,8Kbytes,内存,存取,存取时间,时间,250,s,网络,时延,Thop,200,s,块,数据,传输,时间,250,s,磁盘,读取,一块,数据,时间,14,800,s,Tl,25ms,文献,不同,本文,文中,Tr,1ms,Td,21,9ms,系统,中元,数据,管理,数据,存储,和缓,缓存,分开,远程,缓存,磁盘,盘上,存取,存取数据,数据,要用,网络,传输,影响,读,操作,作响,响应,时间,参数,取值,处理,每个,参数,取,组,下限,限值,标准,标准值,上限,限值,参数,Rct,Pl,N,Rnl,Pso,Pk2,是从,文献,分析,得来,Pl,N,一块,取值,二者,相关,Pl,变大,N,往往,变小,Pl,变小,小时,N,往往,变大,Psr,Psgl,取,10,50,90,下限,限值,标准,标准值,上限,限值,影响,性能,主要,主要参数,参数,取值,情况,表,表,影响,系统,系统性,性能,参数,取值,范围,

,RctPl,NRnlPsoPk2PsrPsgl
,下限,限值,050,67,2120,050,400,020,100,10
,标准,标准值,300,78,180,150,650,060,500,50
,上限,限值,550,94,040,250,900,100,900,90


,参数,Rct,Pl,N,Rnl,Pso,Pk2,Psr,Psgl,不同,取值,组合,代入,公式,15,得到,N,chance,算法,启发,启发式,发式,算法,一次,读,操作,响应,时间,分析,结果表明,表明,参数,取,不同,读,操作,响应,时间,启发,启发式,发式,算法,N,chance,算法,不同,程度,降低,参数,取,标准,标准值,启发,启发式,发式,算法,法相,N,chance,算法,读,操作,响应,时间,能够,降低,Rct,Rnl,Pk2,取下,下限,限值,Pl,N,取,标准,标准值,Pso,Psr,Psgl,取,上限,限值,启发,启发式,发式,算法,读,操作,响应,时间,降低,34,885,坏,情况,Rct,Pl,Rnl,Pk2,取,上限,限值,Pso,N,Psr,Psgl,取下,下限,限值,启发,启发式,发式,算法,法相,N,chance,算法,能够,读,操作,响应,时间,降低,085,图,说明,一点,

,图,两种,算法,性能,性能比,能比,比较,图,考察,Rct,Pl,N,取,标准,标准值,Rnl,Pso,Pk2,Psr,Psgl,取,不同,启发,启发式,发式,算法,影响,图,看出,Pso,Psr,Psgl,取值,启发,启发式,发式,算法,对读,操作,作响,响应,时间,改进,Rnl,Pk2,取值,启发,启发式,发式,算法,对读,操作,作响,响应,时间,改进,影响,程度,不大,图,说明,Rnl,Pso,Pk2,Psr,Psgl,取,降低,I,O,响应,时间,启发,启发式,发式,算法,优于,N,chance,算法,

,图,Rnl,Pso,Pk2,Psr,Psgl,取值,启发,启发式,发式,算法,影响,本文,s2fs,系统,双,粒度,协议,基础,提出,一种,hint,启发,启发式,发式,合作,缓存,替换,替换算法,换算,算法,分析,分析模型,模型,说明,启发,启发式,发式,算法,现有,N,chance,算法,降低,I,O,响应,时间,面有,进一步,一步,改善,今后,s2fs,系统,实现,启发,启发式,发式,算法,并用,实际,应用,测试,启发,启发式,发式,算法,I,O,性能,改进,注,本文,研究,得到,国家,国家自然科学基金,自然,自然科,自然科学,科学,科学基金,基金,金和,国家,863,高科技,科技,项目,基金,资助,本文,通讯,通讯联系,联系,联系人,王,建,勇,北京,100871,北京,北京大学,大学,计算,计算机,计算机科学,算机,科学,技术,系,网络,分布,系统,研究,研究室,作者,作者简介,简介,王,建,勇,1969,生,博士,博士生,主要,研究,领域,并行,分布,处理,祝,明,发,1945,生,博士,研究,研究员,博士,博士生,导师,主要,研究,领域,高性,高性能,性能,计算,计算机,计算机系,计算机系统,算机,机系统,系统,网络,徐,志,伟,1956,生,博士,研究,研究员,博士,博士生,导师,主要,研究,领域,并行,并行计算,计算,计算机,计算机系,计算机系统,算机,机系统,系统,作者,单位,王,建,勇,北京,北京大学,大学,计算,计算机,计算机科学,算机,科学,技术,系,北京,100871
,祝,明,发,徐,志,伟,国家,智能,计算,计算机,算机,研究,开发,中心,北京,100080
,王,建,勇,祝,明,发,徐,志,伟,中国,中国科学院,中国科学院计算技术研究所,科学,科学院,学院,计算,计算技术,技术,研究,研究所,北京,100080
,参考,参考文献,文献,Leff,Avraham,Wolf,Joel,L,Yu,Philip,S,Replication,algorithms,in,a,remote,caching,architecture,IEEE,Transactions,on,Parallel,and,Distributed,Systems,1993,11,1185,1204
,Anderson,T,E,et,al,Serverless,network,file,systems,ACM,Transactions,on,Computer,Systems,1996,14,41,79
,Dahlin,M,D,et,al,Cooperative,caching,using,remote,client,memory,to,improve,file,system,performance,In,Proceedings,of,the,1st,Symposium,on,Operating,Systems,Design,and,Implementation,Berkeley,CA,USENIX,Association,1994,276,280
,Baker,M,G,et,al,Measurements,of,a,distributed,file,system,ACM,Operating,Systems,Review,1991,25,198,212
,Blaze,M,A,Caching,in,large,scale,distributed,file,systems,Ph,D,Thesis,Department,of,Computer,Science,Princeton,University,1993
,本文,1998,07,20,收到,原稿,1998,09,07,收到,修改,修改稿,改稿