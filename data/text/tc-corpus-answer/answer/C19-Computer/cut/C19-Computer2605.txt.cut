软件,学报,
JOURNAL,OF,SOFTWARE
1999,10,卷,Vol,10,No,1999



,RPC,机制,容错,计费,系统,设计,实现,杨家,海,吴建平,建平,摘要,网络,计费,管理,商业,商业化,计算,计算机,计算机网,计算机网络,算机,网络,重要,网络,网络管理,管理,功能,Internet,商业,商业化,进程,推进,企业,Intranet,广泛,发展,应用,网络,计费,管理,需求,越来,越来越,迫切,计费,系统,一个,基本,要求,高效,可靠,文章,提出,一个,RPC,通信,机制,容错,计费,系统,FTCharge,fault,tolerant,charge,简述,计费,基本,原理,以后,着重,论述,FTCharge,总体,结构,容错,机制,实现,关键,关键词,计算,计算机,计算机网,计算机网络,算机,网络,Internet,网络,网络管理,管理,SNMP,simple,network,management,protocol,计费,管理,RPC,remote,procedure,call,中图,中图法,图法,分类,分类号,TP393
,
Design,and,Implementation,of,an,RPC,based,Fault,tolerant,
Accounting,Management,System
YANG,Jia,hai,WU,Jian,ping
,Department,of,Computer,Science,and,Technology,Tsinghua,University,Beijing,100084,Network,Research,Center,Tsinghua,University,Beijing,100084,Abstract,Network,accounting,management,is,the,important,management,function,of,commercialized,computer,network,With,the,commercialization,of,Internet,and,the,occurrence,of,lots,of,Intranets,it,s,urgent,to,develop,network,accounting,management,system,A,principal,requirement,of,such,systems,is,efficiency,and,reliability,A,fault,tolerant,accounting,system,based,on,RPC,remote,procedure,call,mechanism,FTCharge,fault,tolerant,charge,is,proposed,in,this,paper,After,the,brief,discussion,of,the,accounting,principle,the,design,of,the,architecture,and,the,fault,tolerance,mechanism,of,FTCharge,system,are,discussed,Key,words,Computer,network,Internet,network,management,SNMP,simple,network,management,protocol,accounting,management,RPC,remote,procedure,call,信息,社会,网络,依赖,程度,度越,越来,越来越,高,网络,高效,可靠,运行,行管,管理,越来,越来越,越来越重,重要,网络,互连,技术,网络,网络管理,管理,正在,标准,标准化,方向,发展,网络,网络管理,管理,技术,研究,发展,标准,标准化,国际,国际标准,国际标准化组织,标准,标准化,组织,ISO,Internet,体系,体系结构,结构,委员,委员会,下属,工作,工作组,做,卓有,卓有成效,有成,成效,工作,早在,20,世纪,70,年代,末,国际,国际标准,国际标准化组织,标准,标准化,组织,提出,开放,开放系统,系统,互连,参考,参考模型,模型,OSI,RM,open,system,interconnection,reference,model,提出,网络,网络管理,管理,标准,框架,开放,开放系统,系统,互连,连管,管理,框架,ISO,7498,制定,相应,协议,议标,标准,公共,共管,管理,信息,服务,公共,共管,管理,信息,协议,CMIS,CMIP,common,management,information,service,common,management,information,protocol,开放,开放系统,系统,互连,连管,管理,框架,ISO7498,网络,网络管理,管理,划分,分为,大功,功能,功能域,配置,配置管理,管理,失效,管理,性能,管理,计费,管理,安全,管理,框架,基础,Internet,体系,体系结构,结构,委员,委员会,提出,相应,网络,网络管理,管理,标准,简单,简单网络,网络,网络管理,管理,协议,SNMP,simple,network,management,protocol,网络,计费,管理,商业,商业化,计算,计算机,计算机网,计算机网络,算机,网络,重要,管理,功能,早期,Internet,网络,一个,学术,学术研究,研究,网络,网络,网络管理,管理,技术,发展,滞后,尤其,计费,管理,更,未,得到,应有,重视,Internet,商业,商业化,进程,推进,Intranet,广泛,发展,应用,网络,计费,管理,需求,日益,日益突出,突出,满足,这种,需求,网络,运行,主管,主管部门,部门,自行,开发,计费,软件,计费,软件,基本,基本上,单机,机运,运行,该机,出现,故障,连接,该机,局部,网络,中断,丢失,失计,计费,计费数据,数据,造成,直接,经济,经济损失,损失,确保,计费,系统,高效,可靠,运行,一个,亟待,亟待解决,解决,问题,提高,高可靠性,可靠,可靠性,一个,直接,接办,办法,多个,计费,系统,时运,运行,大型,网络,计费,计费数据,数据,数据量,很大,计费,计费数据,数据,动态,动态变化,变化,不可,重复,复出,出现,保证,几个,备份,计费,系统,之间,同步,协调,工作,成为,这类,计费,系统,先要,解决,问题,本文,提出,一个,RPC,机制,容错,计费,系统,FTCharge,fault,tolerant,charge,本文,简述,计费,基本,以后,着重,论述,FTCharge,总体,结构,容错,机制,实现,费,原理,计费,基本,用户,使用,网络,网络资源,资源,情况,信息,传输,量,占用,线路,时间,专用,租,线,最常,常用,方法,每个,用户,网络,使用,信息,传输,量,通常,称为,计费,计费数据,数据,计算,费用,计费,计费数据,数据,获取,两种,方式,一种,标准,SNMP,操作,获取,一种,总线,监听,听来,获取,Internet,标准,标准网,网络,网络管理,管理,协议,SNMP,定义,基本,网络,网络管理,管理,操作,定义,一系,一系列,系列,列支,支持,持操,操作,语义,管理,信息,变量,MIB,management,information,base,计费,相关,MIB,变量,管理,管理对象,对象,通常,连接,网络,外部,网络,边界,路由,路由器,适当,配置,对象,自动,自动记录,记录,路由,路由器,进出,流量,Cisco,路由,路由器,记录,计费,信息,下格,格式,一张,表,
Source,IP,Address
202,120,186,45
202,121,Destination,IP,Address
206,15,106,131
207,68,156,49
,nPkts
23
19
,nBytes
4,080
1,267
,

,一个,个数,数据,数据包,路由,路由器,过时,路由,路由器,搜索,表,是否,相匹配,匹配,Source,IP,Address,Destination,IP,Address,找到,匹配,记录,累加,创建,一个,新,记录,记录,SNMP,标准,操作,获得,一种,计费,计费数据,数据,获取,方法,利用,用以,以太,以太网,总线,广播,特性,网络,网络连接,连接,适当,地方,接入,一个,被动,接听,听信,信息,设备,运行,一个,截获,数据,数据包,包头,软件,过分,分析,数据,数据包,包头,信息,得到,用户,使用,网络,信息,进出,流量,流量,类型,telnet,ftp,http,mail,上述,两种,计费,计费数据,数据,获取,方法,各有利弊,有利,利弊,方法,标准,方式,SNMP,操作,即可,实现,无需,额外,设备,投资,这种,方法,一个,缺点,计费,计费数据,数据,粒度,粗,计,IP,级,用户,只能,能知,知道,通信,通信量,字节,字节数,节数,方式,好处,用户,需要,指定,定计,计费,计费数据,数据,粒度,获取,通信,通信量,知道,种业,业务,类型,占用,有利,有利于,利于,用户,不同,流量,类型,采取,不同,收费,标准,有利,有利于,利于,用户,就近,配置,适合,资源,缺点,缺乏,标准,需,额外,设备,投资,依赖,依赖于,赖于,网络,网络拓扑,拓扑,结构,用户,应用,需要,选择,一种,系统,总体,结构,FTCharge,系统,RPC,通信,为主,分布,分布式,布式,计费,系统,系统,总体,结构,图,所示,

,图,FTCharge,系统,总体,结构,整个,FTCharge,计费,系统,统由,管理,监控,子系统,系统,主计,计费,系统,统和,多个,备份,计费,系统,组成,管理,监控,子系统,系统,Monitors,主要,功能,监视,主计,计费,系统,统和,备份,计费,系统,工作,情况,发现,主计,计费,系统,出现,故障,系统,预先,设定,策略,自动,动地,多个,备份,计费,系统,中选,选出,一个,正常,工作,系统,启动,该系,系统,接替,计费,计费数据,数据,采集,工作,发现,主计,计费,系统,故障,已经,修复,正常,工作,自动,停止,备份,计费,系统,工作,确保,任一,一时,时刻,计费,系统,工作,Monitors,ICMP,一个,进程,监视,工具,监视,计费,系统,网络,网络连接,连接,主机,系统,进程,是否,正常,工作,计费,子系统,系统,整个,FTCharge,核心,负责,计费,计费数据,数据,采集,处理,加工,工作,理论,讲,工作,一个,系统,实现,考虑,计费,计费数据,数据,可能,存在,多个,主机,机上,维护,数据,完整,完整性,一致,一致性,数据,采集,后续,加工,处理,分开,专门,设置,一个,个数,数据,数据库,据库,服务,服务器,务器,加工,处理,主机,计费,计费数据,数据,做,有利,有利于,利于,数据,采集,系统,集中,集中力,集中力量,力量,收集,集数,数据,事实,事实上,计费,计费数据,数据,采集,实时,实时性,强,计费,计费数据,数据,读取,之前,需,缓冲,缓冲区,暂存,缓冲,缓冲区,存,满,之后,后续,数据,不再,写入,数据,采集,系统,在读,读取,读取数据,数据,之后,负责,清空,缓冲,缓冲区,任一,一时,时刻,允许,一个,个数,数据,采集,系统,进行,行数,数据,采集,引起,起数,数据,完整,完整性,不一,不一致性,一致,一致性,丢失,数据,备份,系统,功能,主计,计费,系统,完全,正常,常情,情况,处于,空闲,idle,状态,主,系统,出现,故障,收到,到来,监控,子系统,系统,指令,并进,进入,工作,active,状态,完成,主计,计费,系统,完全,工作,容错,容错性,实现,容错,容错性,实现,提高,计费,系统,系统可靠性,可靠,可靠性,关键,本系,系统,采用,远程,过程,调用,RPC,remote,procedure,call,分布,分布式,布式,监视,控制,控制机,机制,实现,系统,容错,容错性,计费,系统,监视,控制,监控,子系统,系统,实现,监控,子系统,系统,逻辑,分成,几个,步骤,监视,主计,计费,系统,网络,主机,系统,运行,行情,情况,主计,计费,系统,发生,故障,选择,一个,可用,备份,计费,系统,启动,监视,当前,当前工作,工作,备份,计费,系统,继续,监视,主计,计费,系统,故障,恢复,情况,当前,运行,备份,计费,系统,发生,故障,剩下,备份,计费,系统,中选,选择,一个,可用,系统,启动,主计,计费,系统,已经,恢复,恢复正常,正常,常时,停止,备份,计费,系统,工作,更好,描述,监控,控系统,系统,工作,作过,过程,下面,半,形式,形式化,语言,描述,实现,算法,
Monitors,算法,
BEGIN
,定义,主计,计费,系统,Primary,备份,计费,系统,数量,NUM,定义,备份,计费,系统,集,Backup,NUM,定义,最大,重试,次数,MaxRetry,WHILE,TRUE,不间断,间断,运行,Result,Test,Primary,测试,主计,计费,系统,运行,行情,情况,IF,Result,ok,THEN,主计,计费,系统,正常,sleep,a,while,隔,一段,一段时间,段时间,时间,继续,测试,continue,ELSE
,Result,failed,当前,测试,失败,i,一次,失败,不足,不足以,足以,以下,下结论,结论,WHILE,i,MaxRetry,Result,Test,Primary,IF,Result,ok,瞬时,瞬时性,间断,现在,恢复,THEN
,i,MaxRetry+1,跳出,循环,ELSE
,i,i+1,进行,一次,次测试,测试,IF,i,MaxRetry+1,THEN
,sleep,a,while,continue,ELSE,MaxRetry,次测试,测试,故障,认为,该系,系统,确实,实发,发生,故障,x,WHILE,x,NUM,备份,系统,中选,选择,一个,IF,Backup,x,is,OK,THEN
,RPC,start,Backup,x,远程,过程,调用,启动,备份,系统,X,startmonitorB,Backup,x,X,进行,监视,monitorP,Primary,继续,监视,主计,计费,系统,了解,修复,情况,exit,END,of,Outer,WHILE,END
,启动,备份,系统,监视,流程,相似,故障,主计,计费,系统,进行,跟踪,监视,过程,相似,只不过,判断,条件,执行,动作,正好,限于,篇幅,不再,重复,计费,子系统,系统,真正,完成,计费,计费数据,数据,采集,处理,加工,统计,最终,终生,生成,成报,报表,帐单,工作,计费,子系统,系统,设计,计费,子系统,系统,关系,关系数据,关系数据库,系数,数据,数据库,据库,核心,数据,采集,预处理,处理,计费,计费数据,数据,数据处理,处理,计费,信息,查询,几个,模块,组成,组成,结构,图,所示,

,图,计费,子系统,系统,组成,结构,多方,论证,目前,阶段,决定,实现,方式,数据,采集,功能,将来,采用,方式,总线,监听,数据,采集,留出,扩展,接口,计费,计费数据,数据,小时,单位,形成,成数,数据,数据文件,文件,预处理,处理,模块,定期,接收,并处,处理,文件,预处理,处理,模块,分析,数据,数据文件,文件,文件格式,格式,正确,正确性,IP,地址,合法,合法性,做,初步,统计,累加,工作,最后,形成,成数,数据,数据库,据库,记录,并入,入库,计费,计费数据,数据,数据处理,处理,模块,功能,对数,数据,数据库,据库,数据,进行,行进,进一步,一步,加工,处理,生成,适用,用于,专门,需求,数据,数据,报表,帐单,形式,打印,印出,印出来,数据,报表,用户,不同,要求,灵活,指定,特定,网段,数据,汇总,汇总表,总表,分项,项数,数据,汇总,汇总表,总表,IP,地址,流量,明细,明细表,统计,计分,分类,明细,明细表,计费,帐单,计费,信息,查询,模块,主要,功能,向用,用户,提供,计费,相关,种数,数据,查询,计费,系统,中保,保存,存着,连网,单位,用户,计费,计费数据,数据,计费,系统,应该,允许,帐单,疑问,连网,用户,查询,核实,单位,个人,IP,地址,对外,通信,流量,情况,计费,系统,统还,保存,存着,连网,单位,信息,最新,精确,IP,地址,分配,分配情况,情况,信息,信息,网络,网络管理,管理,管理人员,人员,开放,具备,一定,条件,权限,其他用户,他用,用户,开放,计费,信息,查询,模块,实现,最大,大限,大限度,限度,实现,计费,信息,分布,分布式,布式,查询,计费,信息,查询,模块,采用,WEB,技术,实现,使用,用户,查询,直接,接通,WEB,Browser,Netscape,进行,结束,结束语,已经,实现,一个,上述,设计,实际,系统,投入,中国,国教,教育,科研,计算,计算机,计算机网,算机,网网,网络,中心,实际,管理,运行,一段,一段时间,段时间,时间,试验,运行,证明,上述,设计,可行,系统,运行,可靠,可靠性,性比,原先,单机,机运,运行,显著,提高,保证,计费,计费数据,数据,完整,完整性,一致,一致性,基本,达到,预定,设计,目标,需要,指出,一种,容错,容错性,设计,局限,局限于,限于,计费,系统,可靠,可靠性,高要,要求,系统,采用,这种,设计,设计方案,方案,一个,不足,不足之处,之处,设备,投资,要求,比较,高,中小,中小型,小型,网络,运行,行管,管理,管理部,部门,经济,经济性,可靠,可靠性,之间,间作,一个,折衷,事实,事实上,FTCharge,系统,很多,多功能,功能,合并,并到,一个,主机,机上,上来,运行,如数,数据,处理,数据,采集,管理,监控,子系统,系统,统和,备份,计费,系统,之间,合并,一定,程度,影响,可靠,可靠性,何在,降低,降低成本,低成本,成本,情况,保持,保持足够,足够,可靠,可靠性,一步,工作,目标,本文,研究,得到,国家,五,科技,科技攻关,攻关,攻关项目,项目,基金,资助,作者,作者简介,简介,杨家,海,1966,生,副教授,教授,主要,研究,领域,协议,一致,一致性,测试,网络,互连,技术,协议,网络,网络管理,管理,吴建平,建平,1953,生,教授,博士,博士生,导师,主要,研究,领域,协议,一致,一致性,测试,网络,互连,技术,协议,网络,网络管理,管理,本文,通讯,通讯联系,联系,联系人,杨家,海,北京,100084,清华,清华大学,华大,大学,CERNET,网络,中心,作者,单位,清华,清华大学,华大,大学,计算,计算机,计算机科学,算机,科学,技术,系,北京,100084,清华,清华大学,华大,大学,信息,信息网,信息网络,网络,网络工程,工程,研究,中心,北京,100084
,参考,参考文献,文献,Aronoff,R,et,al,Network,management,functional,requirements,Management,of,Networks,Based,on,Open,Systems,Interconnection,OSI,Functional,Requirements,and,Analysis,NIST,Special,Publication,500,175,Nov,1989,http,csrc,nist,gov,nistpubs,sp500,175,txt
,杨家,海,Internet,网络,网络管理,管理,中国,国计,计算,计算机,计算机用户,算机,机用户,用户,1996,17,11
,Yang,Jia,hai,et,al,Internet,network,management,China,Computer,User,1996,17,11,ISO,OSI,Basic,Reference,Model,for,Open,System,Interconnection,IS7498,Oct,1984
,ISO,OSI,Management,Information,Service,Definition,Part,Common,Management,Information,Service,IS9595,ISO,Switzerland,May,1988
,ISO,OSI,Management,Information,Protocol,Definition,Part,Common,Management,Information,Protocol,IS9596,ISO,Switzerland,May,1988
,Jeffrey,D,Case,Mark,Fedor,et,al,A,Simple,Network,Management,Protocol,SNMP,RFC1157,Internet,Network,Working,Group,May,1990
,James,M,Galvin,Keith,McCloghrie,Administrative,Model,for,Version,of,the,Simple,Network,Management,Protocol,SNMPv2,RFC1445,Internet,Network,Working,Group,Apr,1993
,徐,冈,汤,俭,网络,计费,管理,张,德,运,编,CERNET,研究,发展,西安,西安,西安交通,西安交通大学,交通,大学,出版,出版社,1997
,Xu,Gang,Tang,Jian,Network,accounting,management,In,Zhang,De,yun,ed,The,Research,and,Development,of,CERNET,Xi,an,Xi,an,Jiaotong,University,Press,1997,Cisco,Systems,Inc,Cisco,Enterprise,Accounting,for,Netflow,Version,Cisco,Enterprise,Accounting,for,ISDN,Version,on,line,URL,http,www,cisco,com
,本文,1998,02,17,收到,原稿,1998,07,01,收到,修改,修改稿,改稿