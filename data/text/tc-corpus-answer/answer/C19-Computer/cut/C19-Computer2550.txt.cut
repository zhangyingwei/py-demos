软件,学报,
JOURNAL,OF,SOFTWARE
1999,No,1999



,程序,程序调试,调试,监测,性能,分析,一体,一体化,化工,工具,刘,强,张,兆,庆,乔,良,摘要,高性,高性能,性能,芯片,高性,高性能,性能,计算,应用,对调,调试,调试器,要求,不再,局限,局限于,限于,正确,正确性,调试,更进一步,进一步,一步,要求,求进,进行,性能,调试,正确,正确性,基础,程序,细,调,获得,获得最佳,最佳,性能,正确,正确性,调试,性能,调试,通常,独立,工具,支持,这种,模式,已不,不能,地支,支持,高性,高性能,性能,计算,介绍,一个,高性,高性能,性能,SIMD,芯片,设计,具有,正确,正确性,调试,性能,调试,功能,可视,可视化,化工,工具,集,程序,程序调试,调试,行为,监测,性能,分析,一体,改善,高性,高性能,性能,程序,开发,开发周期,周期,高性,高性能,性能,计算,提供,强有力,有力,支持,关键,关键词,调试,性能,分析,行为,监测,事件,采集,断点,程序,插,桩,中图,中图法,图法,分类,分类号,TP311
An,Integrated,Tool,for,Debugging,Monitoring,and,Performance,Analysis,
LIU,Qiang,ZHANG,Zhao,qing,QIAO,Ru,liang,Abstract,As,the,development,of,high,performance,computing,the,requirement,for,debugging,is,not,only,limited,in,correctness,debugging,but,also,for,performance,debugging,which,means,to,achieve,the,best,performance,through,program,tuning,The,correctness,debugging,and,the,performance,debugging,are,usually,supported,by,the,separate,tools,which,couldn,t,sufficiently,support,high,performance,computing,A,visualization,tool,is,presented,in,this,paper,that,supports,both,correctness,debugging,and,performance,debugging,for,a,high,performance,SIMD,chip,This,tool,incorporates,the,functionality,of,debugging,the,behavior,monitoring,and,the,performance,analyzing,It,greatly,improves,the,development,cycle,of,high,performance,computing,programming,Key,words,Debugging,performance,analysis,behavior,monitoring,events,collecting,breakpoint,program,instrumentation,程序,程序调试,调试,程序,程序开发,开发,基本,活动,算法,设计,计好,之后,程序,程序员,往往,进入,入编,编辑,编译,调试,开发,开发周期,周期,几乎,开发,环境,均,有功,功能,完备,源码,级,调试,调试器,支持,高性,高性能,性能,计算,日益,走向,成熟,高性,高性能,性能,计算,中性,性能,分析,工具,研制,成为,近年,近年来,年来,一个,研究,热点,显而,显而易见,易见,高性,高性能,性能,计算,没有,有性,性能,分析,基础,不可,可想,想像,性能,分析,通常,常采,采用,事件,方法,静态,源程序,程序,运行,运行库,行库,插,桩,运行,行时,采集,感兴,感兴趣,兴趣,事件,运行,事件,程序,进行,进行性,性能,分析,性能,分析,不满,满意,进一步,一步,修改,改程,程序,再次,进入,入编,编辑,编译,调试,周期,上调,调试,性能,分析,模型,高性,高性能,性能,计算,领域,中程,程序,开发,开发周期,周期,图,所示,

,图,具有,有性,性能,分析,开发,开发周期,周期,传统,开发,开发周期,周期,相比,性能,分析,已成,成为,高性,高性能,性能,能开,开发,环境,重要,一部,一部分,部分,目前,流行,高性,高性能,性能,计算,平台,PVM,EXPRESS,均,支持,开发,开发周期,周期,笔者,我国,国大,大规,大规模,规模,并行,并行计算,计算,计算机,算机,曙光,1000,研制,曙光,1000,研制,性能,可视,可视化,化工,工具,ParaVision,机制,上述,类似,ParaVision,试用,过程,暴露,图,所示,开发,开发周期,周期,存在,问题,开发,开发周期,周期,正确,正确性,调试,性能,调试,割裂,两个,阶段,两个,工具,实际,开发,发过,过程,两个,阶段,往往,并发,交互,交互进行,进行,性能,分析,程序,程序执行,执行,之后,后进,进行,缺乏,交互,交互性,实时,实时性,尤其,运行,行时,时间,长,程序,开发,效率,低,开发,开发周期,周期,周期长,开发,开发周期,周期,不足,不足之处,之处,认识,程序,程序调试,调试,性能,分析,结合,合在,合在一起,一起,重要,重要性,一个,高性,高性能,性能,SIMD,芯片,研制,研制开发,开发,环境,项目,目中,想法,付诸,实现,一个,一个集,集成,程序,程序调试,调试,行为,监测,性能,分析,一体,一体化,工具,Visual,IDP,visualized,integrated,debugger,and,performance,analysis,tool,简称,IDP,本文,介绍,Visual,IDP,设计,实现,高性,高性能,性能,程序,程序开发,开发,开发周期,周期,全新,支持,目标,机,结构,开发,环境,目标,机,高性,高性能,性能,单指,单指令,指令,指令流,多数,多数据流,数据,数据流,SIMD,处理,处理器,理器,结构,图,所示,

,图,目标,机体,体系,体系结构,结构,体系,体系结构,结构,角度,角度看,目标,机,控制,处理,处理机,CE,处理,处理单元,单元,阵列,PE,局部,存储,存储器,LM,全局,存储,存储器,GM,高速,DMA,通道,五部,部分,分组,组成,性能,角度,考虑,处理,处理机,处于,高性,高性能,性能,运转,状态,应,着重,着重于,重于,以下,两点,PE,阵列,列计,计算,PE,阵列,用于,计算,主要,动力,PE,阵列,始终,处于,忙,状态,有利,有利于,利于,达到,达到最佳,最佳,性能,PE,阵列,计算,需要,等待,数据,GM,传输,输到,LM,LM,GM,DMA,通信,应尽,尽量,尽量减少,量减少,减少,通信,开销,目标,机,开发,采用,主机,目标,机,模型,图,所示,主机,PC,工作,工作站,主机,目标,机,之间,串行,串行口,进行,通信,通信联系,联系,用户,PC,机上,编写,编写程序,程序,交叉,编译,编译器,生成,目标,机,执行,代码,串行,串行口,目标,码,装载,目标,机,GM,执行,执行程序,行程,程序,Visual,IDP,串行,串行口,目标,机,通信,实现,SIMD,程序,远程,调试,监测,

,图,主机,目标,机,模型,IDP,结构,实现,IDP,集成,调试,调试器,程序,监测,性能,分析,功能,结构,复杂,设计,充分,充分利用,分利,利用,面向,面向对象,对象,原则,注重,模块,模块化,层次,层次化,封装,性,图,给出,IDP,总体,结构,

,图,IDP,总体,结构,Client,Server,模型,开发,环境,主机,目标,机,模型,导致,IDP,Client,Server,结构,Client,端,运行,主机,机上,Server,端,运行,目标,机上,二者,串行,行进,进行,通信,交互,IDP,Client,Client,接受,受用,用户,输入,串行,串行口,目标,机,通信,完成,成特定,特定,调试,监测,任务,IDP,Client,在结构上,结构,分为,以下,层次,功能,功能模块,模块,GUI,图形,用户,接口,并以,可视,可视化,形式,显示,程序,行为,性能,数据,功能,层,IDP,主体,调试,调试器,监测,监测器,测器,性能,分析,分析器,组成,GUI,驱动,功能,最终,分解,IDP,Client,API,调用,IDP,Client,API,IDP,客户,客户端,应用,应用程序,程序,程序接口,接口,Client,API,目标,机,封装,抽象,实现,目标,机,发出,发出请求,请求,完成,Client,API,封装,远程,调试,细节,功能,层,考虑,调试,远程,调试,整个,系统,模块,模块化,重要,贡献,Client,API,比较,原始,操作,主要,功能,包括,目标,目标程序,程序,程序控制,控制,目标,机状态,状态,存取,通信,层,串口,封装,命令,数据,传递,采用,简单,发送,应答,协议,通信,层,设计,封闭,串口,操作,细节,IDP,Server,目标,机,操作,集中,Client,API,主机,机上,无法,直接,目标,机,操作,Client,API,功能,目标,机上,IDP,Server,代理,实现,IDP,Server,等待,串口,服务,务请,请求,目标,机,寄存,寄存器,内存,直接,操作,对外,外来,请求,提供,服务,目标,机,监控,监控器,目标,机,监控,监控器,IDP,着重,重要,作用,监测,目标,机,程序,运行,行状,状态,调试,调试器,程序,监测,监测器,测器,提供,相应,信息,目标,机,监控,监控器,主要,监控,以下,两类,事件,程序,程序调试,调试,事件,断点,命中,单步,运行,调试,功能,引起,目标,目标程序,程序,程序运行,运行,行状,状态,改变,目标,机,监控,监控器,该类,事件,发送,发送给,送给,调试,调试器,调试,调试器,接受,事件,作出,相应,调试,动作,程序,行为,事件,调试,事件,不同,该类,事件,事件,收集,收集器,发出,程序,行为,性能,事件,目标,机,监控,监控器,收到,该类,事件,事件,放入,入主,主机,事件,事件队列,队列,并进,进一步,一步,通知,程序,行为,监测,监测器,测器,程序,行为,监测,监测器,测器,读取,事件,事件队列,队列,可视,可视化,程序,行为,调试,调试器,图,显示,调试,调试器,组成,结构,相邻,模块,关系,调试,调试器,包括,层次,逻辑,模块,调试,调试信息,信息,调试,调试信息,信息,API,调试,调试器,核心,心功能,功能,调试,调试器,接受,GUI,命令,Client,API,调用,完成,成核,核心,心功能,功能,实现,调试,调试器,接受,目标,机,监控,监控器,消息,获得,目标,目标程序,程序,状态,调试,调试器,设计,已经,一门,成熟,技术,重点,点解,解释,远程,调试,实现,

,图,调试,调试器,结构,相邻,模块,关系,调试,地机,程序,不同,IDP,需要,处理,远程,调试,调试,功能,实现,Client,端,Server,端,共同,协作,完成,断点,处理,a,b,ld,r0,a,DebugTrap
,st,b,r0,st,b,r0
,上例,设置,断点,断点,指令,改为,DebugTrap,DebugTrap,一条,非法,指令,程序,程序运行,运行,断点,执行,DebugTrap,控制,处理,处理器,理器,CE,产生,非法,指令,例外,非法,指令,例外,处理,处理程序,程序,通知,IDP,Server,主机,机上,目标,机,监控,监控器,IDP,Server,交互,检测,测到,例外,发生,目标,机,监控,监控器,该事,事件,通知,调试,调试器,而使,调试,调试器,获得,控制,进一步,一步,处理,程序,监测,调试,调试器,程序,监测,IDP,一个,重要,程序,监测,用于,可视,可视化,程序,行为,性能,分析,分析器,提供,提供数据,数据,程序,监测,性能,分析,基础,程序,事件,围绕,程序,事件,解决,事件,类型,划分,事件,产生,事件,检测,事件,传递,事件,显示,事件,分析,各方,问题,事件,类型,参考,节,描述,目标,机,性能,特点,IDP,应,监测,程序,行为,性能,影响,事件,表,IDP,监测,几种,主要,事件,类型,

,事件,类型,描,主要,要数,数据,事件,范畴,
FUNC,ENTRY,进入,一个,函数,戳,函数,编码,结构,事件,
FUNC,EXIT,退出,一个,函数,戳,函数,编码,结构,事件,
SIMD,STARTPE,计算,戳,计算,事件,
SIMD,ENDPE,计算,结束,戳,计算,事件,
WAIT,START,目标,机,等待,通信,戳,通信,事件,
WAIT,END,目标,机,结束,等待,通信,戳,通信,事件,
DMA,STARTDMA,开始运行,运行,行时,戳,通信,方向,通信,事件,
DMA,ENDDMA,结束,运行,行时,戳,通信,事件,

,表,事件,分为,以下,几个,范畴,程序,程序结构,结构,事件,监测,测程,程序,流程,位置,性能,数据,提供,源程序,程序,对应,信息,程序,计算,事件,监测,测程,程序,串行,计算,并行,并行计算,计算,用于,统计,计程,程序,并行,并行性,程序,通信,事件,监测,DMA,通信,开销,DMA,START,事件,程序,行为,性能,紧密,相关,上述,事件,分析,程序,程序员,能够,跟踪,程序,热点,发现,程序,程序性,性能,瓶颈,事件,产生,检测,传递,事件,产生,检测,传递,机制,三者,之间,紧密,紧密联系,联系,成为,一个,一个整,整体,图,IDP,总体,结构,自上而下,目标,目标程序,程序,事件,检测,检测器,测器,IDP,Server,IDP,Client,API,目标,机,监测,监测器,测器,协同,完成,事件,产生,生机,机制,采用,用户,用户程序,程序,运行,运行库,行库,插,桩,Instrumentation,方法,更加,加精,精致,方法,跟踪,程序,事件,采用,总线,窃听,这种,技术,突出,优点,有利,有利于,利于,减少,用户,用户程序,程序,干扰,需要,硬件,支持,获得,数据,过于,原始,不利,不利于,利于,抽象,硬件,限制,采用,插,桩,方法,用户,用户程序,程序,一定,定影,影响,实践,实践证明,证明,方法,行之有效,有效,用户,用户程序,程序,运行,运行库,行库,插入,模块,GenEvent,EventType,EventData,实现,事件,产生,GenEvent,实现,宏,达到,高效,高效率,效率,DMA,通信,以下,下代,代码,产生,该事,事件,Q,Type,DMA,START,Q,Time,Clock,Q++,If,Length,Q,MAX,EVENT,NotifyIDPClient,上代,代码,Q,目标,机,事件,事件队列,队列,全局,局内,内存,GM,中保,保留,一块,块内存,内存,区域,存放,事件,事件队列,队列,MAX,EVENT,队列,中能,能够,容纳,事件,最大,大个,个数,考察,上代,代码,执行,效率,上代,代码,翻译,翻译成,译成,汇编,汇编语言,语言,条,机器,机器指令,指令,函数,函数调用,调用,NotifyIDPClient,If,语句,条件,决定,产生,MAX,EVENT,条,事件,调用,一次,该函,函数,MAX,EVENT,较大,产生,条,事件,开销,非常,几个,机器,周期,用户,用户程序,程序,影响,非常,进一步,一步,考察,事件,传递,当事,事件,事件队列,队列,满,事件,信息,需要,目标,机,传送,送给,主机,Client,端,Server,端,配合,完成,目标,机上,事件,事件队列,队列,满,执行,函数,函数调用,调用,NotifyIDPClient,该函,函数,机制,NotifyIDPClient,EventFlag,DebugTrap,NotifyIDPClient,两条,指令,DebugTrap,指令,使用,用户,用户程序,程序,导致,异常,暂停,断点,机制,不同,NotifyIDPClient,自我,暂停,之前,设置,EventFlag,标志,主机,机上,目标,机,监测,监测器,测器,区分,程序,行为,事件,调试,事件,图,给出,了事,事件,传递,调试,目标,机,监控,监控器,三者,之间,交互,关系,图,调试,断点,事件,传递,DebugTrap,指令,均,目标,机,产生,例外,停止,目标,机,监测,监测器,测器,EventFlag,判断,目标,机,程序,停止,原因,判断,程序,停止,事件,传递,产生,事件,信息,目标,机队,队列,读取,取到,主机,事件,事件队列,队列,复位,EventFlag,之后,目标,目标程序,程序,继续,运行,

,图,事件,传输,调试,目标,机,监控,监控器,三者,之间,关系,介绍,了事,事件,产生,传递,机制,目标,机,主机,之间,精巧,配合,低,开销,复杂,复杂性,实现,一任,任务,程序,监测,监测器,测器,程序,监测,监测器,测器,两种,方式,工作,后台,方式,可视,可视化,方式,后台,方式,程序,监测,监测器,测器,简单,事件,事件队列,队列,转储,磁盘,文件,用于,事后,后分,分析,可视,可视化,方式,程序,监测,监测器,测器,程序,运行,行状,状态,以图,图形,可视,方式,显示,用户,性能,分析,分析器,性能,分析,分析器,事件,序列,分析,获得,获得性,性能,数据,有事,事件,采集,坚实,基础,性能,分析,分析器,设计,容易,文献,大量,事件,性能,分析,分析方法,方法,不再,深入,IDP,分析,以下,性能,数据,目标,目标程序,程序,并行,并行性,目标,目标程序,程序,有效,计算,时间,目标,目标程序,程序,计算,DMA,通信,之间,并行,DMA,通信,通信,情况,IDP,支持,开发,开发周期,周期,节,给出,IDP,设计,功能,支持,图,所示,开发,开发周期,周期,图,所示,开发,开发周期,周期,相比,IDP,支持,开发,开发周期,周期,具有,以下,特点,调试,周期,性能,分析,周期,合成,成为,一个,两个,独立,部分,IDP,支持,用户,进行,行程,程序,程序调试,调试,程序,行为,监测,性能,分析,

,图,IDP,支持,开发,开发周期,周期,图,所示,开发,开发周期,周期,传统,开发,开发周期,周期,改进,IDP,设计,初衷,用户,使用,角度,用户,IDP,看作,一个,调试,调试器,调试,监测,测程,程序,行为,观察,程序,程序性,性能,用户,IDP,看作,一个,一个程,程序,程序性,性能,能行,行为,监测,监测器,测器,监测,测程,程序,序时,以利,利用,调试,调试器,强大,大功,功能,栈,单步,IDP,这种,灵活,灵活性,活性,有力,地支,支持,用户,用户程序,程序,开发,结束,结束语,IDP,近年,近年来,年来,从事,高性,高性能,性能,计算,开发,环境,研究,工作,成果,IDP,集成,程序,程序调试,调试,程序,行为,监测,性能,分析,功能,有效,地支,支持,高性,高性能,性能,程序,开发,高性,高性能,性能,计算,需要,良好,开发,环境,支持,IDP,这方,这方面,探索,IDP,想法,设计,原则,适用,用于,MPP,大规,大规模,规模,并行,并行处理,处理,系统,技术,推广,更为,广阔,领域,本文,研究,得到,国家,863,高科技,科技,项目,基金,资助,作者,介绍,刘,强,1969,生,博士,主要,研究,领域,编译,编译系统,系统,环境,工具,张,兆,庆,女,1938,生,研究,研究员,博士,博士生,导师,主要,研究,领域,编译,编译系统,系统,环境,工具,乔,良,1937,生,研究,研究员,主要,研究,领域,编译,编译系统,系统,本文,通讯,通讯联系,联系,联系人,刘,强,北京,100076,北京,北京市,京市,海淀,海淀区,淀区,知春路,76,号,翠,宫,饭店,BBT,公司,作者,单位,刘,强,张,兆,庆,乔,良,中国,中国科学院,中国科学院计算技术研究所,科学,科学院,学院,计算,计算技术,技术,研究,研究所,高性,高性能,性能,中心,北京,100080
E,mail,qliu,bbti,com,cn
,参考,参考文献,文献,Worley,Patrick,H,A,New,PICL,Trace,File,Format,Oak,Ridge,National,Laboratory,Mathematical,Sciences,Section,1992
,TSAI,Jeffrey,J,P,MEMBER,IEEE,et,al,A,noninterference,monitoring,and,replay,mechanism,for,real,time,software,testing,and,debugging,IEEE,Transactions,on,Software,Engineering,1990,16,Dodd,Paul,S,Racishankar,Chinya,V,Monitoring,and,debugging,distributed,real,time,programs,Software,Practice,and,Experience,1992,22,10,本文,1997,11,13,收到,原稿,1998,04,01,收到,修改,修改稿,改稿