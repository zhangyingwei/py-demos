软件,学报,
JOURN,AL,OF,SOFTWARE
1999,10,卷,10,Vol,10,No,10,1999



,多层,油藏,问题,负载,均衡,并行,并行任务,任务,划分,舒,继武,赵,金熙,周,维,四,张,德,富,摘要,该文,分布,分布式,布式,并行,并行计算,计算,计算机,计算机系,计算机系统,算机,机系统,系统,一类,多层,二维,流,油藏,数值,模拟,问题,给出,任务,划分,策略,卷帘,方式,区域,域分,分解,方式,卷帘,区域,域分,分解,解结,结合,方式,进行,比较,提出,减少,求解,时间,利于,负载,均衡,提高,并行,并行性,性能,任务,划分,方法,实际,应用,用于,多达,72,万个,网格,节点,大规,大规模,规模,油藏,模拟,问题,实,结果表明,表明,策略,划分,产生,并行,求解,解任,任务,均衡,有利,有利于,利于,加速,速比,提高,方法,适用,用于,区域,数据,并行,任务,划分,问题,关键,关键词,并行,并行计算,计算,负载,均衡,任务,划分,油藏,数值,模拟,中图,中图法,图法,分类,分类号,TP319

Parallel,Tasks,Partitioning,of,Load,balancing,for,a,Multiple,Layers
Numerical,Simulation,of,Reservoir
SHU,Ji,wu1,ZHAO,Jin,xi1,ZHOU,Wei,si3,ZHANG,De,fu1,2
1,State,Key,Laboratory,for,Novel,Software,Technology,Nanjing,University,Nanjing,210093,Department,of,Computer,Science,and,Technology,Nanjing,University,Nanjing,210093,The,Academy,of,Geological,Sciences,Shengli,Oil,Field,Dongying,257000,
Abstract,In,this,paper,three,tasks,division,strategies,of,load,balancing,are,given,which,include,a,round,robin,fashion,a,domain,partitioning,fashion,and,a,fashion,of,round,robin,combining,with,domain,partitioning,and,a,comparison,is,made,Then,tasks,division,methods,are,proposed,which,can,reduce,solving,times,and,benefit,load,balancing,and,increases,parallel,efficiency,for,a,simulation,of,reservoir,of,multiple,layers,two,dimension,two,phase,flow,numerical,problems,on,distributed,memory,parallel,systems,This,approach,is,applied,to,a,large,scale,reservoir,simulation,which,has,over,720,000,grid,points,The,practical,results,show,that,the,tasks,generated,by,the,strategy,are,well,balanced,and,benefit,to,improve,speedup,This,approach,is,apt,to,the,problems,for,domain,parallel,or,data,parallel,
Key,words,Parallel,computing,load,balancing,task,dividing,numerical,simulation,of,reservoir,油藏,模拟,需要,大量,计算,时间,并行,并行计算,计算,计算机,算机,使用,产生,强有力,有力,推动,动作,作用,国外,石油,油公司,公司,并行,并行处理,处理,降低,降低生产,生产,生产成本,成本,提高,生产,生产率,国内,石油,油公司,公司,正在,投资,使用,并行,并行计算,计算,计算机,算机,进行,油藏,模拟,提高,高处,处理,处理速度,速度,缩短,短处,处理,时间,国内,国内外,内外,已有,相关,工作,报道,文献,利用,分布,分布式,布式,并行,并行计算,计算,计算机,算机,ipcs,860,求解,一个,两种,组分,油藏,模拟,问题,文献,给出,区域,域分,分解,解法,多重,网格,技术,技术相结合,相结合,结合,解决,油藏,模拟,模拟计算,计算,问题,一种,方法,文献,Transputer,并行,系统,实现,多层,二维,油藏,模拟,并行,试验,油藏,数值,模拟,多层,二维,流,油藏,数值,模拟,应用,非常,广泛,本文,以此,此类,问题,并行,并行计算,计算,算作,讨论,背景,具有,不同,时间,任务,大小,不同,特殊,特殊性,图,表示,一个,时间,串行,计算,流程,KC,表示,需,计算,油层,层数,流程,主要,计算,时间,花,解压,压力,方程,方程组,一时,一时间,时间,多个,油层,需要,计算,不同,时间,需,计算,油层,层数,KC,变化,相差,较大,目前,此类,问题,并行,并行处理,处理,采用,这种,油层,并行,策略,拟,三维,问题,采用,区域,域分,分解,方法,文献,利用,每个,油层,层压,压力,方程,方程组,求解,相互,独立,独立性,卷帘,方式,油层,映射,射到,多处,多处理机,处理,处理机,并行,环境,并行,求解,不同,时间,层数,变化,层数,小于,远,小于,处理,处理机,机数,处理,处理机,负载,不均,均衡,处理,处理机,得不到,不到,充分,充分利用,分利,利用,未能,充分,挖掘,问题,并行,并行性,加速,速比,高,一时,一时间,时间,解饱,饱和,饱和度,方程,方程组,需,层压,压力,问题,求解,完成,等待,最慢,结点,机上,压力,数据,导致,整体,并行,并行性,性能,能退,退化,最慢,结点,机,相同,本文,比较,几种,任务,划分,策略,提出,一种,减少,求解,时间,有利,有利于,利于,负载,均衡,提高,高处,处理,处理机,性能,任务,划分,策略,并行,方案,策略,划分,并行,并行任务,任务,文献,两种,并行,方案,负载,均衡,并行,加速,速比,比高,大规,大规模,规模,油藏,模拟,实际,生产,应用,取得,良好,效果,

,图,压力,串行,计算,过程,任务,划分,分对,并行,并行性,性能,影响,并行,并行计算,计算,任务,划分,应,求解,问题,规模,处理,处理机,结构,密切,密切相关,相关,极大,大地,影响,有效,发挥,并行,并行机,性能,减少,求解,时间,尤其,求解,解任,任务,大小,发生,发生变化,生变,变化,问题,一个,给定,并行,环境,并行,并行计算,计算,计算机,算机,结构,类型,处理,处理机,机数,确定,加速,速比,取决,取决于,任务,均衡,各处,处理,处理机,之间,同步,通信,耗费,任务,执行,行速,速度,相互,关联,减少,通信,时间,两方,途径,提高,高通,通信,速率,减少,通信,延迟,减少,通信,数据,数据量,系统,硬件,结构,性能,能及,操作,操作系统,系统,并行,粒度,并行,粒度,影响,负载,均衡,一个,因素,选择,合适,并行,粒度,设计,并行,并行处理,处理,处理程序,程序,改善,并行,并行处理,处理,理性,性能,重要,重要途径,途径,大大,大大减少,减少,问题,求解,时间,Amdahl,定理,可知,高,并行,并行度,行度,提高,并行,并行性,性能,决定,并行,加速,实际,可达,达到,并行,并行度,行度,诸多,因素,数据,规模,数据,取决,取决于,问题,不能,控制,改进,代码,结构,一角,角度,来讲,细化,计算,粒度,做到,提高,算法,并行,并行度,行度,提高,并行,系统,性能,细化,计算,粒度,系统,中实,实际,参与,分配,任务,数,变,易,负载,均衡,细化,计算,粒度,引起,通信,通信量,增加,通信,并行,并行计算,计算,算来,一种,额外,开销,性能,产生,负面,影响,大规,大规模,规模,并行,系统,采用,细化,计算,粒度,并行,行时,系统,系统性,性能,时会,计算,粒度,细化,受益,通信,开销,随之,增大,部分,抵销,导致,性能,下降,必须,并行,并行度,行度,粒度,充分,分地,进行,折衷,尽可,尽可能,可能,负载,负载平衡,平衡,并行,求解,时间,参与,并行,并行计算,计算,处理,处理机,运行,行时,时间,最大,最大值,大值,定义,问题,一个,时间,并行,求解,加速,速比,Sp,Tp,表示,讨论,并行,并行算法,算法,使用,p,台,处理,处理机,运行,行时,时间,T1,表示,算法,处理,处理机,机上,运行,行时,时间,td,表示,分配,配数,数据,结点,机,结点,机,接收,数据,所需,时间,tcomm,表示,处理,处理机,之间,间通信,通信,同步,所需,时间,tcalc,表示,一个,时间,最慢,结点,机,计算,时间,划分,策略,并行,方案,其实,实现,利用,问题,一时,一时间,时间,解,每层,层压,压力,方程,方程组,相互,独立,特性,层,卷帘,方式,分配,层数,数据,各处,处理,处理机,设有,p,处理,处理机,某一时间,一时,一时间,时间,k,层,需要,计算,i,处理,处理机,机上,分配,层,集为,Ri,k,k,mod,p,i,i,p,图,所示,p,处理,处理机,机上,并行,求解,过程,

,图,P,处理,处理机,并行,并行计算,计算,过程,这种,并行,方案,油层,并行,并行计算,计算,粒度,粗粒度,粒度,并行,主要,优点,一时,一时间,时间,解压,压力,方程,方程组,没有,处理,处理机,之间,通信,同步,开销,分配,配数,数据,结点,机,结点,机,接收,数据,所需,时间,主要,不足,一时,一时间,时间,需,计算,层数,不一,一定,定相,相同,容易,处理,处理机,负载,不均,均衡,一次,时间,饱和,饱和度,求解,需要,等待,最慢,结点,机上,压力,数据,导致,整体,并行,并行性,性能,能退,退化,最慢,结点,机,相同,而使,加速,速比,下降,尤其,时间,计算,层数,退化,化为,串行,处理,并行,方案,式,可变,变为,tj,j,层,计算,时间,确定,时间,分配,配数,数据,结点,机,结点,机,接收,数据,所需,时间,td,一定,要使,Sp,最大,必须,这种,粒度,划分,方法,并行,粒度,不同,时间,计算,层数,变化,时间,计算,层数,小于,处理,处理机,机数,问题,任务,分布,难以,均匀,处理,处理机,未,得到,充分,充分利用,分利,利用,加速,速比,高,并行,效率,低,模型,加速,速比,低,目前,采用,这种,层,并行,粒度,方法,并行,方案,其实,实现,设有,p,处理,处理机,某一时间,一时,一时间,时间,k,层,需,计算,一层,采用,区域,域分,分解,解法,一层,对应,计算,区域,域分,分为,p,个子,子区,区域,任务,卷帘,方式,分配,配子,子区,区域,数据,各处,处理,处理机,i,处理,处理机,机上,分配,子区,区域,集为,k,层,i,个子,子区,区域,组成,集合,Qi,q,q,mod,p,i,i,p,q,k,p,方法,细化,方法,并行,粒度,油层,子区,区域,并行,并行计算,计算,粒度,有利,有利于,利于,处理,处理机,负载,负载平衡,平衡,特别,每层,划分,子区,区域,数,处理,处理机,机数,相等,每一处,一处,处理,处理机,分配,子区,区域,数,相等,负载,易于,均衡,实际,油藏,模拟,问题,计算,区域,范围,子区,区域,并行,并行计算,计算,粒度,粗粒度,粒度,并行,认为,方案,粒度,细化,图,表示,某一时间,一时,一时间,时间,一层,计算,区域,划分,分为,p,个子,子区,区域,p,处理,处理机,机上,并行,求解,过程,

,图,P,处理,处理机,并行,并行计算,计算,过程,实际,问题,区域,域分,分解,解法,通信,主要,相邻,邻边,边界,数据,数据交换,交换,通信,通信量,不大,特别,大规,大规模,规模,问题,细化,并行,粒度,改善,负载,均衡,缩短,时间,大于,通信,信增,增加,时间,某一时间,一时,一时间,时间,计算,层数,k,处理,处理机,机数,p,尤其,k,p,方法,方法,比较,tcomm,开销,小于,负载,不平,平衡,引起,同步,等待,开销,时间,细化,方法,并行,粒度,获得,更,高,加速,速比,k,p,tcomm,计算,层数,增大,增大,成为,影响,加速,速比,重要,因素,可能,没有,方法,加速,速比,比高,并行,方案,式,可变,变为,tq,子区,区域,q,计算,时间,tis,i,层,区域,区域间,间通信,通信,同步,时间,要使,式,Sp,最大,需有,并行,方案,其实,实现,层,k,p,n,层,采用,方法,划分,任务,每层,划分,分为,p,个子,子区,区域,任务,共有,p,k,p,n,任务,k,p,n,机,间通信,通信,同步,子区,区域,卷帘,方式,分配,配数,数据,块,p,处理,处理机,Qi,q,q,mod,p,i,i,p,q,k,p,n,p,子区,区域,并行,粒度,k,p,n+1,层,k,层,采用,方法,划分,任务,层,粒度,共有,p,n,任务,层,卷帘,方式,分配,层数,数据,p,处理,处理机,Ri,j,j,mod,p,i,i,p,j,k,p,n+1,k,图,所示,p,处理,处理机,机上,并行,实现,过程,方法,综合,方法,方法,采用,两种,不同,并行,并行计算,计算,粒度,油层,油层,子区,区域,易于,负载,负载平衡,平衡,减少,通信,同步,克服,上述,两种,方法,不足,保留,优点,

,图,p,处理,并行,并行计算,计算,过程,k,p,方法,采用,区域,域分,分解,方法,分割,区域,均匀,映射,射到,到处,处理,处理机,机上,各处,处理,处理机,负载,基本,平衡,k,很小,通信,同步,开销,不大,方法,可看,看成,此种,情况,特例,k,p,方法,综合,方法,方法,各处,处理,处理机,负载,基本,平衡,这种,方法,存在,通信,开销,问题,方法,通信,开销,很多,方法,相比,高,加速,速比,并行,方案,式,可变,变为,不同,时间,计算,层数,变化,问题,方法,总能,各处,处理,处理机,负载,基本,平衡,方法,方法,更,有效,要使,式,Sp,最大,必须,比较,式,和式,可知,方法,方法,有效,表明,采用,细化,一部,一部分,部分,任务,计算,粒度,任务,均衡,系统,系统性,性能,计算,粒度,细化,提高,比较,式,和式,可得,方法,方法,有效,表明,完全,细化,计算,粒度,引起,通信,通信量,增加,增大,通信,开销,导致,性能,下降,必须,并行,并行度,行度,粒度,进行,充分,折衷,尽可,尽可能,可能,负载,负载平衡,平衡,实际,应用,使用,PVM,并行,环境,减少,通信,开销,采用,集中,通信,方式,减少,通信,次数,减少,通信,启动,启动时,时间,缩短,tcomm,结点,机,通信,开销,分成,两部,部分,一部,一部分,部分,接收,收来,处理,处理机,相邻,邻边,边界,数据,一部,一部分,部分,发送,结点,机,相邻,邻边,边界,数据,过程,PVM,发送,采用,异步,过程,基本,计算,重叠,进行,通信,开销,主要,体现,现在,接收,收方,数值,取,压力,方程,方程组,收敛,判别,pi+1,pi,10,pi+1,pi,I+1,i,迭代,代步,压力,Nx,Ny,表示,油层,X,Y,方向,向上,网格,划分,Nk,表示,油层,层数,选取,实际,油藏,油藏模型,模型,以下,几个,模型,Nx,Ny,Nk,142,75,12,节点,点数,127,800,每个,阶段,N,MP,时间,模型,Nx,Ny,Nk,146,125,16,节点,点数,292,000,每个,阶段,N,MP,时间,模型,Nx,Ny,Nk,211,203,17,节点,点数,728,161,每个,阶段,N,MP,23,时间,模型,N,17,阶段,计算,层数,k,表,所示,实际,应用,提高,并行,效率,采用,压缩,通信,技术,并行,并行计算,计算,计算环境,环境,PVM,用以,以太,以太网,连接,两个,共享,主存,SGI,Challenge,并行,并行机,机组,组成,每个,Challenge,两个,处理,处理器,理器,采用,上述,粒度,划分,方法,模型,求解,方法,方法,每层,划分,子区,区域,数,运行,加速,速比,表,表,1

,时间,阶段,N1234567891011121314151617
,模型,计算,层数,k55566779101010111112121212
,模型,计算,层数,k111277911111111121212121212
,模型,计算,层数,k1717171717171717171717171717171717

,表,2

,模型,模型,模型,3
S1p,方法,02,452,30
S2p,方法,742,031,70
S3p,方法,162,742,72

,采用,方法,模型,效果,不理,理想,主要,整个,运行,阶段,时间,计算,层数,时间,总计,136,136,391,计算,层数,数分,总计,200,152,647,一时,一时间,时间,层,间通信,通信,同步,细化,并行,粒度,引起,通信,同步,开销,大大,大大增加,大增,增加,方法,模型,Sp,改善,求解,多达,72,万个,网格,节点,大规,大规模,规模,油藏,模拟,生产,实际,问题,实践,表明,方法,划分,产生,并行,求解,解任,任务,均衡,有利,有利于,利于,进一步,进一步提高,一步,提高,加速,速比,注释,本文,研究,得到,国家,863,高科技,科技,项目,基金,资助,作者,作者简介,简介,舒,继武,1969,生,博士,博士生,主要,研究,领域,并行,并行处理,处理,分布,分布式,分布式计算,布式,计算,赵,金熙,1950,生,博士,副教授,教授,主要,研究,领域,计算,算数,数学,数值,计算,周,维,四,1942,生,教授,教授级,高工,博士,博士生,导师,主要,研究,领域,计算,计算技术,技术,油藏,数值,模拟,张,德,富,1937,生,教授,博士,博士生,导师,主要,研究,领域,计算,计算机,计算机软件,算机,机软件,软件,并行,并行处理,处理,技,术,分布,分布式,分布式计算,布式,计算,作者,单位,舒,继武,赵,金熙,张,德,富,南京,南京大学,大学,计算,计算机,计算机软件,算机,机软件,软件,新,技术,国家,重点,实验,实验室,南京,210093
,舒,继武,赵,金熙,张,德,富,南京,南京大学,大学,计算,计算机,计算机科学,算机,科学,技术,系,南京,210093
,周,维,四,胜利,胜利油田,油田,田地,地质,质科,科学,科学研究,研究,研究院,东营,257000
,参考,参考文献,文献,Kendall,R,P,et,al,Large,Scale,Reservoir,Simulation,in,the,Concurrent,Processing,Milieu,Los,Alamitos,CA,IEEE,Computer,Society,Press,1991
2,Killough,J,E,et,al,Simulation,of,compositional,reservoir,phenomena,on,a,distribute,memory,parallel,computer,In,Killough,J,E,et,al,eds,The,1991,SPE,Symposium,on,Reservoir,Simulation,Anaheim,University,of,Anaheim,Press,1991,69,82
3,Bhogeswara,Rao,Killough,J,E,Parallel,linear,solvers,for,reservoir,simulation,a
,generic,approach,for,existing,and,emerging,computer,architectures,In,Killough,J,E,et,al,eds,Proceedings,of,the,12th,SPE,Symposium,on,Reservoir,Simulation,Houston,University,of,Houston,Press,1993,71,82
4,徐,明,孙家,昶,多层,二维,油藏,模拟,并行,试验,李,晓,梅,编,全国,届,并行,并行算法,算法,法学,术,会议,议论,议论文,论文,论文集,文集,北京,航空,航空工业,工业,出版,出版社,1993,255,260
,Xu,Xiang,ming,Sun,Jia,chang,et,al,Parallel,experiment,for,multiple,layers,two,dimension,two,phases,flow,reservoir,simulation,In,Li,Xiao,mei,et,al,eds,Proceedings,of,the,4th,Parallel,Algorithms,Conference,Beijing,Aviation,Industry,Press,1993,255,260,收稿,日期,1998,05,12,修,稿,日期,1998,10,09
