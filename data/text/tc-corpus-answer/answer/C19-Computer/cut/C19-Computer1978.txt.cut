微型,微型机,应用,
MICROCOMPUTER,ITS,APPLICATIONS
1999,18,卷,Vol,18,No,1999



,利用,WinInet,进行,TCP,IP,通信,祝,蔚,莹,石,冰心,摘,Winsock,Windows,应用,应用程序,程序,TCP,IP,通信,标准,以此,此为,基础,Visual,C++4,版本,提供,API,WinInet,Internet,程序,程序开发,开发,变得,快捷,方便,本文,研究,探讨,利用,WinInet,实现,TCP,IP,通信,关键,关键词,Internet,编程,Winsock,TCP,IP,FTP,HTTP,Gopher
1,Windows,操作,操作系统,系统,Internet,编程,Internet,早期,站点,UNIX,机器,实现,TCP,IP,通信,标准,Berkeley,sockets,协定,Windows,操作,操作系统,系统,形成,发展,借鉴,Berkeley,sockets,思想,创建,Windows,应用,应用程序,程序,之间,实现,TCP,IP,通信,标准,Windows,Sockets,Winsock,标准,此基础,基础,之上,开发,程序,程序员,客户,服务,服务者,Client,Server,模式,进行,Internet,编程,API,程序,程序员,不同,需要,采用,不同,方法,实现,TCP,IP,通信,直接,使用,Winsock,使用,消息,API,Message,API,使用,Internet,服务,服务者,API,ISAPI,利用,Visual,C++4,版本,提供,Internet,函数,WinInet,Winsock,环境,WINSOCK,DLL,WSOCK32,接口,保证,不同,Windows,环境,Windows95,Windows,NT,动态,库,名称,实现,socket,功能,机制,socket,接口,相同,Winsock,实现,TCP,IP,通信,支持,协议,IPX,SPX,MAPI,服务,提供,利用,用用,用户,安装,客户,客户端,服务,软件,发送,传真,声音,邮件,电子,电子邮件,邮件,信息,接口,API,ISPAI,用于,增强,扩展,HTTP,服务,服务器,务器,功能,开发,开发者,制造,extensions,filters,extensions,用户,Web,页面,面上,上调,调用,动态,库,类似,CGI,应用,应用程序,程序,filters,服务,服务器,务器,启动,动态,库,用于,监视,改变,变出,入,服务,服务器,务器,数据,WinInet,提供,HTTP,FTP,Gopher,应用,应用层,协议,客户,客户端,端接,接口,WinInet,Internet,程序,程序开发,开发,变得,快捷,方便,本文,WinInet,利用,WinInet,开发,Internet,通信,程序,进行,介绍,探讨,WinInet
2,WinInet
,WinInet,指,Microsoft,Win32,提供,Internet,函数,WININET,DLL,动态,库,中所,包含,函数,程序,程序员,方便,使用,HTTP,FTP,gopher,访问,Internet,稍加,变通,进行,Finger,查询,Whois,查询,VC,版本,MFC,提供,WinInet,屏蔽,WinSock,TCP,IP,协议,程序,程序员,须,调用,方法,不用,了解,协议,具体内容,体内,内容,编制,客户,客户端,客户端程序,程序,访问,HTTP,FTP,gopher,站点,WinInet,功能,MFC,共,提供,13,WinInet,实现,一系,一系列,系列,Internet,访问,功能,CInternetSession,创建,多个,Internet,通道,CInternetConnection,子类,ChttpConnection,CftpConnection,CGopherConnection,管理,管理应用程序,理应,应用,应用程序,程序,Internet,服务,服务器,务器,Http,服务,服务器,务器,FTP,服务,服务器,务器,gopher,服务,服务器,务器,建立,连接,CInternetFile,子类,CHttpFile,CGopherFile,提供,访问,远程,服务,服务器,务器,Http,服务,服务器,务器,gopher,服务,服务器,务器,文件,文件系统,系统,方法,CFileFind,子类,CftpFileFind,CgopherFileFind,完成,远程,Internet,站点,FTP,服务,服务器,务器,gopher,服务,服务器,务器,查找,查找文件,文件,功能,CGopherLocator,gopher,站点,获取,gopher,位标,locator,并提,提供,供给,CgopherFileFind,定位,CInternetException,描述,Internet,操作,例外,例外情况,情况,WinInet,编制,Internet,客户,客户端,客户端程序,程序,Internet,客户,客户端,应用,应用程序,程序,指,Internet,协议,gopher,FTP,HTTP,网络,数据,资源,服务,服务器,务器,获取,获取信息,取信,信息,程序,程序,程序员,直接,调用,Win32,函数,采用,MFC,WinInet,编写,WinInet,客户,客户端,应用,应用程序,程序,作者,在编,编制,Internet,客户,客户端,客户端程序,程序,过程,WinInet,完成,HTTP,查询,FTP,查询,gopher,查询,Finger,查询,Whois,查询,功能,功能模块,模块,实现,查询,主要,功能,设法,服务,服务器,务器,建立,连接,服务,服务器,务器,直接,接接,接受,回应,信息,获取,服务,服务器,务器,相关,关文,文件,文件系统,系统,控制,句柄,下面,阐述,不同,协议,查询,查询方法,方法,实现,WinInet,声明,头文件,文件,afxinet,h,使用,用到,WinInet,应用,应用程序,程序,语句,#include,afxinet,h,访问,WWW,服务,服务器,务器,做,一个,HTTP,连接,简单,方法,创建,CInternetSession,对象,有效,HTTP,站点,URL,参数,调用,调用函数,函数,OpenURL,返回,CInternetFile,文件,句柄,其内,内容,URL,定位,web,页面,信息,处理,文件,进行,读,写,搜索,操作,获取,必要,信息,程序,程序代码,代码,CInternetSession,session,CInternetFile,file,NULL,try,file,CInternetFile,session,OpenURL,URL,catch,CInternetException,pEx,file,NULL,pEx,Delete,if,file,需要,文件,读,写,搜索,try,catch,语句,捕捉,非法,URL,连接,引发,CInternetException,错误,正常,处理,代码,码放,放入,try,异常,处理,代码,码放,放在,catch,访问,WWW,站点,以使,使用,ChttpConnection,具体方法,方法,http,服务,服务器,务器,域名,执行,http,协议,端口,端口,端口号,口号,缺省,80,参数,调用,CinternetSession,GetHttpConnection,函数,建立,站点,连接,CHttpConnection,SendRequest,函数,HTTP,服务,服务器,服务器发送,务器,发送,服务,务请,请求,返回,返回值,包含,应答,信息,CHttpFile,类型,文件,句柄,访问,FTP,站点,先调,调用,调用函数,函数,CInternetSession,GetFtpConnetion,建立,FTP,连接,所需,需要,参数,依次,FTP,站点,域名,用户,用户名,户名,用户,户口,口令,ftp,服务,服务端,端口,端口号,口号,缺省,缺省值,21,访问,模式,被动,主动,中用,用户,用户名,户名,若为,空,表明,请求,匿名,FTP,服务,用户,户口,口令,用户,email,地址,连接,CftpConnection,方法,操作,远程,FTP,服务,服务器,务器,文件,文件系统,系统,SetCurrentDirectory,GetCurrentDirectory,设置,获取,连接,当前,FTP,目录,RemoveDirectory,CreateDirectory,删除,创建,目录,Rename,Remove,PutFile,GetFile,OpenFile,文件,进行,更名,删除,移入,取出,打开,操作,最后,必须,Close,方法,关闭,FTP,服务,服务器,务器,连接,可用,MFC,编制,提供,图形,图形界面,界面,FTP,客户,客户端,应用,应用程序,程序,MFC,提供,控制,控制器,static,text,edit,box,Button,List,Box,List,control,Tree,control,编辑,对话,对话框,界面,提供,良好,命令,输入,信息,输出,用户,用户界面,界面,MFC,ClassWizard,相关,中加,加入,响应,应用,用户,命令,操作,消息,映射,宏,处理,处理函数,函数,建立,FTP,连接,相应,消息,映射,映射函数,函数,中加,加入,程序,程序代码,代码,实现,FTP,站点,文件,文件系统,系统,操作,信息,显示,用户,建立,FTP,连接,远程,程文,文件,操作,关键,代码,CInternetSession,session,My,FTP,Session,CFtpConnection,pConn,NULL,pConn,session,GetFtpConnection,lpSN,lpUN,lpPW,nP,lpSN,ftp,whnet,edu,cn,lpUN,lpPW,np,21,该站,站点,匿名,ftp,访问,pConn,GetFile,pRF,pLF,pRF,FTP,站点,取回,文件,文件名,pLF,系统,创建,文件,文件名,pConn,GetCurrentDirectory,strCD,strCD,Cstring,对象,指针,pConn,Close,session,Close,访问,Gopher,站点,先用,CInternetSession,GetGopherConnection,函数,合法,Gopher,站点,建立,连接,参数,依次,Gopher,服务,服务器,务器,名,用户,用户名,户名,用户,户口,口令,gopher,协议,端口,端口号,口号,70,返回,返回值,控制,连接,CGopherConnection,对象,指针,CGopherConnection,成员,函数,CreateLocator,用于,创建,CGopherLocator,对象,参数,依次,目录,文件,文件名,查找,关键,关键字,类型,标志,返回,返回值,gopher,服务,服务器,务器,一文,文件,目录,定位,定位器,locator,应用,应用程序,程序,定位,定位器,看作,透明,记号,用于,gopher,服务,服务器,务器,检索,信息,每个,gopher,定位,定位器,特定,属性,确定,查找,找到,文件,服务,服务器,务器,类型,CGopherLocator,成员,函数,GetLocatorType,可获,获取,定位,定位器,属性,应用,应用程序,程序,gopher,定位,定位器,参数,调用,CGopherFileFind,成员,函数,FindFile,查找,gopher,文件,文件,文件名,可作,函数,参数,返回,CGopherFile,文件,句柄,利用,句柄,可读,写,文件,获取,所需,信息,接下,接下来,下来,可调,调用,CGopherFileFind,一成,成员,函数,FindNextFile,继续,查找,同名,文件,CGopherFileFind,对象,创建,要以,以此,gopher,连接,参数,查找,gopher,文件,直接,使用,CGopherConnection,成员,函数,OpenFile,需要,gopher,定位,定位器,参数,返回,CGopherFile,文件,句柄,建立,gopher,连接,查找,相关,关文,文件,关键,代码,CInternetSession,session,CGopherConnection,con,NULL,CGopherFile,pgF,NULL,con,session,GetGopherConnection,host,host,gopher,服务,服务器,务器,域名,CGopherFileFind,pF,new,CGopherFileFind,con,CGopherLocator,lc,con,CreateLocator,NULL,NULL,
GOPHERTYPEDIRECTORY,pgF,pF,FindFile,lc,pFN,pFN,文件,文件名,名字,字符,字符串,Gopher,传送,Finger,查询,Finger,一种,查询,一站,站点,在线,用户,指定,用户,状况,古老,Internet,协议,MFC,API,函数,数名,均,不含,含有,finger,单词,指定,协议,端口,方式,gopher,查询,相关,WinIntet,API,函数,实现,finger,查询,Internet,信息,交互,均,特定,主机,端口,对应,域名,IP,地址,确定,主机,端口,port,确定,进程,著名,协议,采用,标准,端口,端口号,口号,应用,应用程序,程序,远程,主机,域名,端口,端口号,口号,70,gopher,类型,文件,文件名,名字,字符,字符串,参数,创建,gopher,定位,定位器,locator,gopher,客户,客户端,字符,字符串,发送,发送给,送给,远程,主机,端口,70,远程,主机,机上,gopher,服务,服务器,务器,监听,端口,70,收到,查询,字符,字符串,gopher,协议,规定,回应,信息,Finger,协议,标准,端口,79,远程,主机,机上,Finger,服务,服务器,务器,监听,端口,并发,发送,Finger,应答,响应,客户,客户端,发来,字符,字符串,Finger,协议,规定,字符,字符串,r,n,回应,信息,主机,机上,在线,用户,相关,信息,列表,字符,字符串,用户,用户名,户名,+,r,n,回应,信息,用户,相关,信息,进行,Finger,查询,调用,成员,函数,CinternetSession,GetGopherConnection,运行,Finger,服务,服务器,服务器程序,务器,程序,远程,主机,主机名,机名,端口,79,参数,建立,Finger,连接,调用,CGopherConnection,成员,函数,CreateLocator,创建,定位,定位器,客户,客户端,发送,Finger,查询,字符,字符串,参数,II,查找,关键,关键字,即可,可向,Finger,站点,发出,查询,信息,Finger,站点,应答,信息,置于,CGopherFile,文件,带回,建立,Finger,连接,并进,进行,Finger,查询,关键,代码,CInternetSession,session,CGopherConnection,con,NULL,con,session,GetGopherConnection,hostName,NULL,NULL,79,CGopherLocator,lc,con,CreateLocator,NULL,qstr,GOPHERTYPETEXTFILE,qstr,r,n,用户,用户名,户名,+,r,n,CGopherFile,file,con,OpenFile,lc,读,文件,Gopher,传送,Whois,查询,Whois,协议,WinInet,直接,支持,类似,Finger,Whois,发到,端口,字符,字符串,作出,响应,Whois,标准,端口,43,Whois,服务,通常,Internet,DNS,服务,系统,提供,创建,定位,定位器,以待,待查,查找,主机,主机名,机名,名作,查找,关键,关键字,即可,返回,CGopherFile,文件,带回,查询,下面,Whois,查询,范例,rs,internic,net,提供,Whois,服务,主机,域名,www,microsoft,com,查询,主机,域名,CInternetSession,se,CGopherConnection,con,NULL,con,se,GetGopherConnection,rs,internic,net,NULL,
NULL,43,CGopherLocator,lc,con,CreateLocator,NULL,www,microsoft,com,CGopherFile,file,con,OpenFile,lc,读,文件,上述,利用,WinInet,编制,Internet,客户,客户端,客户端程序,程序,方法,以方,方便,访问,HTTP,FTP,Gopher,Finger,Whois,站点,作者,单位,武汉,华中,华中理工大学,理工,理工大,理工大学,工大,大学,电子,信息,信息工程,工程,工程系,430074,参考,参考文献,文献,Jamsa,K,Cope,K,INTERNET,编程,北京,电子,工业,出版,出版社,1996
2,Kruglinski,D,J,Visual,C++,技术,内幕,北京,清华,清华大学,清华大学出版社,华大,大学,出版,出版社,1994
,收稿,日期,1998,09,17