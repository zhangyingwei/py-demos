软件,学报,
JOURNAL,OF,SOFTWARE,
1999,10,卷,Vol,10,No,1999



,管状,组织,中轴,元,球,造型,方法,郭,红,晖,彭,群生,李,捷,摘要,传统,医学,数据,造型,方法,往往,局限,局限于,限于,数据,数据表,表达,镶嵌,轮廓,轮廓线,族,三角,片,集合,简单,三维,体元,阵列,实际,实际上,生物,生物体,物体,结构,相当,复杂,采用,简单,造型,方法,显然,不能,适应,绘制,要求,文章,探讨,适用,用于,气管,血管,管状,多分,分枝,结构,造型,方法,采用,离散,中轴,表达,分枝,拓扑,结构,结合,元,球,metaball,隐,式,曲面,造型,方法,构造,管状,组织,模型,这种,造型,方法,以使,管状,组织,复杂,拓扑,结构,得以,保留,保证,分枝,之间,间连接,连接,光滑,光滑性,关键,关键词,中轴,变换,距离,变换,元,球,造型,隐,式,曲面,中图,中图法,图法,分类,分类号,TP391
Modeling,Technique,Based,on,Media,axis,and,Metaball,for,Vessel,Biomedical,Structure
GUO,Hong,hui1,PENG,Qun,sheng1,LI,Jie2
1,State,Key,Laboratory,of,CAD,CG,Zhejiang,University,Hangzhou,310027,Department,of,Computer,Science,and,Technology,Tsinghua,University,Beijing,100084,
Abstract,The,modeling,of,medical,volume,data,has,drawn,public,attention,recently,since,traditional,approaches,such,as,triangle,tiling,of,the,contour,surface,and,3D,array,of,voxels,do,not,fit,for,the,efficiently,rendering,especially,for,rendering,of,vessel,structure,In,this,paper,an,algorithm,for,modeling,vessel,biomedical,structure,based,on,the,extraction,of,medial,axis,and,the,interaction,of,metaballs,is,proposed,The,authors,adopt,distance,transformation,to,extract,the,medial,axis,and,use,the,metaball,to,describe,the,structure,The,results,show,that,this,model,not,only,remains,the,complicated,topological,structure,but,also,assures,the,smooth,shape,of,rendering,result,
Key,words,Media,axis,transform,distance,transform,metaball,modeling,implicit,surface,医学,可视,可视化,研究,血管,神经,细微,组织,绘制,一直,十分,棘手,问题,传统,绘制,方法,大多,采用,最大,灰度,投影,法,进行,绘制,这种,方法,计算,计算机,算机,没有,建立,三维,几何,模型,严格,不能,算是,三维,三维重建,重建,血管,体内,内分,分布,广,分枝,众多,形态,细小,采用,传统,造型,方法,几乎,无从,无从下手,下手,加上,以往,数据,采集,系统,不够,精确,细小,小分,分枝,常常,遗漏,常,回避,血管,造型,问题,少量,显微,显微结构,微结构,结构,血管,放大,图像,主体,部分,分时,采用,类似,大型,实体,轮廓,连接,方法,进行,绘制,医学,可视,可视化,应用,范围,不断,不断扩大,扩大,血管,形态,绘制,要求,越来,越来越,精细,外科,外科手术,手术,模拟,主要,血管,神经,形态,位置,必须,准确,描述,描述,精细,精细结构,结构,管状,组织,织成,成为,必不可少,不可,一个,一个组,组成,组成部分,部分,近两年,近两年来,两年,年来,管状,组织,造型,方法,关注,Mori,采用,树结构,结构,表达,血管,分布,结合,抽取,等值,信息,采用,Marching,Cubes,方法,进行,绘制,这种,方法,分枝,进行,表面,绘制,SGI,Silicon,Graphics,Incorporation,可达,达到,实时,主要,要用,用于,虚拟,内窥镜,窥镜,系统,Kriete,Talhami,采用,L,系统,描述,气管,枝,状,分布,Ge,采用,细化,算法,得到,大肠,骨架,架结构,结构,Masutani,先用,用人,人工,选取,起始,始点,采用,区域,生长,形态,形态学,膨胀,算子,找到,血管,骨架,这种,方法,得到,血管,骨架,得到,骨架,连接,接关,关系,没有,骨架,半径,信息,绘制,血管,粗细,相同,不符,符合,符合实际,实际,情况,本文,介绍,一种,中轴,隐,式,曲面,面相,相结合,结合,血管,表达,表达方法,方法,重建,建和,绘制,各类,枝,状,管状,组织,传统,隐,式,曲面,造型,方法,包括,实体,变形,法,多个,实体,体相,相互,相互作用,作用,用法,血管,半径,细小,分枝,众多,采用,简单,实体,变形,显然,难以,逼近,采用,多个,小球,相互,相互作用,作用,用以,得到,血管,表面,可行,这类,类似,动画,metaball,造型,技术,技术,难点,确定,小球,位置,非常,困难,需要,把握,血管,大致,拓扑,结构,图像,图像处理,处理,中轴,技术,正好,提供,方法,现在,推广,三维,情况,用于,提取,数据,血管,数据,拓扑,结构,血管,拓扑,结构,中轴,表达,血管,宽度,较窄,多分,分枝,状,组织,采用,中轴,描述,拓扑,结构,较为,合适,定义,x,集合,A,距离,
ds,x,A,inf,d,x,z,z,A,最常,常用,距离,度量,欧拉,Euclidean,距离,城市,市区,区块,city,block,距离,棋盘,chessboard,距离,B,某区,区域,边界,有点,集合,该区,区域,一个,一个点,P,边界,B,采用,某种,距离,度量,找出,最近,称,这种,最近,边缘,该区,区域,中轴,该区,区域,中所,具有,最近,边缘,集合,中轴,通常,表达,二元,元组,形式,x,ds,x,B,ds,x,B,定义,x,边界,距离,中轴,定义,中保,保留,留有,有点,边界,最小,距离,以利,利用,中心,位于,中轴,中轴线,轴线,圆盘,区域,集,覆盖,中轴,中轴线,轴线,对应,区域,圆盘,中心,距离,边界,最远,圆盘,称为,最大,大圆,推广,三维,称为,最大,大球,中轴,即为,最大,大球,球心,传统,中轴,抽取,方法,两类,采用,细化,方法,逐次,去掉,物体,边界,边界点,必须,保证,区域,连通,连通性,通性,破坏,最后,保留,组成,物体,中轴,这种,方法,采用,模板,方式,实现,抽取,中轴,保留,物体,拓扑,结构,计算,量,往往,很大,短,分枝,易,抹掉,称为,中轴,变换,方法,原图,图像,进行,行距,距离,变换,找出,每个,像素,最近,边界,边界点,距离,距离,最大,抽取,取出,中轴,这种,方法,易于,实现,效率,效率高,方法,得到,中轴,离散,分布,可能,连通,出现,中轴,中轴线,轴线,断裂,情况,采用,隐,式,曲面,造型,用于,构造,隐,式,曲面,球心,恰好,可选,离散,中轴,而无须,无须,中轴,连续,采用,方法,抽取,中轴,满足,满足要求,要求,提取,中轴,通常,物体,背景,中分,分离,分离出来,转换,转换成,换成,图像,采用,距离,变换,找出,距离,边界,最远,确定,中轴,下面,距离,变换,推广,三维,分类,医学,数据,本文,推广,方法,进行,行距,距离,变换,距离,变换,Rosenfeld,Pfaltz,1966,提出,旨在,采用,滤波,方法,求出,每个,像素,物体,边界,最小,距离,图像,像素,之间,距离,多种,定义,定义方法,方法,欧拉,距离,直观,距离,定义,定义方法,方法,欧拉,距离,计算,包含,开方,运算,运算,过程,需要,保存,大量,信息,通常,常采,采用,运算,运算量,存储,存储量,储量,切削,chamfer,距离,八角,八角形,角形,octagonal,距离,进行,逼近,选择,一种,算法,误差,允许,范围,定,二维,情况,相邻,像素,距离,d1,相邻,像素,距离,d2,图,a,所示,假设,P1,P2,像素,x,y,两方,方向,向上,相差,像素,m1,m2,图,c,所示,m1,m2,可取,

,P1P2,m2d2+m1,m2d1,

,欧拉,距离,差,

,d1,d2,距离,切削,距离,求导,可知,m1,m2,M,D,取,极大,极大值,大值,41M
,d1,d2,infinity,距离,街区,距离,邻域,式,无意,意义,可知,P1P2,m1+m2,m1,m2,M,D,取,最大,最大值,大值,下面,考虑,d2,取,D,最大,最大值,大值,达到,最小,d1,d2,d,式,变为,


,d,最优,推广,三维,情况,可知,d1,d2,d3,314,628,得到,一种,比较,比较简单,简单,距离,变换,换算,算法,采用,模板,数据,进行,二步,卷积,假设,血管,数据,标志,背景,滤波,数据,上至,向前,左,右,进行,滤波,算法,for,i,top,to,bottom
,for,j,back,to,front
,for,k,left,to,right
,v,i,j,k,minv,x,y,z,+wx,y,z
,x,y,z,i,j,k,邻域,遍历,历时,i,j,k,之前,遍历,体元,wx,y,z,x,y,z,i,j,k,距离,权,情况,取,314,628,波,滤,过程,一次,滤波,相同,方向,算法,for,i,bottom,to,top
,for,j,front,to,back
,for,k,right,to,left
,v,i,j,k,minv,i,j,k,v,x,y,z,+wx,y,z
,x,y,z,i,j,k,邻域,遍历,历时,i,j,k,之后,遍历,体元,wx,y,z,x,y,z,i,j,k,权,情况,取,314,628,距离,变换,数据,满足,足下,下列,条件,认为,中轴,

v,x,y,z,v,i,j,k,+wx,y,z,x,y,z,表示,i,j,k,26,邻域,wx,y,z,相应,距离,权,一条,条件,体现,最大,大圆,特征,抽取,取出,出离,离散,化,中轴,距离,变换,数据,每个,个体,体元,包含,距离,大致,边界,欧拉,距离,中轴,表示,i,j,k,v,i,j,k,以往,算法,抽取,中轴,需,找出,中轴,拓扑,关系,后进,进行,重建,一过,过程,图像,图像处理,处理,一个,难点,目前,未,圆满,圆满解决,解决,文献,这方,这方面,工作,本文,重建,位于,中轴,球面,相互,相互作用,作用,获得,采用,下面,介绍,优化,选取,算法,从中,中轴,点中,能量,大小,逐个,选取,最大,大球,加入,模型,中轴,之间,拓扑,连接,变得,不再,重要,血管,隐,式,曲面,重建,简单,实体,球,椭球,超,二次,二次曲面,曲面,构造,复杂,形状,隐,式,曲面,造型,方法,产生,生于,20,世纪,80,年代,后期,主要,要用,用于,自由,曲面,造型,多方,多方面,优于,造型,方法,节省,数据,数据量,通常,多边,多边形,造型,个数,数量,数量级,量级,生成,曲面,永远,光滑,放大,保持,光滑,光滑性,易于,进行,变形,模拟,柔性,物体,动画,非常,常有,有用,适合,表现,人体,动物,器官,液体,造型,复杂,拓扑,结构,适合,采用,CSG,方法,造型,采用,定义,定义方法,方法,重构,曲面,S,P,R3,f,P,iso,10,以是,多个,势函数,函数,叠加,势函数,函数,定义,中轴,简单,代数,曲面,函数,数值,中轴,距离,增大,单调,递减,iso,等值,采用,技术,进行,造型,已有,工作,大多,大多数,多数,用于,动画,造型,区别,主要,势函数,函数,定义,生成,曲面,叠,方法,不同,比较,典型,Blinn,指数,指数函数,函数,Muraki,blobby,Wyvill,soft,object,10,Perlin,用于,表示,超,纹理,分段,二次,多项,多项式,类似,特点,11,几种,势函数,函数,定义,定义方法,方法,没有,本质,本质区别,区别,是从,从中,中心,距离,单调,递减,函数,分段,函数,分段,必须,保持,n,阶,连续,阶,n,平滑,性,要求,定,一个,需要,注意,特点,采用,分段,函数,以利,利用,局部,支撑,特征,重构,局部,修正,帮助,希望,采用,简单,分段,二次,函数,势函数,函数,进行,重建,考虑,图,所示,情况,要求,小于,等值,面值,采用,线性,函数,大于,等值,面值,采用,二次,函数,大于,R,ei,R,均,要求,C1,连续,

,式,15,16,17,r,求导,

,式,ei,称为,半径,Ri,称为,有效,半径,称为,影响,半径,ei,势函数,函数,数值,即为,所求,等值,取,Ri,固定,定时,ki,变化,控制,相交,球,之间,过渡,形状,图,所示,显然,ki,负值,ki,绝对,绝对值,球,影响,域,势函数,函数,变化,球,之间,过渡,面呈,波动,状,ki,绝对,绝对值,球,影响,域,势函数,函数,衰减,减缓,缓慢,球,之间,过渡,趋于,平滑,

,隐,式,曲面,构造,等值,一个,难点,球,分布,难以,难以确定,确定,造型,难以,控制,时会,产生,生意,意想,意想不到,想不到,不到,形状,中轴,表示,正好,弥补,不足,血管,管体,数据,中轴,信息,包含,含,数据,等值,以内,最大,大球,球心,半径,最大,大球,分布,稍作,调整,即可,可选,构成,等值,实体,球,下面,讨论,从中,中轴,点中,中选,选取,实体,球,球心,半径,予以,调整,优化,算法,


,a,ki,b,ki,10,图,ki,等值,形状,控制,图,所示,候选,球,i,对应,势函数,函数,f,影响,域,球心,距离,小于,影响,半径,范围,称为,影响,域,数据,据点,表示,pi,iso,等值,数据,饮食,等值,以内,集合,表示,S,等值,以外,集合,表示,S,已有,N,候选,选点,选中,i,能量,函数,定义,28,Ei,最大,测,球,表面,重建,贡献,最大,算法,思想,想为,先进,进行,初始,初始化,有数,数据,据点,标记,记为,未,重建,中轴,可能,候选,选点,未,达到,重建,精度,候选,选点,未,选中,式,28,能量,函数,定义,候选,选点,优先,优先级,能量,优先,优先级,高,选取,Ei,最大,i,最佳,候选,选点,加入,模型,优化,选中,候选,选点,参数,算法,表述,modeling,initialize,初始,初始化,中轴,候选,选点,while,cur,count,prep,count,重建,精度,不满,满足,choose,best,primitive,p,if,plist,NIL,break,add,primitive,p,加入,模型,表,prep,count,cur,count,adjust,parameter,p,参数,进行,优化,节,距离,变换,已经,求得,中轴,边界,近似,欧拉,距离,重建,实体,相互,相互影响,影响,必须,实体,参数,进行,调整,找到,重建,表面,最佳,参数,k,调整,重建,表面,光滑,程度,半径,控制,实体,球,影响,域,采用,用以,以下,算法,进行,参数,优化,adjust,parameter,search,radius,搜索,最优,最优化,优化,半径,delete,primitive,删去,候选,primitive,modify,data,mask,修正,重建,数据,据点,链表,半径,调整,算法,表述,P,被评,评价,实体,半径,搜索,范围,选,中轴,最大,大球,球半径,半径,v,i,j,k,之间,式,count1,记录,不应,重建,重建,数据,据点,个数,count2,记录,新,加入,重建,个数,count1,越小越,越好,count2,越好,
search,radius,P,Lrad,最小,小半,半径,Hrad,P,rad,最大,大半,半径,Last,count1,Last,count2,if,meet,Lrad,Hrad,return,精度,满足,compute,each,count,P,Head,计算,P,count1,count2,while,Hrad,Lrad,EPSILON,Rad,P,rad,Lrad+Hrad,compute,each,count,P,Cur,计算,P,count1,count2,if,optimization,rule,Last,Cur,Head,判断,应,搜索,区间,Lrad,Rad,前半,区间,Last,Cur,else,Hrad,Rad,后半,区间,Head,Cur,这种,算法,构造,造出,表面,不断,加入,细节,实际,表面,逼近,越来,越来越,精确,避免,采用,分裂,分裂法,先采,采用,一个,简单,实体,包含,有数,数据,据点,分裂,逼近,细节,方法,低效,低效率,效率,洞,不会,分裂,分裂法,初始,骨架,设置,空洞,引起,起算,算法,失效,这种,算法,优化,过程,更加,合理,实验,采用,本文,描述,方法,胸腔,切片,数据,气管,血管,进行,造型,数据,中气,气管,血管,占据,体元,进行,分类,标记,采用,两步,滤波,法,进行,行距,距离,变换,权,采用,本文,推导,优化,切削,距离,变换,方法,图,构造,气管,模型,图,a,数据,中标,标记,记为,气管,数据,据点,图,b,为重,重建,图,胸腔,中部,部分,血管,造型,包含,腔,静脉,腔,动脉,气管,肺动脉,动脉,血管,图,看出,采用,中轴,元,球,造型,保留,大量,分枝,绘制,强,立体,立体感,较大,实体,图,心室,造型,这种,方法,不适,适宜,


,a,气管,数据,据点,b,造型,重建,图,胸腔,部分,血管,造型,图,气管,造型,本文,讨论,利用,中轴,隐,式,曲面,面对,血管,气管,管状,多分,分枝,组织,进行,造型,方法,介绍,中轴,抽取,方法,推导,导出,简单,势能,函数,采用,控制,重建,建中,优化,过程,重建,建出,管状,组织,过渡,平滑,拓扑,结构,保存,完好,重建,方法,避免,轮廓,重建,建中,轮廓,对应,问题,分枝,问题,难题,采用,隐,式,曲面,面表,表达,表达方式,方式,简洁,合理,易于,绘制,本文,研究,得到,国家,国家自然科学基金,自然,自然科,自然科学,科学,科学基金,基金,资助,作者,郭,红,晖,女,1969,生,博士,主要,研究,领域,医学,信息,可视,可视化,医学,图像,图像处理,处理,计算,计算机,算机,图形,图形学,形学,彭,群生,1947,生,博士,教授,博士,博士生,导师,主要,研究,领域,真实,真实感,真实感图形,实感,图形,计算,计算机,算机,机动,动画,三维,几何,造型,工程,工程图,工程图纸,图纸,扫描,识别,李,捷,1973,生,博士,博士生,主要,研究,领域,实时,图形,显示,多分,分辨,分辨率,辨率,造型,科学,科学计算,计算,可视,可视化,本文,通讯,通讯联系,联系,联系人,彭,群生,杭州,310027,浙江,浙江大学,大学,CAD,CG,国家,重点,实验,实验室,作者,单位,郭,红,晖,彭,群生,浙江,浙江大学,大学,CAD,CG,国家,重点,实验,实验室,杭州,310027,李,捷,清华,清华大学,华大,大学,计算,计算机,计算机科学,算机,科学,技术,系,北京,100084,参考,参考文献,文献,Suto,Y,Kato,M,et,al,Three,dimensional,display,of,X,Ray,CT,image,extraction,and,display,of,cerebral,ventricle,The,Visual,Computer,1986,90,96
,Mori,K,Hasegawa,J,et,al,A,fast,rendering,method,using,the,tree,structure,of,objects,in,visualized,bronchus,endoscope,system,In,Hohne,K,H,ed,Proceedings,of,Visualization,in,Biomedical,Computing,96,Hamburg,Springer,Verlag,1996,33,42
,Kriete,A,Hierarchical,data,representation,of,lung,to,model,morphology,and,function,In,Hohne,K,H,ed,Proceedings,of,Visualization,in,Biomedical,Computing,96,Hamburg,Springer,Verlag,1996,399,404
,Ge,Y,Stelts,D,et,al,3D,skeleton,for,virtual,colonoscopy,In,Hohne,K,H,ed,Proceedings,of,Visualization,in,Biomedical,Computing,96,Hamburg,Springer,Verlag,1996,449,454
,Masotani,Y,Masamune,K,et,al,Region,growing,based,reature,extraction,algorithm,for,tree,like,objects,In,Hohne,K,H,ed,Proceedings,of,Visualization,in,Biomedical,Computing,96,Hamburg,Springer,Verlag,1996,161,171
,Borgefors,G,Distance,transformations,in,arbitrary,dimensions,Computer,Vision,Graphics,and,Image,Processing,1984,27,321,345
,Bittar,E,Tsingos,N,et,al,Automatic,reconstruction,of,unstructured,3D,data,combining,a,medial,axis,and,implicit,surfaces,Computer,Graphics,Forum,1995,14,457,468
,Blinn,J,A,generalization,of,algebraic,surface,drawing,ACM,Transactions,on,Graphics,1982,235,256
,Muraki,S,Volumetric,shape,description,of,range,data,using,blobby,model,Computer,Graphics,1991,25,227,235
,10,Wyvill,G,McPheeters,C,et,al,Data,structure,for,soft,objects,The,Visual,Computer,1986,227,234
,11,Perlin,K,Hypertexture,Computer,Graphics,1989,23,253,262

,本文,1997,08,22,收到,原稿,1998,05,19,收到,修改,修改稿,改稿