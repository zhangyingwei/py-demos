计算,计算机,算机,应用,研究,
APPLICATION,RESEARCH,OF,COMPUTERS
2000,Vol,17,No,P,98,100




Windows,视频,应用,应用程序,程序,程序开发,开发,郑,东,陈,淑珍,摘,介绍,视频,应用,应用程序,程序,程序开发,开发,基本,基本原理,本原,原理,详细,说明,视频,显示,捕获,视频,频数,数据,获取,处理,结合,结合实际,实际,应用,讲解,对视,视频,帧,图象,DIB,操作,回调,函数,对视,视频,原始,原始数据,数据,实时,获取,处理,关键,关键词,VFW,DIB,回调,函数,前言,VFW,Microsoft,Video,for,Window,微软,微软公司,公司,开发,Windows,视频,捕捉,视频,编辑,视频,播放,视频,应用,应用程序,程序,提供,软件,软件开发,开发,开发工具,工具,开发,开发工具,工具,工具包,包含,开发,视频,应用,应用程序,程序,所需,需要,接口,接口函数,函数,APIs,以求,简化,程序,程序员,开发,Windows,视频,应用,应用程序,程序,工作,VFW,体系,体系结构,结构,VFW,包括,AVICAP,MCIAVI,DRAWDIB,AVIFILE,ICM,多个,组件,组件,协调,工作,完成,视频,图象,捕获,播放,编辑,文件,管理,功能,图,描述,VFW,各组,组件,相互,相互关系,关系,

,图,视频,捕获,程序,VFW,利用,AVICAP,子集,生成,AVICap,窗口,完成,视频,捕获,VFW,利用,DRAWDIB,子集,完成,视频,编辑,DRAWDIB,提供,高性,高性能,性能,DIB,图象,绘画,能力,DRAWDIB,利用,ICM,AVI,文件,转化,化为,DIB,位图,利用,ICM,支持,压缩,DIB,位图,AVICAP,DRAWDIB,ICM,可选,压缩,管理,管理器,理器,来访,访问,AVIFILE,子集,VFW,ICM,压缩,和解,解压,解压缩,压缩,视频,频数,数据,显示,翻译,翻译器,提供,压缩,数据,程序,能够,定制,专用,压缩,管理,管理器,理器,压缩,解压,解压缩,压缩,绘制,视频,图象,VFW,利用,AVIFILE,视频,捕获,播放,编辑,提供,文件,管理,功能,视频,图象,捕获,VFW,利用,AVICAP,子集,开发,视频,捕捉,应用,应用程序,程序,AVICAP,子集,包括,一个,AVICAP,窗口,视频,捕捉,相关,回调,函数,AVICAP,窗口,发送,消息,命令,消息,宏,函数,数集,AVICAP,窗口,VFW,定义,Windows,窗口,子,窗口,客户,区,显示,采集,采集卡,传入,计算,计算机,算机,实时,视频,图象,客户,区里,图象,两种,显示,模式,一种,覆盖,OverLay,模式,一种,预览,PreView,模式,覆盖,模式,显示,速度,预览,模式,快,应用,应用程序,程序,捕获,图象,进行,加工,只能,预览,模式,图象,送到,系统,内存,在内,内存,图象,进行,加工,图象,显示,创建,AVICAP,窗口,Windows,MDI,应用,应用程序,程序,一个,框架,窗口,口中,显示,多个,文档,档子,窗口,MFC,每个,文档,档子,窗口,包括,一个,视,一个,文档,视,只用,用作,用户,交互,接口,接口界面,界面,AVICAP,窗口,定义,视,子,窗口,窗口,客户,区,显示,采集,视频,图象,接收,收用,用户,命令,窗口,创建,过程,视,OnCreate,
capCreateCaptureWindow,创建,AVICAP,窗口,
If,capDriverConnect,AVICAP,窗口,驱动,驱动程序,程序,连接,capDriverGetCaps,
capSetCallbackOnXXX,设置,回调,函数,
capCreateCaptureWindow,AVICAP,窗口,创建,函数,capDriverConnect,AVICAP,窗口,采集,采集卡,驱动,驱动程序,程序,连接,连接起来,接起,起来,连接,连接成,成功,该函,函数,返回,真值,调用,capDriverGetCaps,检查,视频,采集,采集卡,支持,功能,返回,返回值,保存,存在,CAPDRIVERCAPS,结构,结构,变量,量表,表明,采集,采集卡,支持,覆盖,显示,模式,改变,视频,图象,采集,硬件,改变,采集,图象,格式,capSetCallbackOnXXX,程序,程序员,定义,回调,函数,通知,知底,底层,驱动,驱动程序,程序,供,采集,硬件,发出,中断,消息,时调,调用,AVICAP,定义,多个,回调,函数,形式,响应,不同,中断,消息,相似,消息,宏,函数,设置,设置,函数,参数,包含,待定,定义,回调,函数,函数,函数指针,指针,应用,应用程序,程序,句柄,一个,视频,处理,处理程序,程序,基本,本部,部分,视频,输入,设备,连接,连接成,成功,即可,采集,视频,视频流,流进,进行,处理,静态,帧,图象,捕获,显示,AVICAP,窗口,动态,视频,图象,需将,当前,显示,一帧,图象,捕获,显示,达到,画面,凝结,效果,capGrabFrame,消息,函数,捕获,视频,图象,一帧,图象,转变,变为,静态,图象,保存,存在,帧,图象,缓冲,缓冲区,区里,保存,存在,缓冲,缓冲区,区里,图象,capEditCopy,宏,函数,拷贝,拷贝到,剪贴,剪贴板,贴板,DIB,device,independent,bitmap,操作,显示,
DWORD,dwSize,capGetVideoFormatSize,hWnd,
capGetVideoFormat,hWnd,BitMapInfo,dwSize,
BitMapInfo,bmiHeader,biWidth,capwidth,
BitMapInfo,bmiHeader,biHeight,capheight,获得,视频,图象,格式,确定,width,height,
HANDLE,hData,GlobalFree,HGLOBAL,hData,
hData,HANDLE,CopyHandle,GetClipboardData,CF,DIB,获得,capEditCopy,宏,函数,拷贝,拷贝到,剪贴,剪贴板,贴板,中图,图象,数据,HANDLE,CF,DIB,参数,指定,定数,数据,数据类型,类型,DIB,图象,数,宽,高,capwidth,capheight,
CPalette,m,palDIB,new,CPalette,CreateDIBPalette,HDIB,hData,m,palDIB,
CClientDC,dc,this,获得,客户,区,DC,
CRect,dcrect,LONG,left,LONG,top,LONG,right,LONG,bottom,实际,显示,显示图,图象,dcrect
CRect,dibrect,capwidth,capheight,显示,dcrect,图象,实际,大小,
PaintDIB,dc,m,hDC,dcrect,HDIB,hData,m,array,dibrect,m,palDIB,一般来说,dcrect,dibrect,不会,大小,PaintDIB,自行,调整,放大,缩小,图象,dcrect,大小,图象,显示,可调,调整,视频,显示,窗口,大小,避免,图象,窗口,视频,窗口,口重,重叠,SetWindowPos,hWnd,NULL,Xposition,Yposition,width,height,NULL,一个,监视,安全,系统,相应,视频,切换,硬件,计算,计算机,算机,机上,可分,显示,多路,视频,视频信号,频信,信号,达到,监视,目的,计算,计算机,算机,机上,视频,输入,设备,限制,每次,只能,显示,一路,活动,视频,图象,若想,显示,多路,视频,视频信号,频信,信号,只能,专用,硬件,多画面,画面,处理,处理器,理器,多路,视频,视频信号,频信,信号,合成,成为,一路,信号,计算,计算机,算机,机上,显示,过上,上述,静态,帧,图象,捕获,显示,方法,实现,多画面,画面,效果,建立,一个,循环,显示,机制,依次,捕获,各路,视频,视频信号,频信,信号,帧,图象,显示,依次,进行,刷新,实际,测试,可得,得到,每秒,帧,效果,虽不,专用,硬件,效果,要求,不严,严格,场合,方法,满足,实际,需要,capFileSaveDIB,缓冲,缓冲区,图象,转化,化为,DIB,位图,保存,存在,磁盘,盘上,得到,捕获,图象,数据,视频,处理,处理程序,程序,很重,重要,一部,一部分,部分,即是,捕获,图象,原始,原始数据,数据,进行,处理,AVICAP,回调,函数,机制,支持,特定,应用,AVICAP,回调,函数,包含,视频,视频流,流回,回调,函数,应用,应用程序,程序,视频,流,捕获,利用,该函,函数,访问,捕获,原始,原始数据,数据,图象,帧,回调,函数,应用,应用程序,程序,预览,模式,以利,利用,该函,函数,访问,显示,图象,数据,视频,视频流,流回,回调,函数,帧,回调,函数,参数,包含,一个,指向,视频,视频头,VIDEOHDR,结构,指针,结构,
STRUCT,VIDEOHDR
,LPSTR,lpData,指向,视频,频数,数据,缓冲,缓冲区,指针,DWORD,dwBuffer,Length,视频,频数,数据,缓冲,缓冲区,长度,DWORD,dwBytesUsed,缓冲,中实,实际,数据,长度,DWORD,dwTimeCaptured,距离,第一,一帧,捕获,图象,时间,结构,成员,变量,看到,利用,结构,访问,保存,存在,视频,频数,数据,缓冲,缓冲区,区里,被捕,捕获,图象,数据,图象,数据,排列,顺序,视频,图象,显示,模式,象素,顺序,顺序排列,排列,AVICAP,利用,capSetCallbackOnVideoStream,消息,宏,函数,设置,流回,回调,函数,利用,capSetCallbackOnFrame,宏,函数,设置,帧,回调,函数,回调,函数,设置,流回,回调,函数,视频,视频流,捕获,帧,图象,存盘,之前,Windows,调用,帧,回调,函数,预览,图象,显示,之前,调用,回调,函数,Windows,系统,调用,消息,响应,响应函数,函数,AVICAP,子集,集中,回调,函数,采集,采集卡,驱动,驱动程序,程序,Windows,发出,中断,消息,Windows,响应,回调,函数,及时,反映,帧,图象,捕获,完成,采集,采集卡,状态,改变,捕获,后台,线程,让出,CPU,控制,控制权,重要,信息,应用,应用程序,程序,有着,着重,重要,应用,视频,窗口,建立,视频,输入,设备,建立,连接,初始,初始化,完成,设置,回调,函数,
int,CView,OnCreate,LPCREATESTRUCT,lpCreateStruct,CapSetCallbackOnVideoStream,hwndC,LPVOID,MakeProcInstance,FARPROC,capVideoStreamC
allback,AfxGetInstanceHandle,
LRESULT,CALLBACK,EXPORT,capVideoStreamCallback,HWND
hWnd,LPVIDEOHDR,lpVHdr,捕获,数据,数据流,回调,函数,VIDEOHDR,结构,指针,lpVHdr,即可,可获,获得,视频,频数,数据,进行,处理,帧,回调,函数,capSetCallbackOnFrame,预览,图象,显示,之前,调用,工作,预览,Preview,模式,图象,送到,系统,内存,在内,内存,图象,进行,加工,图象,显示,帧,捕获,图象,数据,回调,函数,速度,较慢,处理,活动,视频,图象,显示,如要,视频,图象,显示,一个,方框,标记,特定,区域,可使,使用,帧,回调,函数,CapSetCallbackOnFrame,设置,相同,同于,capSetCallbackOnVideoStream,函数,
LRESULT,CALLBACK,EXPORT,capVideoStreamCallback,HWND
,hWnd,LPVIDEOHDR,lpVHdr,捕获,数据,数据流,回调,函数,
BYTE,data,当前,图象,数据,
k,capheight,capwidth,k,捕获,图象,实际,大小,
for,i,i,k,i++,data,i,lpvdhr,lpData,i,捕获,图象,数据,读入,data,对应,应于,方框,框上,一点,图象,实际,坐标,找到,data
,中表,表示,数据,变为,黑色,
return,LRESULT,TRUE,视频,频数,数据,保存,存为,AVI,格式,文件,常用,处理,处理方式,方式,AVI,文件,文件格式,格式,保存,捕获,过程,
capFileSetCaptureFile,设置,保存,文件,文件,文件名,
capFileAlloc,分配,捕获,文件,磁盘,磁盘空间,空间,可选,
capCaptureSequence,进行,视频,图象,捕获,
capCaptureAbort,结束,视频,捕获,capFileAlloc,预先,分配,捕获,文件,占,磁盘,空间,大小,避免,磁盘,盘中,中产,产生,碎片,提高,视频,频数,数据,数据流,保存,速度,CapCaptureSequence,启动,图象,捕获,捕获,时间,CAPTUREPARMS,结构,设置,capCaptureAbort,中途,退出,捕获,过程,capCaptureSetSetup,配置,配置图,图象,捕获,过程,工作,参数,该函,函数,参数,参数表,数表,包含,一个,指向,捕获,参数,CAPTUREPARMS,结构,指针,CAPTUREPARMS,结构,主要,成员,变量,功能,
STRUCT,CAPTUREPARMS
,
DWORD,dwRequestMicroSecPerFrame,帧,图象,捕获,时间,毫秒,单位,
UINT,wPercentDropForError,捕获,过程,系统,忙,允许,掉,帧,数目,
UINT,wTimeLimit,捕获,时间,AVI,文件,一种,适合,存储,播放,视频,频信,信息,文件,文件格式,格式,AVI,参考,交换,交换文件,换文,文件,文件格式,格式,RIFF,Reference,Interchange,File,Format,数据,数据结构,结构,结构型,构型,文件,结构,
RIFF,AVI,
LIST,hdrl,Avih,MainAVIHeader,LIST,strl,Strh,Stream,header,Strf,Stream,format,additional,header,data
,
LIST,movi,LIST,rec,subchunk,subchunk,AVIIndex,MainAVIHeader,文件,件头,结构,规定,文件,帧,数,和文,文件,文件大小,大小,信息,Stream,header,流,信息,数据,数据流,结构,Stream,format,流,类型,fccType,定,视频,视频流,一个,BITMAPINFO,结构,视频,频数,数据,块,chunk,可分,分为,db,未,压缩,RGB,DIB,结构,dc,压缩,DIB,数据,pc,调色,调色板,改变,数据,压缩,DIB,数据,播放,必须,调用,指定,解压,解压缩,压缩,程序,处理,编辑,AVI,需要,获得,原始,原始数据,数据,数据流,
AVIFileOpen,打开,一个,AVI,文件,获得,文件,句柄,
AVIFileInfo,获得,AVI,文件,相关,信息,图象,Height,Width,AVI,文件,数据,数据流,Data,stream,数目,信息,
AVIFileGetStream,建立,一个,指向,需要,访问,数据,数据流,指针,
AVIStreamInfo,读取,存储,数据,数据流,信息,AVISTREAMINFO,结构,
AVIStreamRead,读取,读取数据,数据,数据流,原始,原始数据,数据,视频,频数,数据,数据流,原始,原始数据,数据,构成,图象,数据,数据位,压缩,缩图,图象,解压,缩,使用,
AVIStreamRelease,
AVIFileRelease,Video,Stream,数据,经压缩,压缩,可用,AVIStreamGetFrameOpen,AVIStreamGetFrame,AVIStreamGetFrameClose,读取,PGETFRAME,AVIStreamGetFrameOpen,pavi,lpbiWanted,pavi,指向,视频,频数,数据,数据流,指针,返回,一个,GetFrame,对象,供,AVIStreamGetFrame,使用,读取,读取数据,数据,系统,不能,找到,压缩,视频,频数,数据,数据流,解压,解压缩,压缩,解压,解压缩,压缩,程序,返回,NULL,
LPVOID,AVIStreamGetFrame,PGETFRAME,pgf,LONG,lPos,lPos,指定,视频,频数,数据,数据流,中所,所需,帧,位置,AVIStreamGetFrame
,函数,读取,视频,频数,数据,数据流,格式,数据,数据位,需要,压,缩,视频,频数,数据,数据流,流进,进行,解压,解压缩,压缩,返回,指向,BITMAPINFOHEADER,结构,指针,BITMAPINFOHEADER,结构,应用,应用程序,程序,读取,解压,解压缩,压缩,帧,图象,DIB,数据,
LONG,AVIStreamGetFrameClose,PGETFRAME,pget,释放,系统,系统资源,资源,结束,结束语,本文,对视,视频,程序,开发,发作,较为,详细,描述,介绍,视频,应用,应用程序,程序,常见,编程,方法,实际,开发,应用,问题,提出,相应,解决,方法,郑,东,武汉,武汉大学,大学,电信,学院,武汉,430072,陈,淑珍,武汉,武汉大学,大学,电信,学院,武汉,430072,参考,参考文献,文献,Microsoft,Corporation,Video,for,Window,Development,Kit
2,Kate,Gregory,Visual,C++,开发,使用,使用手册,手册,北京,机械,机械工业,工业,出版,出版社,1998,收稿,日期,1999,月,20,日