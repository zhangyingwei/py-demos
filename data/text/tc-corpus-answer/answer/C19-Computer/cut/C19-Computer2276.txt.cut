计算,计算机,算机,应用,研究,
APPLICATION,RESEARCH,OF,COMPUTERS
2000,Vol,17,No,P,64,66



,多线,多线程,线程,线程技术,技术,自定,自定义,定义,消息,编程,实现,Windows,9x,异步,串行,通信,张,志,明,李,蓉,艳,王,磊,摘,分析,Windows,95,98,平台,台上,异步,串行,通信,程序,程序开发,开发,开发方法,方法,结合,开发,实践,C++Builder,语言,言实,实现,多线,多线程,线程,线程技术,技术,消息,响应,机制,异步,串行,通信,给出,编程,步骤,详细,解释,关键,关键词,串行,通信,多线,多线程,线程,消息,API,事件,前言,串行,通信,具有,连接,简单,使用,灵活,方便,数据,据传,传递,可靠,优点,工业,监控,数据,采集,实时,实时控制,控制,控制系统,系统,得到,广泛,广泛应用,应用,Windows,95,98,对系统,系统,底层,操作,采取,屏蔽,策略,允许,用户,硬件,I,O,口,进行,直接,操作,进行,串行,通信,只能,调用,API,函数,完成,Windows,9x,消息,队列,驱动,管理,管理程序,程序,DOS,中断,服务,服务例程,例程,下面,实现,实时,实时性,可靠,可靠性,得不到,不到,保证,线程,消息,多任务,多任务处理,任务,处理,编程,有效,解决,问题,提高,数据,数据传输,据传,传输,吞吐,吞吐量,应用,应用程序,程序,可靠,可靠性,Windows,9x,支持,线程,抢先,式,多任务,多任务处理,任务,处理,进程,Process,应用,应用程序,程序,执行,实例,线程,Thread,进程,内部,执行,路径,每个,进程,至少,少有,一个,主线,线程,包括,若干,干子,线程,线程,独立,运行,从根本上,根本,线程,系统,系统调度,调度,一个,简单,代码,单元,同一,进程,每个,线程,一组,CPU,指令,一组,CPU,寄存,寄存器,一个,堆栈,Windows,9x,分配,CPU,时间,片,需要,小心,处理,线程,同步,问题,线程,多任务,任务,务使,同一,一程,程序,两个,多个,部分,时运,运行,一个,一个多,多线,多线程,线程,应用,应用程序,程序,实际,实际上,其内,内部,实现,多任务,任务,扩展,代码,赋予,并行,并行执行,执行,特性,执行,实时,实时性,随机,随机性,强,操作,提高,CPU,利用,利用率,用率,加快,通信,程序,信息,信息处理,处理,处理速度,速度,操作,操作系统,系统,线程,分配,CPU,时间,片时,调度,调度机,机制,评价,活动,线程,优先,优先级,优先,执行,优先,优先级,级别,高,活动,线程,挂起,优先,优先级,级别,低,活动,线程,活动,线程,优先,优先级,级别,相同,系统,系统调度,调度,程序,轮转,方式,分配,CPU,时间,片,抢先,式,多任务,多任务处理,任务,处理,系统,系统调度,调度,程序,确定,定有,一个,优先,优先级,级别,更,高,线程,准备,运行,系统,立刻,优先,优先级,级别,低,线程,挂起,处于,运行,行状,状态,CPU,时间,片,分配,配给,优先,优先级,级别,高,线程,Windows,9x,系统,提供,开放,开放式,通用,用功,功能,增强,接口,Win32,API,应用,编程,接口,一个,复杂,函数,消息,集合,Windows,9x,串口,通信,设备,支持,基本,输入,输入输出,输出,驱动,驱动程序,程序,集成,成为,一体,串口,打开,关闭,读取,写入,所用,函数,操作,作文,文件,函数,相同,系统,统通,称为,设备,控制,块,DCB,数据,数据结构,结构,串行,串行口,串口,通信,驱动,驱动程序,程序,进行,配置,串行,通信,基本,编程,串行,通信,编程,基本,流程,图,所示,先调,调用,API,函数,CreateFile,打开,初始,初始化,需要,操作,串行,端口,

,图,串行,通信,编成,基本,流程,
HANDLE,CreateFile,LPCTSTR,lpFileName,打开,通信,串口,名称,
DWORD,wDesiredAccess,指定,串口,访问,方式,设置,可读,可写,方式,
DWORD,dwShareMode,指定,串口,操作,共享,模式,串口,不能,共享,只能,设置,
LPSECURITY,ATTRIBUTES,lpSecurityAttributes,设置,串口,安全,全属,属性,Win9x,不支,支持,安全,全属,属性,此项,设置,NULL,
DWORD,dwCreationDistribution,通信,串口,创建,方式,只能,OPEN,EXISTING,
DWORD,dwFlagsAndAttributes,指定,串口,属性,标志,设置,FILE,FLAG,OVERLAPPED
,重叠,I,O,操作,指定,串口,异步,方式,通信,
HANDLE,hTemplateFile,串口,通信,必须,设置,NULL,成功,打开,串行,串行口,函数,返回,串口,句柄,串口,设备,属性,配置,以下,API,函数,数完,完成,SetupComm,设置,串行,通信,端口,输入,输出,缓冲,缓冲区,大小,设备,控制,块,DCB,修改,设置,串口,工作,状态,参数,波特,波特率,数据,数据位,奇偶,奇偶校验,校验,校验位,通信,参数,SetCommState,DCB,结构,内容,写入,串口,设置,SetCommTimeouts,设置,串口,读写,读写操作,操作,溢出,时间,事件,事件驱动,驱动,I,O,设备,SetCommMask,设置,通信,事件,句柄,WaitCommEvent,等待,通信,事件,发生,设置,工作,完成,串行,通信,可用,ReadFile,串口,进行,读,操作,WriteFile,串口,进行,写,操作,串行,通信,结束,时调,调用,调用函数,函数,CloseHandle,关闭,CreateFile,函数,返回,串口,句柄,注,函数,参考,C++,Builder,在线,帮助,助手,手册,详细,详细资料,资料,多线,多线程,线程,串口,I,O,通信,编程,串口,读,写,操作,视为,同一,进程,两个,不同,任务,创建,读,线程,写,线程,完成,成对,串口,读,写,操作,线程,协调,调和,同步,事件,Event,临界,区,CriticalSection,对象,实现,异步,串行,通信,事件,随机,随机性,实时,实时性,要求,通信,通信线,线程,优先,先于,主线,线程,处理,设置,线程,优先,优先级,级别,读,线程,优先,优先级,gt,写,线程,优先,优先级,gt,主线,线程,优先,优先级,C++,Builder,多线,多线程,线程,编程,支持,直接,使用,Win32,SDK,提供,API,函数,CreateThread,SetThreadPriority,ResumeThread,ExitThread,函数,编程,复杂,编程,工作,工作量,利用,C++,Builder,提供,TThread,线程,对象,线程,对象,TThread,封装,多线,多线程,线程,编程,常用,方法,数据,大大,大大简化,简化,多线,多线程,线程,编程,工作,工作难度,作难,难度,编程,TThread,派生,对象,创建,相应,实例,即可,常用,重要,属性,方法,FreeOnTerminate,属性,布尔,类型,设置,True,在线,线程,结束,运行,行时,时会,强迫,TThread,对象,自动,释放,设置,False,需要,显,式,程序,程序代码,代码,调用,对象,析,构,函数,释放,缺省,设置,False,Priority,属性,设置,该线,线程,优先,优先级,级别,C++,Builder,定义,枚举,类型,TThreadPriority,tpIdle,tpLowest,tpLower,tpNormal,tpHigher,tpHighest,tpTimeCritical,表示,线程,优先,优先级,缺省,设置,tpNormal,Terminated,属性,布尔,类型,线程,结束,标志,True,表示,线程,结束,False,表示,线程,正在,运行,需要,Execute,函数,不断,检查,True,结束,线程,fastcall,TThread,bool,CreateSuspended,对象,构造,构造函数,函数,参数,CreateSuspended,False,线程,创建,自动,调用,Execute,方法,函数,立即,启动,运行,CreateSuspended,True,线程,挂起,状态,启动,virtual,void,fastcall,Execute,void,成员,函数,创建,线程,执行,代码,部分,派生,派生类,必须,重载,方法,函数,函数,体内,加入,程序,程序代码,代码,实现,功能,void,fastcall,Synchronize,TThread,Method,Method,同步,方法,执行,行时,挂起,线程,控制,控制权,交给,主线,线程,主线,线程,调用,参数,Method,所指,指定,函数,过程,完成,控制,控制权,交还,交还给,还给,调用,Synchronize,方法,线程,Synchronize,方法,避免,多线,多线程,线程,之间,冲突,防止,程序,死锁,void,fastcall,Terminate,void,调用,成员,方法,函数,终止,线程,运行,自动,置,线程,结束,标志,Terminated,True,多线,多线程,线程,编程,实现,异步,串行,通信,利用,Windows,9x,多线,多线程,线程,编程,编程技术,技术,编程,创建,辅助,辅助线,线程,实时,监视,串口,通信,状态,串口,通信,监视,视线,线程,通信,状态,主线,线程,发送,相应,消息,主线,线程,分析,处理,多线,多线程,线程,串行,通信,法,最大,优点,程序,对接,接收,接收数据,数据,具有,自主,觉察,能力,辅助,通信,监视,视线,线程,查询,数据,已经,发送,发送到,送到,串行,串行口,口上,辅助,辅助线,线程,自动,接收,接收数据,数据,主线,线程,发送,发送数据,数据,接收,收到,消息,应用,应用程序,程序,消息,处理,通信,串口,口传,传送,送过来,数据,采用,通信,监视,视线,线程,占用,CPU,时间,实践,编程,线程,对象,TThread,派生,建立,辅线,线程,串口,读,线程,TCommReadThread,串口,写,线程,TCommWriteThread,完成,成串,串口,通信,操作,监视,管理,串口,通信,输入,输出,读,线程,通信,串口,读取,读取数据,数据,传输,输给,主线,线程,处理,写,线程,主线,线程,传来,数据,写入,通信,串口,输出,主线,线程,完成,成串,串口,通信,资源,打开,参数,配置,关闭,工作,完成,读,写,线程,创建,关闭,多线,多线程,线程,协调,数据,中间,处理,前端,端的,人机,人机交互,交互,工作,图,图,图,程序,程序结构,结构,流程,流程图,串口,写,线程,流程,流程图,串口,读,线程,流程,流程图,

,图,异步,串行,通信,程序,程序流程,流程,流程图,

,图,写,线程,流程,流程图,

,图,读,线程,流程,流程图,串行,通信,特点,采用,事件,Event,对象,临界,区,CriticalSection,对象,同步,串行,通信,线程,通信,端口,存储,区,数据,访问,避免,引起,多线,多线程,线程,冲突,死锁,事件,对象,作用,告诉,线程,发生,特定,事件,相关,API,函数,CreateEvent,创建,事件,对象,调用,成功,后用,SetEvent,ResetEvent,手工,重置,事件,对象,状态,CloseHandle,解除,事件,对象,WaitForSingleObject,WaitForMultipleObjects,函数,数分,等待,一个,多个,特定,事件,发生,临界,区,对象,作用,保护,主线,线程,读,写,线程,之间,共享,数据,一次,允许,一个,线程,有权,访问,保护,数据,InitializeCriticalSection,初始,初始化,临界,区,对象,DeleteCriticalSection,删除,临界,区,对象,释放,占,内存,EnterCriticalSection,LeaveCriticalSection,进入,退出,数据,数据保护,保护,状态,线程,结构,结合,对象,含义,解释,发送,发送数据,数据,完成,成事,事件,写,线程,建立,等待,该事,事件,发生,该事,事件,写,线程,主线,线程,传递,递过来,数据,通信,串口,发送,成功,产生,读取,读取数据,数据,完成,成事,事件,读,线程,建立,等待,该事,事件,发生,读,线程,监测,通信,串口,状态,通信,串口,成功,读取,读取数据,数据,数据,送往,主线,线程,后发,发生,通信,过程,错误,误事,事件,读,线程,建立,等待,该事,事件,发生,应用,应用程序,程序,利用,此事,事件,监视,通信,过程,中发,发生,错误,误事,事件,目的,需要,串口,参数,参数设置,设置,函数,BOOL,SetCommMask,HANDLE,hFile,DWORD,dwEvt,Mask,设置,hFile,串口,句柄,dwEvtMask,EV,ERR,常量,写,线程,读,线程,结束,事件,写,线程,读,线程,构造,构造函数,函数,中建,建立,等待,该事,事件,发生,在线,线程,执行,执行期,行期,期间,调用,Terminate,函数,终止,线程,产生,临界,区,对象,主线,线程,写,线程,定义,并建,建立,同步,写,线程,主线,线程,共享,串口,发送,发送数据,数据,写,线程,等待,写,数据,完成,成事,事件,线程,结束,事件,读,线程,等待,待读,读数,读数据,数据,完成,成事,事件,通信,错误,误事,事件,线程,结束,事件,实现,进程,内部,主线,线程,读,写,线程,之间,数据,数据交换,交换,自定,自定义,定义,消息,相应,事件,发生,后发,发送,发送给,送给,主线,线程,相应,消息,处理,WM,COMM,WRITE,写,线程,成功,发送,发送数据,数据,后发,发送,发送给,送给,主线,线程,WM,COMM,READ,读,线程,接收,串口,数据,成功,主线,线程,发送,主线,线程,收到,消息,对接,接收,收到,数据,进行,后续,处理,WM,COMM,ERROR,读,写,线程,发送,lParam,未用,wParam,用于,标志,消息,发送,发送者,写,线程,读,线程,读,写,线程,通信,过程,中发,发生,错误,误时,发送,消息,主线,线程,主线,线程,挂起,相应,线程,直至,通信,错误,误事,事件,事件处理,处理,处理完毕,理完,完毕,主线,线程,运行,行时,写,线程,共享,串行,端口,发送,发送数据,数据,内存,存单,单元,共享,数据,CriticalSection,临界,区,对象,保护,写,线程,共享,数据,进行,访问,申请,临界,区,所有权,有权,访问,完成,释放,所有权,有权,退出,临界,区,状态,主线,线程,在此期间,期间,不能,修改,共享,数据,只能,等待,写,线程,临界,区,状态,结束,访问,访问共享,共享,数据,同样,主线,线程,修改,串口,发送,发送数据,数据,主线,线程,临界,区,对象,保护,结束,结束语,本文,已成,成功,应用,用于,智能,大厦,监控,控系统,系统,电子,密码,门锁,网络,监控,分系统,系统,实践,实践,实践证明,证明,多线,多线程,线程,编程,实现,串行,通信,近距,近距离,距离,RS232,接口,通信,远距,远距离,距离,RS485,接口,通信,能取,取得,良好,效果,张,志,明,西北,西北工业大学,工业,业大,大学,电子,电子信息,信息,信息工程,工程,工程学,工程学院,学院,西安,710072,李,蓉,艳,西北,西北工业大学,工业,业大,大学,电子,电子信息,信息,信息工程,工程,工程学,工程学院,学院,西安,710072,王,磊,同济,同济大学,大学,上海,200092,参考,参考文献,文献,郝,杰,崔,晓,东,龚,惠,译,BORLAND,C++,BUILDER,编程,指南,北京,电子,工业,出版,出版社,1998
2,Borland,C++,Builder,Online,Help
,收稿,日期,1999,11,15
