计算,计算机,算机,应用,
Computer,Applications
1999,19,卷,Vol,19,No,1999



PowerBuilder,Oracle,编程,应用,经验,张,坤,伊,希,荣,

,摘,本文,PowerBuilder,Oracle,推出,时间,差异,造成,完全,支持,情况,对应,应用,编程,中日,日期,型,数据,输入,输出,数据,窗口,记录,增,删,改,Table,表,之间,键,连接,问题,进行,探讨,给出,解决,解决方案,方案,关键,关键词,PowerBuilder,编程,应用,日期,型,数据,数据,窗口,键,连接,

,客户,客户机,服务,服务器,务器,开发,环境,PowerBuilder,具有,优秀,功能,特性,面向,面向对象,面向对象编程,对象,编程,可视,可视化,化开,开发,环境,事件,事件驱动,驱动,编程,方式,开放,开放式,开放式系统,系统,图形,图形用户界面,用户,用户界面,界面,尤其,开放,开放系统,系统,功能,PowerBuilder,最优,优秀,受用,用户,欢迎,功能,PowerBuilder,一个,开放,协作,式,环境,访问,一个,常用,后台,台数,数据,数据库,数据库系统,据库,系统,Oracle,Sybase,Informix,DB2,开发,开发工具,工具,工具集,集成,PowerBuilder,笔者,进行,企业,MIS,信息,信息管理,信息管理系统,管理,管理系,管理系统,系统,开发,发过,过程,整个,系统,采用,CLIENT,SERVER,结构,采用,PowerBuilder,CLIENT,端的,开发,开发工具,工具,数据,数据库,据库,服务,服务器,务器,ORACLE8,ENTERPRISE,PowerBuilder,Oracle,相连,PowerBuilder,Oracle,之间,存在,推出,时间,差异,推出,时间,迟于,此前,支持,依赖,依赖于,赖于,提供,补丁,程序,出现,没有,完全,支持,情况,PowerBuilder,Oracle,中文,中文版,文版,日期,格式,兼容,在编,编程,应用,存在,值得,值得注意,注意,地方,日期,型,数据,输入,输出,PowerBuilder,数据,窗口,DataWindow,提供,大量,内置,功能,应用,中大,大多,大多数,多数,数据,数据库,据库,交互,DataWindow,完成,方便,编程,编程人员,人员,更加,加深,深入,开发,数据,数据库,据库,应用,PowerBuilder,提供,一整,一整套,整套,嵌入,嵌入式,SQL,命令,编程,编程人员,人员,PowerBuilder,脚本,自由,嵌入,SQL,命令,一般来说,嵌入,SQL,语句,标准,SQL,语句,即可,PowerBuilder,Oracle,相连,嵌入,SQL,语句,值得,值得注意,注意,地方,PowerBuilder,脚本,引用,用字,字符,字符串,不限,限制,单引号,引号,双引号,引号,Oracle,库,相连,调用,SQL,语句,中用,用到,字符,字符串,只能,使用,单引号,引号,PowerBuilder,Oracle,相连,尤其,嵌入,SQL,语句,要使,使用,用到,日期,型,数据,更,要使,使用,特定,转换,语句,数据,数据库,据库,调出,数据,日期,date,型,数据,必须,使用,TO,CHAR,函数,TO,CHAR,函数,语法,TO,CHAR,date,Format,功能,日期,描述,描述符,设定,日期,格式,Format,得到,Oracle,数据,数据库,据库,中日,日期,型,数据,对应,字符,字符串,数据,写入,数据,数据库,据库,日期,date,型,数据,必须,使用,TO,DATE,函数,TO,DATE,函数,语法,TO,DATE,string,Format,功能,一个,个字符,字符,字符串,转换,换为,给定,定格,格式,日期,写入,Oracle,数据,数据库,据库,日期,描述,描述符,format,必须,单引号,引号,括,起来,单引号,引号,一个,特定,日期,符号,文本,本字,字符,放在,一起,文本,本字,字符,必须,双引号,引号,括,起来,format,格式,设为,The,dd,of,Month,in,the,year,YYYY,类似,数据,数据库,据库,时间,间数,数据,调出,显示,屏幕,应,注意,数据,数据库,据库,中时,时间,空值,NULL,情况,窗口,口中,定义,一个,掩码,编辑,EditMask,形式,单行,编辑,编辑器,em,存放,存放数据,数据,数据库,据库,worker,表,birthday,字段,日期,型,数据,em,掩码,格式,YYYY,MM,DD,照上,上面,提到,先用,TO,CHAR,函数,birthday,字段,数据,数据库,据库,取出,转换,换到,变量,ls,birth,Select,TO,CHAR,birthday,yyyy,mm,dd,Into,ls,birth
,From,worker
,Where,worker,bh,ls,bh
,Using,sqlca,birthday,数据,放到,em,简单,写,em,text,ls,birth,不准,准确,数据,数据库,据库,birthday,数据,空值,NULL,取出,数据,出现,错误,错误信息,误信,信息,Mismatch,between,retrieve,columns,and,fetch,columns,数据,数据类型,类型,匹配,正确,编程,加上,时间,间数,数据,判断,If,Isnull,ls,birth,Then
,em,text,0000,00,00,Else
,Em,text,ls,birth
,End,If
,em,数据,写,回到,数据,数据库,据库,同样,是否,空值,进行,判断,使用,TO,DATE,函数,If,em,text,0000,00,00,Then
,em,GetData,ld,birth,获取,时间,Else
,SetNull,ld,birth,End,If
,ls,birth,string,ld,birth,YYYY,MM,DD,Update,worker,Set
,Birthday,TO,DATE,ls,birth,YYYY,MM,DD,Where,worker,bh,ls,bh
,Using,sqlca,值得,值得注意,注意,地方,Oracle,库,日期,描述,描述符,秒,表示,PowerBuilder,有所,有所不同,不同,PowerBuilder,秒,24,小时,制,hh,mm,ss,表示,Oracle,秒,24,小时,制,hh24,mi,ss,表示,一点,在编,编程,书写,尤其,注意,数据,窗口,口中,记录,增,删,改,PowerBuilder,开发,环境,系统,给出,来访,访问,操纵,数据,数据库,据库,Database,描绘,器,非常,方便,容易,易地,创建,访问,维护,后端,数据,数据库,据库,结构,一种,种数,数据,数据库,据库,服务,服务器,务器,Database,提供,完全,完全相同,相同,简单,单易,易用,可视,可视化,界面,使用,PowerBuilder,Oracle,相连,Oracle,数据,数据库,据库,表,日期,型,字段,对数,数据,数据库,据库,表,记录,进行,增,删,改,存盘,出现,数据,数据库,数据库系统,据库,系统,错误,错误信息,误信,信息,操作,失败,原因,PowerBuilder,自动,Database,描绘,器,操作,转换,换为,标准,SQL,语句,送到,数据,数据库,据库,执行,而其,中用,字母,字母表,表示,月份,Oracle,库,接受,笔者,专门,建,一个,text,表,text,id,date,日期,型,字段,已有,记录,进行,修改,系统,给出,以下,错误,错误信息,误信,信息,
ORA,01843,非法,月份,

No,changes,made,to,database,

Update,TEXT,Set,DATE,TO,DATE
,Nov,1997,00,00,00,DD,MON,YYYY,HH24,MI,SS,
Where,TEXT,ID,And,DATE,TO,DATE,Nov,1997,00,00,00,DD,MON,YYYY,HH24,MI,SS,库,表,进行,增加,删除,记录,操作,给出,类似,错误,错误信息,误信,信息,在编,编程,应用,对数,数据,窗口,进行,操作,存在,日期,型,字段,存在,问题,给出,类似,数据,窗口,提交,交出,出错,信息,应用,笔者,编程,解决,问题,做法,先在,数据,窗口,dbError,事件,提取,取到,原来,执行,SQL,语句,转换,得到,新,Oracle,库,接受,SQL,语句,类似,存盘,菜单,按钮,脚本,执行,新,SQL,语句,即可,dbError,事件,中能,接受,以下,参数,sqldbcode,发生,错误,DBMS,专有,错误,号,sqlerrtext,DBMS,专有,错误,错误信息,误信,信息,sqlsyntax,错误,产生,正在,执行,SQL,语句,buffer,导致,错误,行,缓冲,缓冲区,Delete,Filter,Primary,row,导致,错误,行号,数据,窗口,dbError,事件,脚本,可写,写成,If,sqldbcode,Then,数据,数据库,据库,操作,作出,出现,错误,
gs,old,sql,SQLsyntax,提取,原来,SQL,语句,赋值,全局,全局变量,变量,gs,old,sql
f,change,sql,date,进行,SQL,语句,转换,
End,If
Return,不显,显示,系统,错误,错误信息,误信,信息,

,f,change,sql,date,SQL,语句,进行,转换,函数,脚本,
long,ll,total,ll,pos
string,ls,sql
ls,sql,gs,old,sql
gs,new,sql,
Do
ll,total,len,ls,sql,
ll,pos,pos,ls,sql,TO,DATE,
If,ll,pos,Then
gs,new,sql,gs,new,sql+ls,sql
Return
End,If
ll,pos,pos,ls,sql,ll,pos,
gs,new,sql,gs,new,sql+left,ls,sql,ll,pos,
gs,new,sql,gs,new,sql+f,change,month
,mid,ls,sql,ll,pos+1,
gs,new,sql,gs,new,sql+mid,ls,sql,ll,pos+4,16,
+,DD,MM,YYYY,HH24,MI,SS,
ll,pos,pos,ls,sql,ll,pos,
ls,sql,right,ls,sql,ll,total,ll,pos,
Loop,Until,ll,pos,f,change,month,字母,字母表,表示,月份,转换,换为,为数,数字,月份,函数,脚本,列举,gs,new,sql,全局,全局变量,变量,储存,转换,数据,数据库,据库,接受,SQL,语句,最后,类似,存盘,菜单,按钮,脚本,编程,执行,新,SQL,语句,即可,笔者,窗口,存盘,按钮,进行,编程,脚本,Integer,rtn
rtn,dw,Update,
If,rtn,Then
Commit,Using,sqlca,
Else
Rollback,Using,sqlca,
Execute,immediate,gs,new,sql,
Commit,Using,sqlca,
dw,Retrieve,
End,If
,Table,表,之间,键,连接,数据,数据库,据库,表,一对,关系,以是,主键,键,关系,作者,作者,著作,表,关系,一对,关系,一个,作者,写,多本,本书,部门,雇员,关系,一对,关系,之间,建立,主键,键,关系,数据,数据库,据库,管理,编程,应用,应当,利用,主键,键,定义,定义数据,数据,数据库,据库,引用,完整,完整性,有效,使用,意味,意味着,着数,数据,数据库,据库,应用,应用程序,程序,迫使,使用,用户,提供,有效,有效值,维护,数据,数据库,据库,完整,完整性,一致,一致性,部门,雇员,关系,举,个例,例子,假定,虚构,一个,公司,10,部门,组成,每个,雇员,属于,一个,部门,管辖,这种,情况,数据,数据库,据库,应,包含,雇员,表,部门,表,雇员,表,主键,emp,id,部门,表,主键,dept,id,雇员,表,应,包含,一个,dept,id,列,指出,雇员,该部,部门,工作,引用,完整,完整性,引入,数据,数据库,据库,雇员,表,dept,id,列,应当,指定,键,指向,部门,表,应用,应用程序,程序,并不需要,需要,要为,确保,雇员,所指,指定,部门,代码,有效,有效值,编写,程序,原因,数据,数据库,据库,自动,处理,此类,问题,雇员,所指,指定,部门,代码,无效,数据,数据库,据库,给出,系统,错误,错误信息,误信,信息,允许,操作,PowerBuilder,为数,数据,数据库,据库,表,建立,主外,键,关系,一个,On,Delete,of,Primary,Table,Row,选项,说明,主表,行,被删,删除,表,对应,行,可能,几种,操作,允许,删除,主表,记录,自动,删除,表,对应,行,记录,表,相应,行,对应,应列,设为,Null,上面,部门,雇员,例子,雇员,表,依赖,依赖于,赖于,部门,表,主表,一个,部门,被删,删除,部门,雇员,选择,下列,几种,方法,部门,雇员,允许,删除,部门,自动,删除,雇员,表,dept,id,列,指向,该部,部门,雇员,记录,被删,删除,部门,工作,雇员,雇员,表,中将,相应,部门,列,设置,Null,PowerBuilder,地库,Sybase,SQL,Anywhere,建立,主外,键,关系,On,Delete,of,Primary,Table,Row,选项,中选,选择,第二,第二项,二项,主表,行,被删,删除,表,对应,行,记录,自动,删除,PowerBuilder,Oracle,相连,选项,选择,第二,第二项,二项,实现,不了,功能,必须,编程,编程人员,人员,编程,删除,除掉,表,主表,行相,对应,行,记录,删除,主表,行,Delete,From,employee,删除,表相,相关,记录,
Where,dept,id,ls,dept,id
Using,sqlca,
If,sqlca,sqlcode,Then
MessageBox,Database,Error,sqlca,SQLErrText,
Exclamation,
Return
End,If
Delete,From,department,删除,主表,表记,记录,
Where,dept,id,ls,dept,id
Using,sqlca,
If,sqlca,sqlcode,Then
MessageBox,Database,Error,sqlca,SQLErrText,
Exclamation,
Return
End,If
,结束,结束语,PowerBuilder,开放,开放性,性功能,功能,众多,优秀,功能,不同,后台,台数,数据,数据库,据库,相连,存在,细微,差别,编程,应用,注意,区分,处置,本文,PowerBuilder,Oracle,相连,编程,中出,出现,问题,具有,键,连接,Table,表,记录,删除,问题,PowerBuilder,Oracle,中文,中文版,文版,格式,兼容,造成,数据,数据,窗口,操作,问题,进行,探讨,给出,编程,形式,解决,解决方案,方案,PowerBuilder,不能,能读,读取,Oracle,表,目录,Oracle,表,结构,问题,限于,篇幅,本文,不再,详细,介绍,张,坤,讲师,主要,研究,方向,企业,MIS,系统,数据,数据库,据库,技术,作者,单位,张,坤,伊,希,荣,总装,总装备部,装备,装备部,指挥,技术,术学,学院,北京,101416,参考,参考文献,文献,John,Adolph,Palinski,Oracle8,数据,数据库,据库,构造,工具,实用,指南,北京,机械,机械工业,工业,出版,出版社,1998
,Bill,Hatfield,PowerBuilder,应用,应用程序,程序,程序开发,开发,发指,指南,北京,清华,清华大学,清华大学出版社,华大,大学,出版,出版社,1997
,收稿,日期,1999,01,08
