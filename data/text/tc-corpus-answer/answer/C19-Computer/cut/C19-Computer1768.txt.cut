软件,学报,
JOURNAL,OF,SOFTWARE
1999,10,卷,Vol,10,No,1999



,自动,寻找,多重,串行,循环,并行,化,幺,模,变换,俞,峻,臧,斌,宇,施,武,朱,传,琪,摘要,已知,n,维,距离,离向,向量,矩阵,多重,串行,循环,过去,并行,化,编译,研究,缺乏,寻找,循环,外层,并行,化,幺,模,矩阵,可行,算法,文章,介绍,多重,串行,循环,并行,化,幺,模,变换,方法,理论,上证,证明,满足,外层,并行,化,要求,合法,幺,模,矩阵,存在,构造,构造性,证明,给出,一个,计算,外层,并行,化,幺,模,变换,矩阵,可行,算法,探讨,扩大,适用,适用范围,范围,完全,嵌套,非常,常数,相关,距离,循环,有效,有效途径,途径,关键,关键词,相关,相关性,分析,自动,并行,化,变换,循环,幺,模,变换,中图,中图法,图法,分类,分类号,TP311
Automatically,Computing,Unimodular,Transforming,Matrix,to
Parallelize,Nested,Sequential,Loops
YU,Yi,jun,ZANG,Bin,yu,SHI,Wu,ZHU,Chuan,qi
,Institute,of,Parallel,Processing,Fudan,University,Shanghai,200433,
Abstract,Lacking,an,effective,and,feasible,algorithm,to,compute,the,valid,unimodular,matrix,for,parallelizing,of,the,outer,loops,previous,parallelizing,researches,can,not,automatically,reveal,the,parallelism,in,such,sequential,nested,loops,as,have,n,dimension,distance,matrix,In,this,paper,the,authors,discuss,a,general,outer,loop,parallelizing,method,by,valid,unimodular,transformations,prove,the,existence,of,such,a,valid,unimodular,transformation,and,suggest,several,practical,computing,algorithms,through,the,constructive,proofs,This,discovered,unimodular,transformation,can,have,the,maximal,number,of,parallelizable,outer,loops,transformed,Thus,the,application,scope,of,the,algorithms,can,be,enlarged,to,non,perfect,or,non,constant,dependence,distance,loops,
Key,words,Dependence,test,automatic,parallelizing,transformation,unimodular,transformation,并行,化,编译,串行,行程,程序,并行,化,有效,工具,结合,相关,相关性,分析,发现,串行,行程,程序,并行,并行性,程序,程序段,施以,合法,并行,化,变换,程序,程序段,并行,并行执行,执行,有效,相关,相关性,分析,自动,并行,化,变换,方法,并行,化,编译,编译成,译成,成功,关键,串行,行程,程序,循环,具有,很大,并行,并行性,循环,并行,化,变换,自然,成为,并行,化,变换,研究,重点,幺,模,unimodular,变换,一类,范围,广,循环,变换,等价,循环,迭代,空间,乘以,一个,行列,行列式,列式,整数,数方,方块,矩阵,幺,模,矩阵,奇异,线性,线性变换,变换,通常,发掘,程序,并行,并行性,研究,基本,循环,变换,斜,错,skewing,交换,interchanging,反序,reversal,特例,幺,模,变换,具有,保持,整数,循环,迭代,空间,间体,体积,维,数,不变,性质,不仅如此,步长,规范,循环,幺,模,变换,规范,循环,变换,程序,书写,格式,较为,规整,适合,循环,变换,良好,好性,性质,幺,模,变换,成为,循环,并行,化,变换,研究,重点,任意,幺,模,变换,保证,变换,正确,正确性,时而,而使,循环,并行,化,使用,幺,模,变换,进行,循环,自动,并行,化,困难,给定,多重,串行,循环,自动,找出,出使,循环,并行,化,恰当,幺,模,变换,矩阵,现有,大多,大多数,多数,自动,并行,化,编译,编译器,没有,实现,自动,并行,化,幺,模,变换,是因为,无法,多重,循环,自动,计算,并行,化,幺,模,变换,矩阵,利用,交互,并行,并行程序,行程,程序,程序设计,设计,环境,提供,循环,迭代,空间,相关,图,可视,可视化,化工,工具,循环,程序,分析,经验,表明,寻找,恰好,循环,并行,化,幺,模,变换,矩阵,很困,困难,本文,研究,算法,目标,给定,多重,串行,循环,自动,找出,出使,循环,并行,化,恰当,幺,模,变换,矩阵,简单,二重,循环,U,Banerjee,算法,说明,源,循环,环中,跨,循环,常数,相关,距离,寻找,合法,外层,内层,并行,化,幺,模,变换,二重,循环,内层,并行,化,方法,扩充,至多,多重,循环,内层,并行,化,二重,循环,外层,并行,化,方法,无法,直接,处理,多重,循环,外层,并行,化,情况,本文,提出,一种,确定,多重,串行,循环,外层,并行,化,幺,模,变换,矩阵,算法,解决,相关,距离,已知,多重,嵌套,嵌套循环,循环,并行,化,问题,多重,循环,常数,距离,矩阵,满,秩,D,Hollander,迭代,划分,求,代表,迭代,代点,方法,能够,增加,一个,额外,外层,并行,循环,压缩,内层,串行,循环,相关,迭代,链,进一步,一步,发掘,外层,并行,化,循环,迭代,Xue,提出,完全,嵌套,嵌套循环,循环,变换,换为,多个,完全,嵌套,嵌套循环,循环,迭代,空间,进行,幺,模,变换,方法,本文,外层,循环,幺,模,并行,化,方法,两种,方法,结合,合在,合在一起,一起,本文,节,介绍,幺,模,矩阵,并行,化,变换,方法,证明,合法,幺,模,变换,矩阵,已知,常数,相关,距离,多重,循环,存在,证明,过程,完全,构造,不难,难得,得出,计算,合法,幺,模,矩阵,算法,最后,一个,完整,多重,循环,实例,说明,并行,化,幺,模,变换,换算,算法,寻找,循环,并行,化,幺,模,矩阵,迭代,空间,变换,循环,跨,循环,相关,距离,离向,向量,一起,变换,而有,循环,变换,可使,目标,循环,并行,化,相关,距离,离向,向量,已知,循环,寻找,合法,并行,化,变换,两种,方法,侧重,侧重于,重于,内层,循环,并行,wavefront,方法,侧重,侧重于,重于,外层,循环,并行,partition,方法,Banerjee,方法,循环,外层,并行,化,幺,模,矩阵,计算,计算方法,方法,仅仅,适用,用于,二重,循环,n,重,循环,不适,适用,D,Hollander,方法,直接,用于,n,重,循环,产生,超过,n,层,循环,不能,发掘,外层,并行,并行性,本文,探讨,n,重,循环,幺,模,并行,化,算法,一个,发掘,最多,并行,外层,循环,幺,模,变换,n,rank,D,外层,循环,一定,定能,能够,并行,化,rank,D,内层,循环,并行,化,下面,重点,论证,n,维,迭代,空间,m,相关,距离,离向,向量,常数,给定,n,m,相关,距离,矩阵,D,秩,rank,D,n,找到,一个,合法,行,变换,幺,模,矩阵,U,UD,D,T,T,D,rank,D,m,合法,法相,相关,距离,矩阵,且为,行,满,秩,D,行,满,秩,矩阵,找出,一个,幺,模,变换,U,重,循环,内层,循环,并行,化,D,满,秩,可逆,矩阵,行列,行列式,列式,D,结合,D,Hollander,迭代,划分,求,代表,迭代,代点,方法,增加,一个,外层,并行,循环,内层,串行,循环,相关,迭代,链,紧凑,方法,进行,行内,内层,并行,化,之前,rank,D,m,D,以利,利用,D,Hollander,方法,发掘,发掘出,掘出,可能,并行,化,循环,共,D,并行,循环,迭代,内层,循环,并行,化,得到,n,rank,D,+1,并行,外层,循环,一个,串行,循环,rank,D,并行,内层,循环,外层,循环,并行,化,循环,并行,化,变换,必须,保证,原来,迭代,空间,存在,跨,循环,相关,两个,循环,迭代,保持,串行,迭代,执行,顺序,即要,要求,距离,离向,向量,合法,合法性,定义,合法,距离,离向,向量,n,维,相关,距离,离向,向量,d,合法,valid,字典,序,大于,向量,整数,向量,nd,相关,距离,矩阵,D,合法,组成,每个,距离,离向,向量,d1,dm,合法,引理,一定,合法,变换,矩阵,充要,充要条件,条件,n,n,阶,幺,模,矩阵,U,任意,合法,n,m,阶,距离,离向,向量,矩阵,D,D,UD,合法,距离,离向,向量,矩阵,U,三角,矩阵,对角,对角线,元素,等于,证明,D,合法,距离,离向,向量,矩阵,d11,d12,d1m,U,三角,幺,模,矩阵,对角,对角线,元素,等于,任意,d,i,Udi,d,1i,d1i,d,1i,d,i,合法,距离,离向,向量,d,1i,d1i,考查,d,2i,u21,d1i+d2i,d2i,d,2i,d,i,合法,距离,离向,向量,d,2i,d2i,考查,d,3i,u31,d1i+u32,d2i+d3i,d3i,依此,依此类推,此类,类推,d,1i,d,2i,d,k,i,d1i,d2i,dk,i,d,k,d,1i,d,2i,d,n,i,必,一个,k,d,ki,d,i,合法,j,u1j,取,d,dj,T,d,u1j,d,合法,d,不合,合法,u1j,取,d,d1,dj,u11,u1j,T,d,u11,u11,u1j,u1j,u1j,d,合法,d,不合,合法,u12,u1n,j,k,u1j,uk,1j,ukj,取,d,dk,T,d,ukj,d,合法,d,不合,合法,u,k,j,取,d,dk,ukk,uk,j,T,d,ukk,ukk,u1j,ukj,ukj,d,合法,d,不合,合法,uk,k+1,ukn,U,一定,三角,阵,U,满,秩,三角,阵,ukk,ukk,取,d,dk,T,d,d,k,ukk,T,d,合法,d,不合,合法,U,对角,对角线,元素,大于,U,幺,模,矩阵,以其,三角,阵,对角,对角线,乘积,等于,行列,行列式,列式,对角,对角线,元素,等于,引理,可知,基本,幺,模,变换,反序,阵,对角,对角线,元素,大于,交换,阵,三角,阵,不能,保证,合法,法相,相关,距离,离向,向量,量变,变换,仍然,合法,三角,行,斜,错,变换,保证,变换,合法,合法性,相关,距离,矩阵,D,rank,D,n,是否,可能,找到,合法,幺,模,变换,矩阵,U,UD,D,T,T,D,rank,D,m,合法,距离,离向,向量,矩阵,且为,满,秩,下面,定理,给出,肯定,回答,定理,合法,元,幺,模,矩阵,存在,性,n,维,迭代,空间,m,相关,距离,离向,向量,常数,给定,n,m,距离,离向,向量,矩阵,D,秩,s,rank,D,n,一定,定存,存在,一个,合法,行,变换,幺,模,矩阵,U,UD,D,T,T,D,rank,D,m,合法,距离,离向,向量,矩阵,且为,行,满,秩,

,构造,构造性,证明,算法,n,维,相关,距离,离向,向量,列,横排,D,d1,dm,表示,行向量,向量,列,排,D,e1,en,T,每个,ei,m,维,行向量,向量,以下,计算,关键,寻找,U,UD,en,s+1,en,T,步骤,


,初始,初始化,s,rank,D,t,z,E0,E1,e1,E2,e2,en,T,UU,t,记录,已经,处理,线性,无关,e,向量,个数,z,记录,变换,换为,向量,个数,T,记录,中间,幺,模,变换,个数,IF,z,n,s,GOTO,For,E0,e1,ez,E1,ez+1,ez+t,E2,ez+t+1,en,D,合法,相关,距离,矩阵,IF,rank,E1+,ez+t+1,t+1,THEN
,E1,E1+,ez+t+1,E2,E2,ez+t+1,t,t+1
,GOTO,ELSE
,ez+t+1,ez+1,ez+t,线性,线性相关,性相,相关,存在,零整,整数,a1,at,at+1,at+1,gcd,a1,at,at+1,1
a1ez+1+,+atez+t,at+1ez+t+1,

,系数,以下,下方,方法,计算,Dsub,D,t,阶,满,秩,子,矩阵,E1,t,m,维,行向量,向量,中选,选取,无关,t,列,Dinc,ez+t+1,对应,应于,列,t,维,子,行向量,向量,at+1,det,Dsub,a1,at,at+1DincDsub,得到,整,系数,再分,除以,以其,最大,最大公约数,大公,公约,公约数,约数,保证,gcd,a1,at,at+1,WHILE,at+1,DO,辗转,相除,除法,FOR,i,t,
bi,ai,at+1,
ai,ai,mod,at+1,ENDFOR,at+1,ai,i,t,T,T+1
,ez+t+1,b1ez+1,btez+t+ez+t+1,

,引理,D,合法,合法,T,T+1,i,at,i,最小,负,整数,
at,i+1,at,

,D,合法,合法,D,合法,交换,ez+t,i,ez+t+1,不合,合法,必须,存在,j,d1j,dz+t,i,j,dz+t,i,j,dz+t+1,j,式,可知,dz+t+1,j,az+t,i,dz+t,i,j,az+t+1,矛盾,式,不变,修正,系数,
a1,a1,at,i,at,i,at,i,at+1,at+1,at,i,式,可知,式,新,a1,at,at+1,ez+t+1,ez+1,ez+t,成立,gcd,a1,at,at+1,循环,一定,定会,终止,ENDWHILE
,元,引理,D,合法,合法,置换,向量,ez+t+1,D,合法,合法,合法,
E0,E0+,E2,E2,ez+t,z,z+1,ENDIF
,ENDFOR
,U,UTUT,U1,即为,所求,幺,模,矩阵,UT,UT,U1,UU,推论,距离,离向,向量,个数,少于,迭代,空间,维,数,m,n,必,幺,模,变换,至少,n,m,层,循环,并行,化,上述,算法,U,计算,涉及,行,变换,下列,推论,推论,U,定理,给定,距离,离向,向量,d1,dm,计算,算出,合法,幺,模,变换,矩阵,原,迭代,空间,合法,距离,离向,向量,d,属于,dj1,djs,向量,张,s,维,子,空间,变换,新,迭代,空间,Ud,合法,n,s,层,并行,化,Ud,n,s,分量,证明,距离,离向,向量,d,落,原基,向量,dj1,djs,张,s,维,整数,子,空间,存在,一系,一系列,系列,零,实数,证明,明为,有理,有理数,a1,as,d,a1dj1+,+asdjs,Ud,U,a1dj1+,+asdjs,a1Udj1+,+asUdjs,dj1,djs,n,s,分量,Ud,n,s,分量,定理,算法,计算,算得,得到,幺,模,变换,外层,并行,最多,幺,模,变换,不能,幺,模,变换,产生,更多,并行,化,外层,循环,证明,多于,n,rank,D,行,可变,变换,换为,rank,UD,rank,D,幺,模,变换,改变,矩阵,秩,矛盾,内层,循环,并行,化,定理,n,维,迭代,空间,m,相关,距离,离向,向量,常数,给定,n,m,距离,离向,向量,矩阵,D,秩,s,rank,D,n,一定,定存,存在,一个,合法,行,变换,幺,模,矩阵,U,UD,n,m,合法,距离,离向,向量,矩阵,距离,离向,向量,元素,大于,UD,首行,元素,大于,证明,算法,存在,一系,一系列,系列,负,整数,u1,un,UT,即为,所求,k,d1j,d,n,j,d,n,j,k,n,算法,D,幺,模,U1,变换,得到,U1D,0T,D,T,T,D,s,rank,D,阶,行,满,秩,阵,现在,算法,D,得到,Us,U2U1D,完成,进一步,一步,对内,内层,循环,并行,化,任务,计算,循环,迭代,空间,边界,n,重,循环,迭代,空间,I,i1,in,Zn,L1,i1,U1,L2,i1,i2,U2,i1,Ln,i1,in,in,Un,i1,in,变换,迭代,空间,J,j1,jn,Zn,LL1,j1,UU1,LL2,j1,j2,UU2,j1,LLn,j1,jn,jn,UUn,j1,jn,绝大,绝大多数,大多,大多数,多数,循环,使用,线性,边界,表达,表达式,达式,I,空间,边界,边界条件,条件,表示,Ai,b,形式,A,一个,2n,n,整,系数,矩阵,b,一个,2n,整,系数,向量,k,n,i,U,1j,J,空间,边界,边界条件,条件,变为,AU,1j,b,现在,要用,整数,Fourier,Motzkin,投影,元,算法,计算,算出,LLk,UUk,线性,线性表,表达,表达式,达式,果在,原,循环,边界,边界条件,条件,常数,数项,b,中出,出现,循环,不变,符号,变量,符号,符号表,表达,表达式,达式,运算,应用,F,M,算法,求出,出新,循环,边界,边界条件,条件,多重,循环,迭代,空间,幺,模,变换,应用,实例,分析,下列,串行,循环,相关,距离,矩阵,算法,求得,幺,模,矩阵,可使,循环,外层,并行,化,得到,D,满,秩,可逆,D,需要,D,Hollander,方法,进一步,一步,分析,partition,使用,算法,得到,幺,模,矩阵,循环,内层,并行,化,完成,幺,模,矩阵,计算,F,M,算法,求得,循环,边界,表达,表达式,达式,完成,幺,模,变换,算法,自动,不难,自动,并行,化,变换,换工,工具,中实,实现,DO,i1,100
,DO,i2,i1,100
,DO,i3,i1+i2,200
,a,i1+1,i2+3,i3+2,a,i1,i2+1,i3+5,+a,i1+1,i2,i3,ENDDO
,ENDDO
,ENDDO
,DOALL,j1,17,1700
,DO,j2,max,j1,j1,400,11,min,200,j1,700,j1,500,j1,16,DOALL,j3,max,j1+3,j2,100,j1+2,j2,200,min,100,j2,j1+3,j2,i1,j3
,i2,j1+3,j2,j3
,i3,j1+2,j2,j3
,a,i1+1,i2+3,i3+2,a,i1,i2+1,i3+5,+a,i1+1,i2,i3,ENDDOALL
,ENDDO
,ENDDOALL
3,相关,距离,离向,向量,已知,常数,n,维,循环,本文,提出,外层,内层,并行,化,幺,模,并行,化,变换,方法,证明,满足,外层,并行,化,要求,合法,幺,模,矩阵,存在,给出,计算,最多,多层,层数,外层,循环,并行,化,合法,幺,模,矩阵,算法,这种,算法,扩充,完全,嵌套,嵌套循环,循环,非常,常数,相关,距离,循环,幺,模,变换,本文,提出,算法,自动,并行,化,编译,中实,实现,本文,研究,得到,国家,国家自然科学基金,自然,自然科,自然科学,科学,科学基金,基金,国家,863,高科技,科技,项目,基金,国家,攀登,计划,基金,金和,国家,国家教委,家教,教委,博士,博士点,基金,资助,实际,实际上,n,rank,D,+1,层,循环,rank,D,不存,存在,需要,进一步,一步,并行,化,串行,循环,本文,通讯,通讯联系,联系,联系人,俞,峻,上海,200433,复旦,复旦大学,大学,并行,并行处理,处理,研究,研究所,作者,作者简介,简介,俞,峻,1972,生,博士,主要,研究,领域,并行,并行处理,处理,高性,高性能,性能,计算,臧,斌,宇,1965,生,副教授,教授,主要,研究,领域,并行,化,编译,施,武,1971,生,助教,主要,研究,领域,并行,并行处理,处理,朱,传,琪,1943,生,教授,博士,博士生,导师,主要,研究,领域,并行,并行处理,处理,作者,单位,复旦,复旦大学,大学,并行,并行处理,处理,研究,研究所,上海,200433
,参考,参考文献,文献,Wolfe,M,Optimizing,supercompilers,for,supercomputers,Ph,D,Thesis,University,of,Illinois,UIUCDCS,R,82,1105,1982
,Banerjee,U,Dependence,Analysis,for,Supercomputing,Norwell,MA,Kluwer,Academic,Publishers,Group,1988
,朱,传,琪,臧,斌,宇,陈,彤,程序,自动,并行,化,系统,软件,学报,1996,180,186
,Zhu,Chuan,qi,Zang,Bin,yu,Chen,Tong,The,automatic,parallelizing,compiler,AFT,Journal,of,Software,1996,180,186,Banerjee,U,Unimodular,transformations,of,double,loops,In,Advances,in,Languages,and,Compilers,for,Parallel,Processing,Cambridge,MA,MIT,Press,1991,192,219
,D,Hollander,E,H,Partitioning,and,labeling,of,loops,by,unimodular,transformations,IEEE,Transactions,on,Parallel,Distributed,Systems,1992,465,476
,Xue,Jin,ling,Unimodular,transformations,of,non,perfectly,nested,loops,International,Journal,of,Parallel,Computing,1997,22,12,1621,1645
,Yu,Yi,jun,Wang,Qi,Zhu,Chuan,qi,The,design,of,a,parallel,programming,environment,for,FPT,In,D,Hollander,E,H,et,al,eds,Proceedings,of,the,Topic,in,Knowledge,and,Information,Technology,Communication,Congnition,1996,69,80
,Wang,Qi,Yu,Yi,jun,D,Hollander,E,H,Visualizing,the,iteration,space,in,PEFPT,In,Hertzberger,B,Sloot,P,eds,Proceedings,of,the,High,Performance,Computing,and,Network,International,Conference,and,Exhibition,Springer,Verlag,KG,1997,908,915
,Williams,H,P,Fourier,Motzkin,elimination,to,integer,programming,problems,Journal,of,Combinatorial,Theory,A,1976,21,118,123
,本文,1997,12,29,收到,原稿,1998,03,23,收到,修改,修改稿,改稿