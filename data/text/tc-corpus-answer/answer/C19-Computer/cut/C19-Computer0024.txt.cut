计算,计算机,算机,应用,
COMPUTER,APPLICATIONS
1999,19,卷,Vol,19,No,1999



,绑定,DBGrid,系统,问题,解决,方法,李,龙,罗,蔚,文,摘,据实,实际,使用,VB5,实践,详细,介绍,DBGrid,一个,系统,问题,主要,介绍,现象,错误,之处,深入,深入研究,研究,错误,根源,并提,提出,解决,方法,关键,关键词,VB,DBGrid,Col,Row,标签,事件,过程,VB,十全,十全十美,计算,计算机,计算机软件,算机,机软件,软件,硬件,发展,人人,设计,符合,符合要求,要求,软件,软件系统,系统,统和,人机,人机界面,机界面,界面,当今,众多,设计,人机,人机界面,机界面,界面,软件,Visual,Basic,简称,称为,VB,易学,最好,软件,特别,计算,计算机,计算机专业,算机,专业,设计,设计者,VB,非常,实用,设计,设计者,不了,了解,东西,直接,VB,设计,设计界,界面,VB,操作,比较,方便,当今,VB,使用,范围,广,VB,问题,有错,错误,笔者,发现,一个,现,提出,问题,和解,解决,方法,后来,后来者,来者,继续,做,无用,工作,问题,发现,现象,笔者,前段,前段时间,段时间,时间,开发,一个,桥梁,检,系统,FORTRAN,语言,编制,计算,部分,VB,做,界面,系统,输入,输入输出,输出,数据,数据,输入,输入输出,输出,基本,表格,方式,进行,FORTRAN,需要,数据,数据文件,文件,文件格式,格式,比较,较严,严格,系统,使用,绑定,定式,DBGrid,数组,UserData,存储,表格,内容,系统,表格,行数,列,数,前面,数据,确定,不会,删除,添加,加行,列,系统,只用,两个,事件,子程序,程序,表格,数据,改变,用于,存储,表格,数据,数组,数据,进行,更新,事件,过程,UnboundWriteData,数组,读取,读取数据,数据,表格,事件,子,过程,UnboundReadData,两个,事件,子程序,程序,是从,VB5,例题,拷贝,稍加,改动,运用,例题,路径,名字,D,VB5,samples,Misc,UnBndGrd,Unbndgrd,vbp,使用,一段,一段时间,段时间,时间,发现,问题,问题,现象,每个,单元,内容,改变,以后,光标,移到,单元,马上,卸载,窗体,窗体,右上,右上角,上角,关闭,按钮,ALT+F4,退出,再次,加载,窗体,修改,改过,单元,内容,没有,改变,经常,常会,这种,问题,出现,DBGrid,表格,行,屏,显示,需要,滚动,滚动条,表格,最后,一行,输入,数据,移开,开光,光标,改变,变成,原值,DBGrid,表格,比较,较大,屏,显示,完,需要,滚动,看到,全部内容,内容,DBGrid,最后,一行,输入,数据,移开,开光,光标,输入,单元,未改,改变,单元,同列,第一,第一行,一行,单元,变成,输入,果在,窗体,加载,修改,最后,一行,肯定,定出,出现,问题,从前,前面,慢慢,修改,改到,最后,后行,不会,出现,这种,问题,一开,修改,最后,一行,使用,出现,问题,出现,这种,问题,情况,没有,非常,明确,规律,规律性,两个,问题,经常,出现,产生,共同,影响,问题,复杂,复杂化,错误,根源,研究,程序,代码,VB5,例题,代码,改变,一小,一小部分,小部,部分,代码,代码,量,很少,问题,可能,可能性,性比,比较,过长,长时间,时间,检查,发现,修改,部分,代码,没有,问题,问题,可能,例题,考虑,考虑不周,不周,不周到,周到,VB,软件,笔者,问题,现象,摸索,错误,根源,第一,第一个,一个,问题,解决,问题,主要,绑定,DBGrid,表格,更新,事件,UnboundWriteData,激发,机理,了解,不够,引起,绑定,DBGrid,一个,个数,数组,储存,表格,内容,一个,单元,内容,对应,应于,数组,一个,DBGrid,控件,单元,内容,修改,光标,移动,动到,行,UnboundWriteData,事件,激发,移动,动到,同一,一行,不同,同列,不能,激发,UnboundWriteData,事件,激发,此事,事件,过程,对数,数组,内容,做出,修改,问题,解决,解决办法,办法,比较,比较简单,简单,DBGrid,Change,事件,过程,中加,加入,以下,下代,代码,即可,假设,存贮,表格,数值,数组,UserData,窗体,DBGrid,控件,名称,称为,DBGrid1,Dim,I,As,Integer,J,As,Integer
I,DBGrid1,Col,取,列,号,
J,DBGrid1,Row,取,行号,
UserData,I,J,DBGrid1,Text,输入,赋,当前,单元,对应,数组,单元,第二,第二个,二个,问题,比较,麻烦,笔者,第一,第一个,一个,问题,可能,地方,考虑,考虑不周,不周,第一,第一个,一个,问题,连锁,连锁反应,反应,仔细,仔细检查,检查,没有,发现,现代,代码,问题,解决,第一,第一个,一个,问题,运行,行程,程序,过程,中断,程序,Debug,窗口,查看,数组,发现,改变,变过,单元,对应,数组,单元,已经,经改,改变,表格,输入,表格,显示,没有,有变,第一,第一行,一行,显示,最后,一行,输入,数值,笔者,想,是不是,改变,单元,内容,DBGrid,没来,来得,来得及,刷新,表格,作者,程序,中加,加入,代码,单元,修改,强行,刷新,表格,DBGrid,AfterColEdit,事件,过程,中加,加入,一行,代码,DBGrid1,Refresh,刷新,DBGrid1
,处理,运行,问题,题解,解决,最后,一行,显示,改变,内容,第一,第一行,一行,不变,当时,作者,问题,根除,此后,照此,一次,笔者,用到,一个,比较,较大,数组,表格,屏,显示,完,表格,滚动,滚动条,表格,滚动,屏,前面,问题,出现,是从,最后,一行,输入,内容,出现,现在,第一,第一行,一行,出现,现在,最后,一行,出现,现在,行号,等于,显示,行数,减,行,列,号,相同,所谓,显示,行数,DBGrid,不用,滚动,直接,看到,行数,多方,多方面,检查,最终,得出,得出结论,结论,VB,软件,问题,VB,例题,同样,问题,VB,DBGrid,一个,元素,三个,定位,参数,行号,Row,列,号,Col,标签,Bookmark,列,号,Col,容易,区别,最大,列,依次,编号,行号,标签,容易,混淆,很大,大区,区别,行号,表示,某行,显示,来时,显示,行,行号,第一,第一个,一个,显示,行,行号,以下,依次,类推,表格,最后,一行,行号,变化,没有,显示,行,没有,行号,某行,标签,表示,该行,行,排号,显示,没有,显示,数组,第一,第一行,一行,标签,签为,最后,一行,标签,签为,为数,数组,行数,减,根本,问题,VB,软件,软件系统,系统,最后,一行,Bookmark,置,特别,窗体,启动,直接,修改,最后,一行,行时,第一,第一行,一行,Bookmark,出现,问题,弄清,Row,Bookmark,区别,别后,理解,出现,前面,提到,问题,现在,重新,理,理出,出现,错误,机理,表格,内容,屏,显示,修改,最后,一行,激发,UnboundReadData,事件,过程,激发,UnboundWriteData,时间,过程,系统,赋,第一,第一行,一行,UserData,数组,改变,表格,没有,刷新,原来,内容,出现,问题,第一,第一种,一种,情况,表格,内容,屏,显示,完,修改,最后,一行,前面,过程,滚动,动到,第一,第一行,一行,内容,已经,刷新,看到,改变,变过,第一,第一行,一行,问题,第二,第二种,二种,情况,问题,解决,方法,笔者,实践,给出,解决,解决办法,办法,程序,中加,加入,代码,判断,Bookmark,修改,改行,第一,第一行,一行,最后,一行,Boolean,型,变量,Lastrow,表示,判断,果决,决定,输入,赋,数组,相应,单元,体要,事件,程序,中加,代码,窗体,声明,部分,加入,以下,下代,代码,Private,Lastrow,As,Boolean,定义,判断,是否,最后,一行,参数,Private,mTotalRows,定义,DBGird1,最大,大行,行数,DBGrid1,AfterColEdit,事件,过程,中加,加入,以下,下代,代码,If,Lastrow,Then
,DBGrid1,Refresh,刷新,DBGrid1
DBGrid1,Scroll,DBGrid1,VisibleRows,重新,滚到,看到,最后,一行,
Lastrow,False,光标,已经,移到,Lastrow,设为,False
End,If
,DBGrid1,Change,事件,过程,中加,加入,以下,下代,代码,Dim,i,As,Integer,j,As,Integer
i,DBGrid1,Col,列,号,
j,DBGrid1,Row,行号,
If,DBGrid1,Bookmark,Then
If,j,Then,Bookmark,行号,大于,一定,最后,一行,
Userdata,i,mTotalRows,DBGrid1,Text,输入,赋,最后,一行,相应,应列,
Lastrow,True
Else,最后,一行,
UserData,i,DBGrid1,Bookmark,DBGrid1,Text,输入,赋,第一,第一行,一行,相应,应列,
End,If
Else,Bookmark,不等,等于,0
UserData,i,DBGrid1,Bookmark,DBGrid1,Text,输入,赋,数组,对应,元素,
End,If
5,实践,实践证明,证明,可行,本文,实践,基础,发现,问题,研究,究问,问题,最后,解决,解决问题,问题,得到,有效,成果,弥补,VB,系统,缺陷,以后,使用,使用者,用者,遇到,同样,问题,提供,思想,方法,和解,解决,方法,避免,走弯路,弯路,作者,作者简介,简介,李,龙,硕士,研究,研究生,主要,研究,方向,程序,程序设计,设计,软件,可视,可视化,技术,罗,蔚,文,副教授,教授,作者,单位,上海,铁道,大学,土木,土木工程,木工,工程,工程系,上海,200331,收稿,日期,1998,12,25
