计算,计算机,算机,应用,
COMPUTER,APPLICATIONS
1999,19,卷,10,Vol,19,No,10,1999



,Web,综合,查询,系统,设计,实现,王,志,鹏,张,海盛,沈,益民,摘,本文,文首,介绍,用于,创建,Web,应用,应用程序,程序,ASP,技术,特点,系统,要求,介绍,ASP,实现,Intranet,Web,数据,数据库,据库,综合,查询,系统,设计,思想,实现,关键,关键词,动态,服务,服务器,务器,页面,ASP,IIS,动态,HTML,ActiveX,数据,对象,ADO,
DESIGN,AND,IMPLEMENTATION,OF,INTEGRATED
QUERY,SYSTEM,BASED,ON,WEB
Wang,Zhipeng,Zhang,Haisheng,Shen,Yimin
Chengdu,Institute,of,Computer,Application,Academia,Sinica,Sichuan,Chengdu,610041
,Abstract,At,the,first,this,paper,introduces,the,characteristics,and,system,requirements,of,ASP,Then,explains,the,design,idea,and,implementation,of,an,integrated,query,system,of,database,based,on,Web,by,using,ASP,in,the,intranet,environment,Keywords,ASP,IIS,DHTML,ADO
1,前言,Internet,应用,不断,扩展,企业,业内,内部,建有,Intranet,加强,企业,业内,内部,信息,集成,共享,Intranet,及时,获取,企业,业内,内部,综合,综合信息,信息,改善,优化,企业,管理,增强,企业,整体,整体效益,效益,提供,有力,支持,设计,开发,一个,浏览,浏览器,服务,服务器,务器,方式,Web,数据,数据库,据库,综合,查询,系统,该系,系统,一个,一个通,通用,决策,支持,综合,查询,系统,Web,ODBC,TCP,IP,技术,实现,异构,数据,数据库,据库,异构,网络,网络平台,平台,数据,综合,查询,该系,系统,采用,ASP,开发,环境,必要,ASP,做,一个,简要,介绍,ASP,简介,ASP,Active,Server,Pages,微软,推出,服务,服务器,服务器端,务器,端,脚本,编写,环境,使用,组合,HTML,脚本,本命,命令,ActiveX,组件,创建,建和,运行,行动,动态,交互,Web,应用,应用程序,程序,ASP,具有,以下,特点,开发,维护,快速,速简,简单,ASP,文件,通用,文本,文本编辑,编辑,编辑器,记事,记事本,专门,集成,开发,环境,Visual,InterDev,进行,开发,编程,编程语言,语言,通用,ASP,可使,使用,VBScript,Javascript,Perl,多种,脚本,脚本语言,语言,进行,编程,内置,对象,组件,方便,编程,ASP,提供,多种,功能,功能强大,强大,内置,对象,组件,允许,用户,编写,定制,ActiveX,控件,安全,安全性,ASP,使用,NT,安全,全机,机制,NT,授权,机制,规定,使用,范围,浏览,浏览器,无关,ASP,服务,服务器,服务器端,务器,端的,脚本,执行,环境,需将,脚本,执行,送给,客户,客户端,浏览,浏览器,执行,包含,常规,超文本,文本,标识,不依,依赖,客户,客户端,端的,浏览,浏览器,Web,数据,数据库,据库,综合,查询,系统,系统对,运行,环境,一定,要求,要求,比较,容易,满足,运行,环境,主要,包括,服务,服务器,服务器端,务器,端,客户,客户端,两方,Web,服务,服务器,服务器端,务器,端,要求,操作,操作系统,系统,采用,Windows,NT,必须,须经,Service,Pack,升级,安装,NT,Option,Pack,Web,服务,服务器,服务器软件,务器,软件,采用,IIS,客户,客户端,操作,操作系统,系统,以是,Windows,95,98,Windows,NT,Workstation,不使,使用,DHTML,以是,IE4,01,浏览,浏览器,Navigator,必须,使用,IE,01,数据,数据库,数据库系统,据库,系统,特殊,特殊要求,要求,须,支持,ODBC,即可,数据,数据库,数据库系统,据库,系统,安装,Web,服务,服务器,务器,安装,外服,服务,服务器,务器,成为,为数,数据,数据库,据库,服务,服务器,务器,系统,设计,设计方案,方案,本系,系统,设计,目标,Intranet,基础,之上,浏览,浏览器,服务,服务器,务器,体系,体系结构,结构,基本,架构,ASP,方式,实现,交互,交互式,动态,Web,综合,查询,系统,基本,设计,思路,客户,客户端,需,浏览,浏览器,访问,Web,服务,服务器,务器,服务,服务器,服务器端,务器,端,完成,客户,选择,查询,功能,返回,客户,反复,客户,客户端,能动,动态,获取,获取数据,数据,数据库,据库,信息,完成,成对,对数,数据,数据库,据库,查询,必须,相应,完成,所需,特定,功能,SQL,语句,SQL,语句,需要,事先,设计,计好,存放,放于,数据,数据库,据库,相应,表,保存,分类,信息,方便,用户,检索,使用,系统,系统结构,结构,框架,图,所示,

,图,系统,系统结构,结构,框架,图,箭头,表示,系统,数据,流向,数据,数据库,据库,流向,Web,服务,服务器,务器,数据,包括,ASP,脚本,执行,完成,成特定,特定,查询,功能,SQL,语句,信息,SQL,语句,查询,对象,企业,综合,综合信息,信息,系统,内部,内部结构,结构,分为,图,所示,两层,固定,信息,层,动态,查询,层,固定,信息,层,超文本,文本,语言,文件,形式,存储,存储系统,系统,静态,信息,不会,改变,动态,查询,层,完成,成特定,特定,定数,数据,据查,查询,功能,功能模块,模块,组成,一个,模块,一个,后缀,asp,文件,模块,之间,包含,语句,交叉,引用,模块,可能,包含,多用,脚本,脚本语言,语言,书写,过程,共同,实现,特定,功能,

,图,系统,内部,内部结构,结构,结构图,构图,系统,实现,系统,实现,主要,分为,两部,部分,SQL,生成,Web,查询,先要,实现,SQL,语句,生成,功能,功能模块,模块,一部,一部分,部分,不要,要求,采用,Web,方式,实现,采用,客户,服务,服务器,务器,方式,开发,即可,系统,界面,面如,图,所示,

,图,SQL,生成,界面,用户,使用,使用方便,方便,本系,系统,统通,读取,读取数据,数据,数据库,据库,系统,表,信息,可视,可视化,方式,显示,数据,数据库,据库,表,字段,属性,用户,进行,行相,相应,选择,快速,创建,查询,语句,提供,查询,正确,正确性,验证,查询,预览,系统,主要,部分,Web,查询,实现,一部,一部分,部分,主要,完成,数据,数据库,据库,建立,连接,SQL,执行,显示,程序,程序执行,执行,图,所示,

,图,Web,查询,说明,实现,步骤,假设,Web,服务,服务器,务器,数据,数据库,据库,服务,服务器,务器,独立,两个,服务,服务器,务器,机器,名分,websrv,dbsrv,数据,数据库,据库,采用,Sybase,数据,数据库,据库,名为,pubs,pubs,中表,tsql,存储,设计,计好,SQL,信息,要求,执行,查询,编号,变量,sql,id,传入,第一,第一步,一步,采用,ADO,ODBC,数据,数据库,据库,服务,服务器,务器,dbsrv,建立,连接,ADO,数据,数据库,据库,建立,连接,需要,创建,Connection,对象,设置,连接,参数,DSN,UID,PWD,调用,Connection,对象,Open,方法,进行,连接,连接,参数,采用,DSN,ODBC,标志,OLE,DB,下面,使用,DSN,初始,初始化,连接,接字,字符,字符串,Connstr
var,Connstr,DSN,Pubs,创建,Connection,对象,
var,DBConn,Server,CreateObject,ADODB,Connection,
DBConn,Open,Connstr,sa,pwd,第二,第二步,二步,检索,表,tsql,获取,相应,查询,对应,SQL,ADO,以使,使用,三个,对象,执行,SQL,语句,存储,过程,Connection,对象,Command,对象,Recordset,对象,引入,查询,编号,变量,sql,id
var,id,Request,QueryString,sql,id,
var,sqlqry,select,tsql,s,text,from,pubs,tsql
where,tsql,s,id,创建,Command,对象,
var,cmd,Server,CreateObject,ADODB,Command,
cmd,ActiveConnection,DBConn,
cmd,CommandText,sqlqry+id,调用,cmd,Execute,方法,执行,查询,
var,rsTmp,cmd,Execute,第三,第三步,三步,执行,SQL,并以,超文本,文本,形式,返回,查询,提取,编号,sql,id,查询,语句,
var,sql,text,rsTmp,fields,getValue,s,text,创建,初始,初始化,Recordset,对象,
var,rsResults,Server,CreateObject,ADODB,Recordset,
rsResults,CursorType,adOpenDynamic,
rsResults,LockType,adLockOptimistic,执行,编号,sql,id,查询,
rsResults,Open,sql,text,DBConn,超文本,文本,本方,方式,显示,查询,
var,rdCount,rsResults,getCount,记录,数,
var,fdCount,rsResults,fields,getCount,字段,数,table,border,thead,tr,for,i,to,fdCount,th,rsResults,fields,getName,i,th,next,tr,tbody,
for,i,to,rdCount,1
Response,Write,tr,
for,j,to,fdCount,1
Response,Write,td,
Response,Write,rsResults,fields,getValue,j,
Response,Write,td,
next
rsResults,moveNext,
next
,tbody,table,结语,上述,系统,设计,实现,整个,Web,应用,一部,一部分,部分,尚有,需要,改进,增加,部分,参数,查询,查询处理,处理,用户,标识,验证,安全,安全性,机制,事务,事务处,事务处理,处理,数据,数据库,据库,管理,Web,化,用户,个性,个性化,设置,ASP,服务,服务器,务器,服务,联合,合起,起来,提供,供事,事务,安全,管理,功能,ASP,几乎,涵盖,开发,Web,应用,应用程序,程序,过程,涉及,每个,ASP,存在,局限,局限性,限性,主要,平台,依赖,依赖性,强,只能,Windows,NT,95,Web,服务,服务器,务器,运行,ASP,应用,需要,注意,作者,作者简介,简介,王,志,鹏,硕士,研究,研究生,主要,研究,方向,分布,对象,技术,数据,数据库,据库,Internet,张,海盛,研究,研究员,博士,博士生,导师,主要,研究,方向,软件,软件工程,工程,系统,系统集成,集成,成方,方法,技术,CIMS,沈,益民,副研究员,研究,研究员,主要,研究,方向,软件,软件技术,技术,系统,系统集成,集成,CIMS,作者,单位,中国,中国科学院,科学,科学院,学院,成都,计算,计算机,算机,应用,研究,研究所,四川,成都,610041,参考,参考文献,文献,MSDN,Microsoft,Developer,Network,http,msdn,microsoft,com,vinterdev
,ADO,技术,文档,http,www,mocrosoft,com,data,ado,ASP,技术,文档,http,www,microsoft,com,workshop,server,asp,收稿,日期,1999,06,25
