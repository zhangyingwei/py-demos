计算,计算机,算机,应用,
COMPUTER,APPLICATIONS
1999,19,卷,Vol,19,No,1999



,一个,DCS,组态,软件,设计,实现,徐,晓,东,杨,振,坤,摘,Visual,Basic,Visual,C++,强大,可视,可视化,编程,工具,本文,结合,优点,介绍,设计,实现,分布,分布式,布式,控制,控制系统,系统,工程,工程师,站,操作,操作员,站,软件,关键,关键词,Visual,Basic,Visual,C++,分布,分布式,布式,控制,控制系统,系统,组态,软件,引言,分布,分布式,布式,控制,控制系统,系统,集散,控制,控制系统,系统,以其,强大,控制,功能,可靠,安全,安全性,性能,良好,可移植,可移植性,移植,移植性,国内,国内外,内外,工控,领域,获得,广泛,广泛应用,应用,本文,结合,合作,合作者,作者,化工,化工部,工部,化工,化工机械,机械,研究,研究院,测控,合作,完成,LH,2000,分布,分布式,布式,控制,控制系统,系统,工程,工程师,站,操作,操作员,站,软件,软件设计,设计,一介,介绍,软件,采用,Visual,Basic5,Visual,C++5,混合,合编,编程,充分,充分运用,分运,运用,VB,强大,高效,界面,面生,生成,能力,Access,数据,数据库,据库,功能,VC++,易于,对内,内存,硬件,操作,特点,VB,VC++,微软,产品,相互,相互之间,之间,联接,容易,软件,运行,WIN95,环境,程序,程序设计,设计,采用,面向,面向对象,对象,结构,结构化,结构化编程,编程,思想,系统,系统软件,软件,划分,分为,既有,有机,联系,相互,独立,几部,部分,彼此之间,之间,间或,直接,调用,动态,动态链接库,链接,链接库,连接,系统,系统软件,软件,软件体系结构,体系,体系结构,结构,系统,系统软件,软件,软件体系结构,体系,体系结构,结构,对系统,系统,硬件,划分,LH,2000,分布,分布式,布式,控制,控制系统,系统,硬件,分为,工程,工程师,站,操作,操作员,站,现场,控制,控制站,相应,系统,系统软件,软件,工程,工程师,站,软件,操作,操作员,站,软件,现场,控制,控制站,软件,工程,工程师,站,操作,操作员,站位,位于,PC,机上,现场,控制,控制站,196,型,单片,单片机,处理,处理器,理器,智能,板,现场,控制,控制站,软件,单片,单片机,汇编,汇编语言,语言,编写,本文,讨论,范围,PC,系统,系统软件,软件,软件包,包括,必要,初始,初始化,采集,程序,用于,工程,工程师,站,组态,程序,操作,操作员,站上,运行,行程,程序,独立,可执行文件,执行,行文,文件,相互,相互间,WIN95,共享,共享内存,内存,通信,软件,开发,协同,并行,完成,增强,软件,软件系统,系统,可靠,可靠性,利于,软件,软件维护,维护,升级,初始,初始化,过程,设置,启用,PC,机,相关,硬件,设备,包括,扩展,智能,插卡,初始,初始化,完成,定时,接收,现场,控制,控制站,采集,集数,数据,系统,组态,需要,不同,应用,应用领域,领域,离线,进行,投入,运行,现场,控制,情况,在线,组态,系统,系统工程,工程,工程师,师级,操作,权限,限制,制约,必须,输入,合法,密码,修改,运行,运行部,行部,部分,提供,良好,人机,人机交互,交互,界面,实现,整个,现场,实时,监控,工程,PC,系统,系统软件,软件,执行,顺序,图,

,图,1
3,系统,PC,软件,软件设计,设计,初始,初始化,采集,程序,设计,初始,初始化,采集,程序,工程,工程项目,项目,投入,运行,PC,系统,系统软件,软件,最先,执行,本系,系统,采用,CAN2,Control,Area,Network,总线,操作,操作员,站,PC,机,插入,一块,ISA,总线,智能,光电,隔离,CAN,控制,控制卡,组成,CAN,智能,智能卡,计算,计算机,算机,之间,采用,DMA,通信,方式,初始,初始化,采集,程序,先要,完成,成对,CAN,卡,驱动,使用,VC,提供,端口,输入,输入输出,输出,函数,outp,inp,即可,可发,发送,CAN,卡,握手,信息,实现,DMA,传输,启动,选定,DMA,通道,WIN95,轻易,事情,WIN95,几乎,接管,PC,硬件,设备,象,DOS,操作,DMA,势必,引起,死机,需要,借助,DDK,VToolsD,开发,开发工具,工具,编写,虚拟,拟设,设备,驱动,驱动程序,程序,vxd,VC,应用,应用程序,程序,CreateFile,打开,利用,vxd,回传,地址,读取,DMA,通道,数据,初始,初始化,软件,完成,工作,创建,共享,共享内存,内存,VC,WIN32,函数,CreateFileMapping,MapViewOfFile,创建,共享,共享内存,内存,获取,读写,共享,共享内存,内存,指针,DLL,相应,OpenFileMapping,打开,前面,共享,共享内存,内存,映射,文件,句柄,同样,MapViewOfFile,获取,读写,共享,共享内存,内存,指针,两个,应用,应用程序,程序,之间,建立,数据,数据通,数据通道,通道,共享,共享内存,内存,本系,系统,关键,关键环节,环节,有利,利用,共享,共享内存,内存,实现,VC,程序,VB,程序,之间,数据,据传,传递,共享,共享内存,内存,提供,供应,应用,应用程序,程序,程序接口,接口,灵活,组态,关键,共享,共享内存,内存,预留,变量,数组,供,组态,变量,看作,不同,应用,应用程序,程序,全局,全局变量,变量,用户,能够,VC5,利用,预留,变量,编写,处理,处理程序,程序,编译,连接,连接成,满足,特定,需要,EXE,文件,组态,程序,设计,组态,程序,主要,分为,系统,组态,数据,数据库,据库,组态,回路,组态,流程,流程图,组态,报表,组态,系统,组态,设计,系统,组态,整个,控制,控制系统,系统,硬件,结构,进行,组态,整个,工程,工程项目,项目,项目组,组态,第一,第一步,一步,本系,系统,采用,用工,工业,现场,总线,CAN2,现场,控制,控制站,操作,操作员,站,基本,配置,置信,信息,系统,组态,设定,选择,投入,运行,现场,控制,控制站,类型,个数,站,号,确定,操作,操作员,站,站,号,设定,定安,安全,保护,操作,操作员,操作,权限,操作,范围,进行,限定,最后,配置,置信,信息,VB,mdb,数据,数据库,据库,文件,保存,下装,数据,数据库,据库,组态,设计,数据,数据库,据库,分布,分布式,布式,控制,控制系统,系统,信息,来源,一个,工程,工程项目,项目,目中,中所,需要,监测,控制,数据,数据库,据库,组态,完成,据点,点数,数据,数据类型,类型,不同,数据,数据库,据库,组态,分为,模拟,模拟量,输入,模拟,模拟量,输出,开关,量,输入,开关,量,输出,计算,量,中计,计算,量,初始,初始化,采集,程序,提供,应用,应用程序,程序,程序接口,接口,变量,本质,讲,模拟,模拟量,用户,使用,组织,显示,显示信息,信息,参与,输入,输入输出,输出,计算,量,组态,定义,变量,变量名,名称,指定,预留,数组,位置,I,O,型,变量,组态,项目,基本,共同,共同点,同点,名称,报警,存盘,I,O,地址,变量,类型,监控,需要,要来,设计,设计组,组态,项目,复杂,模拟,模拟量,输入,组态,索引,引信,信息,记录,号,工位,号,显示,存储,信息,点名,名称,工程,单位,量程,转换,换系,系数,记录,类型,报警,信息,信号,下限,量程,下限,信号,下限,对应,物理,物理量,报警,级别,报警,下限,报警,上上,下下,下限,I,O,信息,站,号,板,号,通道,道号,仪表,类型,指,测温,温型,热电,热电偶,热敏,热敏电阻,电阻,测流,流量,型,流量,流量计,量计,测,压力,型,检测,元件,不同,同型,同型号,型号,不同,同类,类型,传感,传感器,感器,测量,数据,处理,方法,有别,回路,组态,功能,实现,完成,成数,数据,数据库,据库,组态,进行,回路,组态,回路,组态,分布,分布式,布式,控制,控制系统,系统,组态,关键,关键步骤,步骤,主要,要用,用于,连续,过程,程控,控制,报警,检测,处理,确定,输入,输入输出,输出,回路,回路,组态,数据,数据库,据库,每一项,一项,记录,包含,一条,完整,回路,必备,信息,利用,信息,实现,对系统,系统,控制,回路,组态,输入,输入输出,输出,不同,同分,分为,模,入,模,回路,模,入,开出,回路,开入,开出,回路,回路,组态,合理,直接,影响,控制,质量,好坏,回路,组态,项目,显示,显示信息,信息,回路,路名,名称,回路,类型,回路,输入,输入输出,输出,变量,类型,定,在读,回路,组态,数据,数据库,据库,选取,后面,组态,项目,目中,需要,数据,I,O,信息,输入,输出,出点,必须,数据,数据库,据库,组态,存在,变量,类型,报警,信息,输入,报警,控制,信息,开关,特性,输出,作用,反作用,作用,控制,制规,规律,PID,串,级,前馈,比例,幅,控制,对开,开关,量,输出,控制,极性,控制,周期,设定,设定值,P,I,D,参数,温度,补偿,通道,用于,温度,温度控制,控制,压力,补偿,通道,用于,压力,控制,回路,工作,状态,回路,控制,密切,密切相关,相关,跟踪,回路,工作,状态,手动,自动,回路,组态,回路,状态,一项,离线,组态,应,填入,入手,手动,第一,第一次,一次,运行,行时,手动,调整,满足,满足要求,要求,回路,未必,必是,组态,项,有意,意义,项,按规定,规定,填写,实际,实际上,不用,用户,回路,组态,所要,完成,工作,实质,约定,格式,要求,填写,填写表格,表格,VB,提供,DBGrid,控件,表格,数据,数据库,据库,适合,合编,编写,此类,程序,Method,方法,Event,事件,事件驱动,驱动,功能,对数,数据,数据库,据库,操作,编程,简洁,高效,尤其,能够,关联,数据,数据库,据库,文件,mdb,自动,读取,显示,编辑,自动,保存,流程,流程图,组态,编制,DCS,组态,软件,具有,丰富,富强,强大,工艺,工艺流程,流程,流程图,组态,功能,这部,这部分,部分,分工,工作,作主,主要,VB,中实,实现,Visual,Basic,具备,完善,图形,函数,方便,实用,图形,控件,Line,Shape,Graph,Image,利用,提供,供给,用户,基本,流程,流程图,编辑,功能,直线,圆,矩形,多边,多边形,选择,线,粗细,颜色,圆,矩形,填充,方便,实现,复杂,图形,生成,软件,提供,预先,设计,计好,常用,现场,现场图,图形,控件,反应,反应罐,阀门,管道,马达,控件,Autocad,构造,造出,造出来,编程,难点,实现,鼠标,拖动,自由,缩放,了解,Autocad,文件,存储,格式,VB,中用,读,二进制,进制,文件,方法,获取,构成,图形,必备,信息,参数,进行,缩放,操作,需,改变,变相,相应,参数,复杂,图形,控件,直接,存为,Bmp,Jpg,图形,格式,利用,VB,提供,Image,控件,Stretch,属性,设置,True,实现,缩放,操作,流程,流程图,组态,一项,工作,画面,相关,联系,起来,界面,面会,会弹,弹出,数据,数据库,据库,组态,记录,列表,选择,所需,项目,实现,画面,选中,中值,动态,连接,开关,量,画面,面会,据实,实测,实测值,呈,态,性,模拟,模拟量,对应,画面,以是,直接,数值,显示,棒状,图,连续,变化,显示,报表,组态,实现,报表,大致,分为,周期,周期性,报表,触发,发性,列表,两种,周期,周期性,报表,打印,生产,过程,操作,记录,统计,求和,取代,操作,操作工,作工,抄,表工,工作,这类,报表,采用,定时,驱动,通常,时报,班,报,日报,月,报,触发,发性,列表,记录,特定,事件,发生,生前,往往,进行,行事,事故,故障,分析,VB,实现,报表,表功,功能,三种,方法,利用,VB,DDE,OLE,对象,链接,嵌入,功能,直接,EXCEL,报表,输出,环境,利用,VB,提供,Crystal,Report,控件,先在,Report,Designer,需要,生成,rpt,文件,Crystal,Report,ReportFileName,属性,设为,需要,rpt,文件,能够,控制,制报,报表,生成,打印,两种,方法,优点,编程,容易,功能,实现,制约,想,完全,控制,制报,报表,生成,打印,最好,好使,使用,VB,打印,打印机,印机,控件,Printer,Printer,控件,外部,外部设备,设备,打印,打印机,印机,虚拟,拟为,VB,一个,软设备,设备,打印,打印机,印机,编程,直接,方便,报表,组态,过程,需,提供,画线,和文,文本,文本编辑,编辑,功能,确定,报表,输出,出格,格式,输出,项目,打印,报表,时间,用户,组态,记录,利用,Printer,控件,Method,Line,Print,EndDoc,打印,打印输出,输出,运行,行程,程序,设计,运行,行程,程序,分为,实时,时报,报警,工艺,图,调整,图,报警,记录,打印,报表,这部,这部分,部分,VB,编写,运行,软件,启动,启动时,一次,一次性,组态,数据,数据库,据库,数据,数据库,据库,组态,回路,组态,读入,所需,信息,实时,时数,数据,数据库,据库,涉及,数据,数据结构,结构,变化,实时,时数,数据,数据库,据库,操作,应,视,不同,同情,情况,定,需要,大量,频繁,访问,DMA,传输,数据,直接,读,内存,方法,少量,访问,地方,报表,程序,周期,周期性,采样,可编,编写,函数,数间,间接,读取,现场,控制,控制站,传来,数据,VC,应用,应用程序,程序,送入,共享,共享内存,内存,区,VB,难以,直接,对内,内存,进行,操作,但有,调用,动态,动态链接库,链接,链接库,功能,调用,DLL,VC,初始,初始化,采集,程序,通信,完成,操作,操作员,站,监测,控制,功能,运行,界面,最上,上方,红色,窗口,报警,警区,窗口,覆盖,VB,调用,WIN95,API,函数,SetWindowPos,报警,窗口,永远,置于,屏幕,上端,系统,每秒,每秒钟,秒钟,读取,测量,数据,做,下限,判断,如有,越界,显示,相应,报警,信息,报警,窗口,始终,显示,最新,报警,以前,报警,信息,报警,记录,查看,工艺,图,显示,分为,静态,图,动态,动态图,静态,图,流程,流程图,编辑,记录,一次,绘制,完成,动态,动态图,分为,三种,情况,图像,移动,图像,切换,图像,移动,切换,图像,载体,VB,Image,控件,Picture,控件,图像,移动,改变,控件,位置,属性,利用,控件,Move,方法,图像,切换,需要,动态,改变,控件,Picture,属性,图像,移动,切换,须,两种,方法,并用,简单,动态,动态显示,显示,线段,平移,方块,方块图,刷新,无须,图像,控件,编写,相应,函数,即可,实现,调整,图,运行,行时,主要,监控,界面,一幅,调整,图集,集中,一条,控制,回路,监控,信息,显示,示现,现场,控制,控制站,传来,测量,数据,测量,量值,设定,设定值,比较,确定,控制,质量,好坏,在线,修改,PID,参数,设定,设定值,改回,回路,状态,手动,直接,控制,输出,大小,调整,图下方,下方,两幅,图像,趋势,图,棒状,图,趋势,图记,记录,最近,五分,五分钟,分钟,测量,量值,设定,设定值,输出,并以,趋势,曲线,形式,显示,从中,控制,质量,好坏,一目,一目了然,了然,棒状,图,棒状,条,形式,动态,动态显示,显示,测量,量值,左右,不同,颜色,三角,三角形,角形,标尺,代表,输出,设定,设定值,不同,回路,状态,自动,手动,过上,箭头,箭头键,可调,调节,调整,图,界面,面如,图,所示,

,图,2
4,说明,分布,分布式,布式,控制,控制系统,系统,工程,工程师,站,组态,软件,操作,操作员,站,运行,软件,整个,控制,控制系统,系统,重要,组成,组成部分,部分,需要,完成,任务,很多,DCS,应用,应用软件,软件,设计,实现,复杂,系统,系统工程,工程,完成,基本,工作,工作,有待,有待于,进一步,一步,补充,不断,不断完善,完善,作者,作者简介,简介,徐,晓,东,硕士,研究,研究生,专业,方向,计算,计算机,计算机控制,算机,控制,作者,单位,西安,西安交通,西安交通大学,交通,大学,电气,气学,学院,陕西,西安,710049,参考,参考文献,文献,王,常,力,廖,文,集散,型,控制,控制系统,系统,设计,应用,北京,清华,清华大学,清华大学出版社,华大,大学,出版,出版社,1993
,王,常,力,罗,安,集散,型,控制,控制系统,系统,统选,选型,应用,北京,清华,清华大学,清华大学出版社,华大,大学,出版,出版社,1996
,Charles,Petzold,著,Windows95,程序,程序设计,设计,北京,清华,清华大学,清华大学出版社,华大,大学,出版,出版社,1997
,收稿,日期,1998,12,14
