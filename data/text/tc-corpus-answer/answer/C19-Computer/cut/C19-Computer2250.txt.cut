计算,计算机,算机,应用,研究,
APPLICATION,RESEARCH,OF,COMPUTERS
2000,Vol,17,No,P,101,102




,利用,数据,管道,技术,实现,管理,管理网络,网络,资源,资源共享,共享,石,晓,龙,吕,汉兴,摘,作者,数据,数据库,据库,管理,管理系,管理系统,系统,设计,遇到,实际,问题,讨论,企业,网,中子,子系统,系统,数据,资源,共享,问题,其实,实现,方案,结合,系统,方案,具体实施,实施,介绍,数据,管道,技术,应用,关键,关键词,企业,网,数据,数据库,据库,管理,管理系,管理系统,系统,ODBC,数据,管道,进行,大型,数据,数据库,据库,管理,管理系,管理系统,系统,设计,开发,经常,常会,遇到,情形,用户,已经,使用,专用,商业,商业化,管理,管理软件,软件,使用,开发,小系,系统,并要,要求,改变,原有,系统,正常,运行,情况,获得,数据,数据管理,管理,管理系,管理系统,系统,数据,开放,开放式,数据,数据库,据库,连接,ODBC,以使,使用,标准,SQL,语句,访问,提供,ODBC,驱动,驱动程序,程序,特定,数据,数据库,据库,客户,客户端,设计,直接,接通,ODBC,访问,独立,子系统,系统,获取,所需,数据,查询,方式,显然,遇到,以下,几个,难点,子系统,系统,数据,数据库,据库,均,独立,数据,数据结构,结构,数据,数据类型,类型,难以,客户,客户端,照用,用户,要求,求实,实现,数据,据查,查询,不同,子系统,系统,采用,不同,数据,数据库,据库,访问,各类,数据,必须,频繁,各类,数据,数据库,据库,建立,连接,增加,系统,开销,降低,管理,管理网络,网络,工作,工作效率,效率,单机,子系统,系统,采用,不支,支持,网络,访问,数据,数据库,据库,无法,为数,数据,数据库,据库,服务,服务器,务器,访问,上面,所讲,问题,特别,第三,第三点,三点,无法,克服,决定,采用,ODBC,直接,接访,访问,方式,采取,以下,下方,方式,设计,系统,使用,数据,管道,技术,所需,子系统,系统,数据,灌入,数据,数据库,据库,服务,服务器,务器,做,解决,第三,第三点,三点,无法,网络,使用,ODBC,直接,接访,访问,单机,机子,子系统,系统,问题,对数,数据,灌入,设计,屏弃,原有,有数,数据,数据库,据库,结构,完全,照用,用户,要求,选择,所需,需要,数据,并建,建立,建立相应,相应,数据,数据库,据库,结构,而为,客户,客户端,软件,设计,计提,提供,极大,便利,用户,访问,子系统,系统,数据,需要,要同,数据,数据库,据库,服务,服务器,务器,建立,一次,连接,访问,子系统,系统,相关,数据,直接,接通,ODBC,连接,连接子,子系统,系统,数据,数据库,据库,相比,大大,大大减少,减少,系统,开销,提高,网络,工作,工作效率,效率,下面,一个,管理,管理网络,网络,网络软件,软件,软件设计,设计,实例,谈谈,这种,设计,思想,实现,武汉,管道,煤气,煤气公司,公司,信息,信息管理,信息管理系统,管理,管理系,管理系统,系统,设计,照用,用户,要求,必须,包含,财务,人事,材料,设备,生产,等子,子系统,系统,信息,公司,已经,独立,财务,人事,设备,材料,系统,财务,系统,使用,用友,软件,人事,系统,使用,人事,人事部,人事部门,部门,统一,规定,人事,人事管理,管理,管理软件,软件,材料,系统,使用,一个,FOXPRO,开发,管理,管理软件,软件,设备,系统,购买,专用,专用设备,设备,管理,管理软件,软件,设备,人事,系统,均,单机,单机版,使用,前台,PB,后台,SQL,SERVER,数据,数据库,据库,服务,服务器,务器,开发,平台,子系统,系统,均,提供,一套,套用,PB,开发,客户,客户端,软件,使用,PB,数据,管道,功能,客户,客户端,实现,数据,数据,数据库,据库,服务,服务器,务器,灌入,程序,使用,PB,提供,数据,管道,实现,数据,数据库,据库,之间,数据,转换,传输,十分,方便,必须,创建,一个,标准,PB,用户,对象,标准,用户,对象,象是,PB,数据,管道,系统,系统对,对象,继承,

,如上图,上图,选择,OK,完成,数据,管道,用户,对象,创建,选择,存盘,输入,用户,对象,名称,存储,完毕,程序,使用,用户,对象,使用,数据,管道,进行,行数,数据,转换,传送,之前,必须,ODBC,源,数据,数据库,据库,目的,数据,数据库,据库,服务,服务器,务器,建立,连接,编程,定义,两个,事务,型,全局,全局变量,变量,
transaction,client,trans,server,trans
,数据,灌入,窗口,open,事件,中分,源,数据,数据库,据库,目的,数据,数据库,据库,连接,程序,
client,trans,CREATE,TRANSACTION
server,trans,CREATE,TRANSACTION
,定义,源,数据,数据库,据库,参数,
client,trans,DBMS,profilestring,pipeline,ini,client,DBMS,
client,trans,Database,profilestring,pipeline,ini,client,Database,
client,trans,LogID,profilestring,pipeline,ini,client,LogID,
client,trans,LogPass,profilestring,pipeline,ini,client,LogPass,
client,trans,ServerName,profilestring,pipeline,ini,client,ServerName,
client,trans,UserID,profilestring,pipeline,ini,client,UserID,
client,trans,DBPass,profilestring,pipeline,ini,client,DBPass,
client,trans,Lock,profilestring,pipeline,ini,client,Lock,
client,trans,DbParm,profilestring,pipeline,ini,client,DbParm,connect,
using,client,trans,源,数据,数据库,据库,建立,连接,定义,目的,数据,数据库,据库,参数,
server,trans,DBMS,profilestring,pipeline,ini,server,DBMS,
server,trans,Database,profilestring,pipeline,ini,server,Database,
server,trans,LogID,profilestring,pipeline,ini,server,LogID,
server,trans,LogPass,profilestring,pipeline,ini,server,LogPass,
server,trans,ServerName,profilestring,pipeline,ini,server,ServerName,
server,trans,UserID,profilestring,pipeline,ini,server,UserID,
server,trans,DBPass,profilestring,pipeline,ini,server,DBPass,
server,trans,Lock,profilestring,pipeline,ini,server,Lock,
server,trans,DbParm,profilestring,pipeline,ini,server,DbParm,
connect,using,client,trans,目的,数据,数据库,据库,建立,连接,
settransobject,dw,l,d,trans,上述,源,目的,数据,数据库,据库,ODBC,参数,32,ODBC,数据,数据源,管理,管理器,理器,获得,子系统,系统,客户,客户机,ODBC,管理,管理器,理器,没有,有此,数据,数据源,必须,安装,装相,相应,数据,数据库,据库,ODBC,驱动,驱动程序,程序,32,ODBC,数据,数据源,管理,管理器,理器,中建,建立,建立相应,相应,数据,数据源,PB,定义,将要,程序,应用,用到,数据,管道,建立,一个,新,数据,管道,上述,源,数据,数据库,据库,目的,数据,数据库,据库,相连,相连接,连接,选择,所要,传输,数据,数据表,选择,所需,需要,字段,定义,目的,数据,数据库,据库,表,字段,数据,数据类型,类型,选择,合适,灌入,方式,PB,提供,创建,更新,刷新,追加,提交,五种,灌入,方式,提交,记录,条数,选择,all,完成,上述,工作,以使,使用,PB,提供,函数,操作,操作数,作数,数据,管道,PB,提供,三个,对数,数据,管道,进行,操作,函数,start,repair,cancel,用于,启动,修正,取消,数据,管道,操作,启动,数据,管道,程序,
int,pipemsg
long,stime,etime
my,pipeline,cstrans,my,pipeline,自定,自定义,定义,数据,管道,用户,对象,
cstrans,create,my,pipeline
cstrans,dataobject,client,server,client,server,用户,定义,数据,管道,
stime,cpu,获取,获取数据,数据,数据传输,据传,传输,执行,行时,时间,
pipemsg,cstrans,start,server,trans,client,trans,dw,启动,数据,管道,
etime,cpu,
trans,time,text,string,etime,stime,1000,##0,+,secs,执行,执行数,行数,数据,管道,出错,以使,使用,repair,函数,全局,事务,变量,server,trans,连接,目的,数据,数据库,据库,repair,函数,获取,取出,出错,信息,窗口,修正,信息,更新,目标,数据,数据库,据库,运用,实例,
cstrans,repair,server,trans,cancel,函数,停止,一个,正在,执行,数据,管道,运行,
cstrans,cance1,使用,数据,管道,子系统,系统,数据,数据库,据库,数据,灌入,数据,数据库,据库,服务,服务器,务器,管理,管理网络,网络,PB,客户,客户端,需要,访问,SQL,Server,数据,数据库,据库,服务,服务器,务器,迅速,获得,财务,人事,设备,材料,个子,子系统,系统,数据,规定,定定,定期,数据,灌入,保证,服务,服务器,务器,上数,数据,有效,有效性,实践,实践证明,证明,过数,数据,管道,解决,企业,管理,管理网络,网络,中共,共享,子系统,系统,数据,问题,十分,方便,有效,石,晓,龙,华中,华中理工大学,理工,理工大,理工大学,工大,大学,自控,系,武汉,430074,吕,汉兴,华中,华中理工大学,理工,理工大,理工大学,工大,大学,自控,系,武汉,430074,参考,参考文献,文献,
l,SQL,Server,开发,发指,指南,侯,志,平,徐,常胜,珠联璧合,联璧,璧合,PowerBuilder,数据,数据库,据库,配合,开发,开发技术,技术,收稿,日期,1999,月,26,日