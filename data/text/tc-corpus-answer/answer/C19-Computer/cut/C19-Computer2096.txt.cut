计算,计算机,算机,机工,机工程,工程,
COMPUTER,ENGINEERING
1999,25,卷,10,Vol,25,No,10,1999



,ODBC,Visual,C++5,MFC,数据,数据库,据库,应用,应用程序,程序,程序设计,设计,杨,喜,摘要,详细,讲座,Windows,95,环境,应用,Visual,C++,进行,ODBC,MFC,数据,数据库,据库,应用,应用程序,程序,程序开发,开发,具体方法,方法,技巧,分析,MFC,ODBC,运行,运行机制,机制,给出,部分,应用,实例,关键,关键词,数据,数据库,据库,ODBC,MFC
The,ODBC,Based,Visual,C++5,MFC,Database,Application,Development
Yang,Xizhong
,Department,of,Civil,Engneeing,Guangdong,University,Guangzhou,510090,Abstract,The,paper,discusses,upon,the,technology,and,method,for,developing,ODBC,MFC,database,application,by,Visual,C++5,and,then,analyzes,the,running,mechanism,of,MFC,and,ODBC,At,last,some,application,code,is,given,Key,words,Database,ODBC,MFC
,关系,型,数据,数据库,数据库系统,据库,系统,发展,相当,当成,成熟,并得,得到,广泛,广泛应用,应用,但因,不同,数据,数据库,数据库系统,据库,系统,间数,数据,数据结构,结构,差异,造成,种数,数据,数据库,据库,难于,勾通,数据,数据共享,共享,1993,夏,微软,发布,一种,称作,ODBC,异种,种数,数据,数据库,据库,互操作,操作,技术,数据,数据库,据库,应用,应用程序,程序,开发,开发者,不必,关心,心数,数据,数据库,据库,类型,地址,结构,数据,数据库,据库,关系,细节,不同,数据,数据库,据库,访问,简单,当作,作对,一种,种数,数据,数据库,据库,访问,目前,ODBC,已得,得到,数据,数据库,据库,产业,产业界,业界,广泛,广泛支持,支持,Windows,OS,Macintosh,平台,ODBC,驱动,驱动程序,程序,开发,开发工具,工具,大数,数据,数据库,据库,工具,工具厂,厂商,应用,应用软件,软件,软件开发,开发,开发商,商都,提供,ODBC,支持,ODBC,特点,Visual,C++,提供,ODBC,MFC,Database,CRecordSet,CRecordView,CDatabase,提供,数据,数据源,连接,接接,接口,实现,对数,数据,数据源,操作,CRecordSet,提供,数据,数据源,取出,记录,记录集,用于,建立,应用,应用程序,程序,用户,用户界面,界面,直接,接连,连接,CRecordView,视图,控件,显示,数据,数据库,据库,记录,MFC,数据,数据库,据库,应用,应用程序,程序,两种,非常,重要,数据,数据交换,数据交换机,交换,交换机,换机,机制,应用,应用程序,程序,程序界面,界面,对话,对话框,控件,CRecordSet,派生,派生类,成员,变量,DDX,对话,对话框,数据,数据处理,处理,交换,交换机,换机,机制,DoDataExchange,CDataExchange,pDX,建立,关联,CRecordset,派生,派生类,成员,变量,RFX,记录,字段,数据,数据交换,数据交换机,交换,交换机,换机,机制,DoFieldExchange,CFieldExchange,pFX,数据,数据源,相应,表,字段,建立,关联,

,图,两种,重要,数据,数据交换,数据交换机,交换,交换机,换机,机制,应用,ODBC,进行,行数,数据,数据库,据库,编程,步骤,系统,注册,册数,数据,数据源,先生,生成,成数,数据,数据库,据库,Microsoft,Access,创建,一个,个数,数据,数据库,据库,文件,student,mdb,数据,数据库,据库,表,StudentInfo,打开,Window95,控制,控制面板,制面,面板,双击,ODBC32,图标,注册,访问,数据,数据库,据库,AppWizard,创建,建基,基本,本数,数据,数据库,据库,应用,应用程序,程序,创建,过程,所需,需要,数据,数据库,据库,特性,可选,选择,Database,view,with,file,support,选项,Database,view,without,file,support,选项,再选,选定,所要,操作,数据,数据库,据库,选择,所需,需要,表,选项,缺省,基本,本数,数据,数据库,据库,应用,应用程序,程序,添加,支持,数据,数据库,据库,库特,特性,代码,创建,数据,数据库,据库,记录,显示,应用,资源,编辑,编辑器,对对,对话,对话框,进行,修改,数据,数据库,据库,记录,字段,数量,类型,对话,对话框,中加,加入,相应,用于,数据,显示,编辑,编辑框,静态,标签,每个,编辑,编辑框,属性,对话,对话框,给定,ID,号,属性,每个,编辑,编辑框,代表,数据,数据库,据库,记录,一个,字段,运行,ClassWizard,对话,对话框,每个,编辑,控件,记录,记录集,集中,相应,成员,变量,相连,相连接,连接,选择,m,pSet,m,StudentName,进行,绑定,选择,应用,应用程序,程序,CRecordSet,派生,派生类,成员,变量,应用,应用程序,程序,视图,控件,成员,变量,建立,控件,数据,数据源,之间,连接,时运,运行,行程,程序,显示,数据,数据库,据库,数据,加入,支持,数据,数据库,据库,库特,特性,代码,基本,本数,数据,数据库,据库,操作,代码,生成,数据,数据库,据库,应用,应用程序,程序,视图,包含,一个,指向,CRecordSet,记录,记录集,派生,派生类,对象,指针,m,pSet,指针,建立,视图,记录,记录集,之间,联系,视图,中能,容易,易地,显示,记录,记录集,集中,相应,查询,新增,增记,记录,m,pSet,AddNew,建立,一个,空,记录,UpdateData,FALSE,空,记录,刷新,控件,显示,删除,记录,m,pSet,Delete,删除,当前,记录,m,pSet,MoveNext,if,m,pSet,IsEOF,是否,记录,记录集,末尾,m,pSet,MoveLast,if,m,pSet,IsBOF,是否,记录,记录集,开头,m,pSet,SetFieldNull,NULL,UpdateData,FALSE,视图,窗口,显示,编辑,记录,m,pSet,Edit,存储,记录,UpdateData,TRUE,数据,控件,传送,送到,记录,记录集,if,m,pSet,CanUpdate,确定,定数,数据,数据源,是否,更新,m,pSet,Update,新,记录,数据,添加,加到,数据,数据源,m,pSet,Requery,重建,记录,记录集,UpdateData,FALSE,刷新,视图,窗口,显示,数据,数据库,据库,排序,过滤,数据,数据库,据库,排序,关闭,记录,记录集,设定,排序,字段,字段名,即将,SQL,语句,Orderby,字符,字符串,赋,m,strSort,打开,开记,记录,记录集,m,pSet,Close,关闭,记录,记录集,m,pSet,m,strSort,Name,设置,排序,字段,m,pSet,Open,重新,打开,开记,记录,记录集,UpdateData,FALSE,新,排好,序,记录,记录集,更新,视图,数据,数据库,据库,过滤,关闭,记录,记录集,设定,过滤,排序,字符,字符串,即将,SQL,语句,Where,条件,串,赋,m,strFilter,打开,开记,记录,记录集,m,pSet,Close,关闭,记录,记录集,m,pSet,m,strFilter,Name,Yang,设置,过滤,字符,字符串,m,pSet,Open,重新,打开,开记,记录,记录集,int,Recount,m,pSet,GetRecordCount,if,Recount,m,pSet,Close,m,pSet,m,strFilter,m,pSet,Open,UpdateData,FALSE,数据,数据库,据库,表,操作,Visual,C++5,AppWizard,生成,成数,数据,数据库,据库,应用,应用程序,程序,序时,通常,选择,数据,数据源,单个,表,进行,操作,但有,时数,数据,数据库,据库,应用,应用程序,程序,需要,实现,多个,表,进行,操作,可用,下列,方法,实现,表,同步,联合,联合操作,操作,生成,成数,数据,数据库,据库,应用,应用程序,程序,ClassWizard,创建,建新,CRecordSet,派生,派生类,数据,数据源,选择,多个,表,生成,CRecordSet,派生,派生类,所选,表,字段,集合,生成,一个,表,同步,同步操作,操作,一个,表,下面,同步,同步操作,操作,表,table1,table2,table3,table1,table2,结构,相同,部分,代码,void,CMydbSet,DoFieldExchange,CFieldExchange,pFX,AFX,FIELD,MAP,CMydbSet,pFX,SetFieldType,CFieldExchange,outputColumn,RFX,Text,pFX,T,table1,name,m,name,RFX,Text,pFX,T,IDCard,m,IDCard,AFX,FIELD,MAP
,CString,CMydbSet,GetDefaultSQL,return,T,table1,table2,table3,表单,单独,异步,操作,数据,数据库,据库,应用,应用程序,程序,需要,异步,操作,多个,表,可用,ClassWizard,对数,数据,数据源,表,创建,CRecordSet,派生,派生类,进行,行管,管理,即可,实现,表单,单独,进行,操作,同类,类型,表,切换,操作,数据,数据库,据库,应用,应用程序,程序,需要,异步,操作,多个,表,具有,相同,结构,即为,同类,表,对数,数据,数据源,表,创建,CRecordSet,派生,派生类,进行,行管,管理,实现,表单,单独,进行,操作,做,增加,编程,工作,工作量,复杂,复杂性,过分,分析,单独,独创,创建,同类,表,CRecordSet,派生,派生类,发现,构成,成大,大部,大部分,部分,相同,差别,成员,函数,GetDefaultSQL,返回,表,名,不同,第一,第一个,一个,表,该函,函数,CString,CSet1,GetDefaultSQL,return,T,table1,生成,成数,数据,数据库,据库,应用,应用程序,程序,创建,建新,CRecordSet,派生,派生类,选择,数据,数据库,据库,选择,一个,表,此后,该类,成员,函数,GetDefaultSQL,进行,修改,表,名,换为,一个,个字符,字符,字符串,变量,打开,特定,表,之前,表,名字,字符,字符串,T,table2,赋,字符,字符串,变量,TableName,实现,现用,同一,同一个,一个,CRecordSet,派生,派生类,多个,同类,表,进行,独立,操作,CString,CSet1,GetDefaultSQL,return,T,TableName,结论,应用,Visual,C++5,ODBC,类库,进行,MFC,数据,数据库,据库,应用,应用程序,程序,开发,操作,大多,大多数,多数,数据,数据库,据库,异种,种数,数据,数据库,数据库系统,据库,系统,操作,用户,不同,数据,数据库,据库,访问,简单,当作,作对,一种,种数,数据,数据库,据库,访问,减少,开发,工作,工作量,程序,具有,良好,可移植,可移植性,移植,移植性,数据,数据库,据库,独立,独立性,可扩充性,扩充,扩充性,作者,作者简介,简介,杨,喜,1964,男,副教授,教授,研究,方向,GIS,数据,数据库,数据库系统,据库,系统,Auto,CAD,开发,多媒体,多媒体技术,媒体,技术,作者,单位,广东,工业,业大,大学,土木,土木工程,木工,工程,工程系,广州,510090
,参考,参考文献,文献,Kruglinski,D,J,王国,印,译,Visual,C++,技术,内幕,北京,清华,清华大学,清华大学出版社,华大,大学,出版,出版社,1994
2,Gregory,K,康,博,创作,创作室,译,Visual,C++5,开发,使用,使用手册,手册,北京,机械,机械工业,工业,出版,出版社,1998
,收稿,日期,1999,02,09
