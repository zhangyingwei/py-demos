计算,计算机,算机,应用,
Computer,Applications
1999,19,卷,Vol,19,No,1999



ASP,数据,数据库,据库,查询,多页,显示,技术,实现,朱,世,平,摘,本文,文简,简要,介绍,ASP,基本,基本概念,概念,设计,检索,多页,显示,具体方法,方法,进一步,一步,说明,ASP,构架,Internet,Intranet,应用,具有,简明,高效,技术,优势,关键,关键词,ASP,Web,应用,检索,技术,多页,显示,
IMPLEMENTATION,OF,DATABASE,RETRIEVE
PAGES,DISPLAY,TECHNOLOGY,ON,ASP
Zhu,Shiping
China,University,of,Mining,Technology,Jiangsu,Xuzhou,221008
,Abstract,This,paper,briefly,describes,the,basic,concepts,of,ASP,technology,It,also,describes,specific,method,in,the,course,of,access,result,pages,design,It,explains,technical,advantage,of,ASP,on,application,of,Internet,Intranet,Keywords,ASP,Application,of,web,Retrieve,technology,Pages,display
1,引言,ASP,Active,Server,pages,Microsoft,公司,1996,11,月,推出,Web,应用,应用程序,程序,程序开发,开发,开发技术,技术,提供,一个,集成,脚本,脚本语言,语言,Vbscript,Jscript,HTML,网页,并作,作用,用于,服务,服务器,服务器端,务器,端的,脚本,环境,ASP,HTML,ODBC,数据,数据库,据库,访问,新颖,技术,集于一身,一身,而使,Web,应用,系统,设计,更加,简明,直观,日益,广大,开发,开发人员,发人,人员,关注,下面,ASP,数据,数据库,据库,查询,多页,显示,技术,实现,进行,论述,数据,数据库,据库,连接,基本,查询,技术,知道,ASP,数据,数据库,据库,连接,其内,内置,ADODB,组件,实现,功能,服务,服务器,务器,控制,控制面板,制面,面板,ODBC,设置,DSN,DSN,指向,ODBC,数据,数据库,据库,要使,使用,Server,CreateObject,建立,连接,对象,并用,Open,打开,检索,数据,数据库,据库,命令,格式,Set,Conn,Server,CreateObject,ADODB,Connection,
Conn,open,数据,数据库,据库,名称,数据,数据库,据库,名称,即为,ODBC,设定,数据,来源,名称,Server,CreateObject,需要,进行,以下,说明,ASP,开发,Web,应用,面有,更,高一,一级,功能,提供,五个,内建,对象,Request,对象,用于,使用,使用者,用者,获取,获取信息,取信,信息,Response,对象,信息,传送,送给,使用,使用者,用者,Server,对象,提供,存取,Web,服务,服务器,务器,方法,属性,Session,对象,一个,用户,多个,主页,之间,保留,使用,共同,信息,Application,对象,一个,ASP,应用,不同,使用,使用者,用者,共享,信息,Server,对象,一个,重要,方法,CreateObject,命令,ADODB,实际,实际上,ASP,提供,五个,服务,服务器,务器,控件,当中,一个,通常,称为,为数,数据,数据库,据库,访问,控件,一个,服务,服务器,务器,控件,相当,相当于,当于,一个,对象,提供,供方,方法,属性,使用,服务,服务器,服务器资源,务器,资源,想,调用,服务,服务器,务器,控件,必须,利用,Server,对象,CreateObject,方法,产生,服务,服务器,务器,控件,实例,上面,命令,Set,Conn,Server,CreateObject,ADODB,Connection,ADODB,服务,服务器,务器,控件,以外,四个,服务,服务器,务器,控件,文件,访问,控件,FileSystemObject,对象,TextStream,对象,提供,读写,服务,服务器,务器,文件,功能,广告,轮播,器,控件,广告,图片,信息,轮流,显示,主页,浏览,浏览器,信息,控件,提供,用户,所用,浏览,浏览器,功能,信息,Web,服务,服务器,务器,内容,链接,控件,方便,使用,一个,文本,文本文件,本文,文件,管理,超级,超级链接,链接,一页,一页,链接,功能,数据,数据库,据库,建立,连接,设定,SQL,命令,使用,Execute,执行,执行数,行数,数据,数据库,据库,检索,检索,存储,RecordSets,对象,RS,命令,格式,Set,RS,Conn,Execute,SQL,命令,SQL,命令,检索,条件,HTML,Form,表单,用户,所填,数据,确定,定义,RS,集,对象,能够,使用,Recordsets,对象,命令,查询,进行,控制,主要,包括,RS,Fields,count,Recordsets,字段,数,
RS,i,Name,i,字段,字段名,名称,i,算起,起到,RS,Fields,count,
RS,i,i,字段,数据,i,算起,起到,RS,Fields,count,
RS,字段,字段名,名称,读取,指定,字段,数据,
RS,EOF,True,False,指到,数据,数据库,据库,文件,最后,一个,记录,
RS,MoveNext,指针,移到,一个,记录,
RS,MovePrev,指针,移到,一个,记录,
RS,MoveFirst,指针,移到,第一,第一个,一个,记录,
RS,MoveLast,指针,移到,最后,一个,记录,
RS,GetRows,查询,放到,数组,
RS,Close,关闭,检索,集,
Conn,Close,关闭,连接,数据,数据库,据库,ASP,查询,当中,基本,技术,多页,显示,技术,实现,检索,集中,数据,很多,希望,命令,按键,形式,查询,进行,翻阅,以往,Windows,应用,应用程序,程序,通常,使用,方式,ASP,实现,技术,知道,ASP,Recordset,对象,象是,主要,数据,界面,采用,下代,代码,能够,产生,一个,滚动,只读,Recordset,对象,Set,Conn,Server,CreateObject,ADODB,Connection,
Set,RS,Server,CreateObject,ADODB,Recordset,
Conn,Open,ZHUDB,SA,
RS,Open,Select,from,authors,Conn,
adOpenKeyset,adLockReadOnly
,Recordset,对象,打开,以使,使用,用以,以下,四种,不同,光标,模式,动态,光标,模式,允许,查看,其他用户,他用,用户,做,增加,修改,删除,操作,允许,Recordset,对象,类型,移动,需,依赖,书签,允许,提供,提供者,供者,支持,书签,功能,键盘,光标,模式,操作,一个,动态,光标,相异,之处,允许,查看,其他用户,他用,用户,做,增加,操作,允许,存取,其他用户,他用,用户,Recordset,删除,记录,静态,光标,模式,提供,静态,拷贝,一套,记录,操作,查询,数据,产生,报告,之用,其他用户,他用,用户,做,增加,修改,删除,不可,前滚,光标,模式,操作,一个,静态,光标,相异,之处,允许,向前,前滚,滚动,记录,需要,要使,使用,一次,Recordset,提高,运行,效率,如不,不具,指定,光标,模式,ASP,ADO,预设,设为,前滚,光标,模式,前滚,Recordset,对象,支持,MoveNext,方法,实际,应用,光标,模式,锁定,类型,设定,设定值,表,所示,表,1

,常数,常数,数值,描述,
AdOpenForwardOnly0,前滚,光标,模式,
AdOpenKeyset1,键盘,光标,模式,
AdOpenDynamic2,动态,光标,模式,
AdOpenStatic3,静态,光标,模式,
AdLockReadOnly1,只读,
AdLockPressimistic2,悲观,锁定,
AdLockOptimistic3,乐观,锁定,
AdLockBatchOptimistic4,乐观,批量,更新,

,定,光标,模式,Recordset,属性,方法,PageSize,AbsolutePage,NextRcordset,结合,相应,脚本,代码,能够,实现,预期,效果,下面,给出,一个,实例,代码,Zhu,asp,文件,HTML,Body,
Const,a,dOpenKeySet,1
Const,a,dLockReadOnly,1
Set,Conn,Server,CreateObject,ADODB,Connection,
Set,RS,Server,CreateObject,ADODB,RecordSet,
Conn,Open,SQLWEB1,SA,
RS,OPEN,Select,From,CBOOK,Where,Title,高等,高等数学,数学,
Conn,a,dOpenKeySet,a,dLockReadOnly
RS,PageSize,4

SCRO,REQUEST,SCRO,
IF,SCRO,THEN
PAGENO,MID,SCRO,
IF,PAGENO,THEN
PAGENO,1
END,IF
ELSE
PAGENO,1
END,IF
RS,ABSOLUTEPAGE,PAGENO
,P,Form,Method,POST,ACTION,ZHU,asp,Do,While,Not,RS,is,Nothing,检索,结果显示,显示,TABLE,Colspan,Cellpadding,Border,TR,TH,书名,TH,TH,著者,TH,TH,出版,TH,TH,出版,出版社,TH,TR,
RowCount,RS,PageSize
Do,While,Not,RS,EOF,and,RowCount,TR,TD,BGCOLOR,8fffde,VALIGN,TOP,FONT,
COLOR,#0000,RS,title,TD,TD,BGCOLOR,8fffde,VALIGN,TOP,FONT,
COLOR,#0000,RS,author,TD,TD,BGCOLOR,8fffde,VALIGN,TOP,FONT,
COLOR,#0000,RS,pubdate,TD,TD,BGCOLOR,8fffde,VALIGN,TOP,FONT,
COLOR,#0000,RS,publisher,TD,TR,
RowCount,RowCount,1
RS,MoveNext
Loop
,TABLE,p,
SET,RS,RS,NextRecordSet
Loop
Conn,Close
Set,RS,Nothing
Set,Conn,Nothing
,p,p,IF,PAGENO,THEN,

,INPUT,TYPE,SUBMIT,NAME,SCRO,VALUE,Page,PAGENO,END,IF,IF,ROWCOUNT,THEN,INPUT,TYPE,SUBMIT,NAME,SCRO,VALUE,Page,PAGENO+1,END,IF,Form,

,BODY,HTML,程序,用于,查询,图书,图书馆,书馆,书目,目中,书名,名叫,高等,高等数学,数学,图书,确定,每页,最多,显示,四条,记录,显示,内容,包括,书名,著者,出版,出版,出版社,运行,图,所示,


,图,运行,结束,结束语,互连,互连网,连网,网络,不断,发展,数据,数据库,据库,应用,构架,Internet,Intranet,肯定,发展,必然,必然趋势,趋势,ASP,这方,这方面,确实,带来,引人,引人入胜,新,技术,讨论,ASP,数据,数据库,据库,查询,多页,显示,技术,问题,ASP,配合,ActiveX,构件,构件技术,技术,运用,创建,更多,多充,充满,充满活力,活力,Web,应用,系统,作者,作者简介,简介,朱,世,平,副研究员,研究,研究员,主要,研究,领域,计算,计算机,计算机网,计算机网络,算机,网络,数据,数据库,据库,应用,作者,单位,朱,世,平,中国,中国矿业,中国矿业大学,矿业,矿业大学,业大,大学,江苏,徐州,221008,参考,参考文献,文献,艺,兵,信息,信息系统,系统,实现,数据,数据库,数据库系统,据库,系统,Web,集成,计算,计算机,计算机系,计算机系统,算机,机系统,系统,应用,1998,33,35
,张,建章,浅谈,ASP,开发,Web,数据,数据库,据库,应用,技术,计算,计算机,计算机系,计算机系统,算机,机系统,系统,应用,1998,36,39
,收稿,日期,1999,04,23,修改,修改稿,改稿