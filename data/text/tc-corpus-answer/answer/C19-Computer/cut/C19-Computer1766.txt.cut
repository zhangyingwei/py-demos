软件,学报,
JOURNAL,OF,SOFTWARE
1999,10,卷,Vol,10,No,1999



,大规,大规模,规模,层次,层次化,视频,视频点播,点播,存储,存储系统,系统,设计,管理,李,勇,吴,飞,陈,福,摘要,近来,计算,计算机,算机,通信,技术,发展,视频,视频点播,点播,video,on,demand,简称,VOD,技术,经济,上成,成为,可能,连续,媒体,特性,VOD,系统,需要,大规,大规模,规模,存储,服务,服务器,务器,层次,层次化,存储,存储体,存储体系,体系,减少,系统,费用,合理,方案,文章,提出,一种,层次,层次化,存储,模型,磁盘,cache,概念,模型,提出,访问,频率,替换,替换算法,换算,算法,算法,有效,有效性,进行,模拟,分析,结果表明,表明,这种,算法,解决,LFU,least,frequently,used,算法,cache,污染,cache,pollution,问题,适用,用于,连续,媒体,数据,应用,关键,关键词,连续,媒体,视频,视频点播,点播,层次,层次化,存储,服务,服务器,务器,替换,替换算法,换算,算法,中图,中图法,图法,分类,分类号,TP393
Design,and,Management,of,Large,Scale,
Hierarchical,VOD,Storage,System
LI,Yong,WU,Fei,CHEN,Fu,jie
,Department,of,Computer,Science,Changsha,Institute,of,Technology,Changsha,410073,
Abstract,Recent,advances,in,computing,and,communication,technologies,have,made,VOD,video,on,demand,technically,feasible,and,economically,The,VOD,system,needs,massive,storage,server,because,of,the,characteristic,of,the,continuous,media,Hierarchical,storage,is,a,good,solution,for,the,system,under,low,cost,In,this,article,the,authors,first,propose,a,hierarchical,architecture,model,and,the,concept,of,disk,cache,then,develop,a,replacement,algorithm,based,on,access,frequency,by,the,model,finally,analyse,and,simulate,the,algorithm,The,results,show,that,the,algorithm,avoids,cache,pollution,problem,in,LFU,least,frequently,used,algorithm,and,well,suits,the,applications,of,the,continuous,media,data,objects,
Key,words,Continuous,media,VOD,video,on,demand,hierarchical,storage,server,replacement,algorithm,网络,存储,存储技术,技术,进展,多媒体,媒体,在线,on,line,访问,成为,可能,视频,视频点播,点播,VOD,一个,典型,应用,范例,成为,目前,分布,分布式,布式,多媒体,媒体,研究,热点,VOD,存储,服务,服务器,务器,设计,已经,做,很多,多出,出色,研究,工作,研究,媒体,流,实时,实时性,分析,缓冲,缓冲区,管理,磁盘,调度,磁盘,磁盘阵列,阵列,分布,优化,取得,一定,成果,大都,局限,局限于,限于,单节,节点,小规模,规模,视频,服务,服务器,务器,研究,Brubeck,文献,提出,一种,分布,VOD,体系,体系结构,结构,影片,分布,规模,规模较,视频,服务,服务器,务器,本文,研究,一种,大规,大规模,规模,集中,集中式,中式,VOD,系统,一个,中心,心服,服务,服务器,务器,存储,大量,影片,支持,很大,大规,大规模,规模,客户,户数,数目,服务,服务器,务器,网络,上交,交换,数据,异地,服务,服务器,务器,协同,协同工作,同工,工作,大规,大规模,规模,VOD,系统,系统对,信息,提供,提供者,供者,消费,消费者,更具,吸引,吸引力,引力,有利,有利于,利于,资源,优化,使用,连续,媒体,具有,实时,连续,特征,大规,大规模,规模,VOD,系统,需要,巨大,存储,存储容量,容量,如一,一部,100,分钟,影片,采用,4Mbps,MPEG,压缩,标准,需要,3GB,存储,存储容量,容量,000,影片,3TB,存储,存储容量,容量,表,所示,参数,影片,存储,在内,内存,系统,存储,费用,达到,600,万美元,美元,假设,系统,统支,支持,000,用户,每个,用户,存储,费用,用为,000,美元,在经济上,经济,不可,可行,使用,磁盘,盘存,存储,影片,系统,存储,费用,用为,150,万美元,美元,用户,平均,费用,用为,500,美元,使用,用光,光盘,系统,存储,费用,用为,万美元,美元,用户,平均,费用,15,美元,在经济上,经济,可行,可行性,光盘,性能,太,低,不能,满足,带宽,需求,单一,存储,存储器,器件,难以,满足,性能,价格,双重,重要,要求,设计,既能,满足,带宽,要求,费用,合理,存储,服务,服务器,务器,层次,式,存储,方案,一种,合理,选择,表,存储,存储器,器件,参数,参数表,数表,

,设备,访问,延迟,ms,带宽,Mbps,价格,MB,内存,约,01800,0002
,磁盘,10,20200,4000,光盘,30,5010,200,005


,层次,层次化,存储,存储系统,系统,数据,存储,低速,后援,后援存储器,存储,存储器,常用,数据,存放,放在,具有,高速,高速度,速度,存储,存储器,大部,大部分,部分,访问,高速,器件,满足,存储,存储系统,系统,总体,总体性,体性,性能,接近,近于,高速,存储,存储器,器件,平均,平均价,平均价格,均价,价格,接近,近于,后援,后援存储器,存储,存储器,器件,性能,价格,价格比,提高,达到,效果,取决,取决于,数据,访问,局部,局部性,替换,替换算法,换算,算法,有效,有效性,本文,提出,一种,层次,层次化,存储,存储系统,系统,模型,磁盘,cache,概念,VOD,系统,数据,访问,特性,数据,局部,局部性,进行,分析,VOD,系统,统和,传统,计算,计算机,计算机系,计算机系统,算机,机系统,系统,数据,特性,不同,开发,新,替换,替换算法,换算,算法,文章,节,提出,系统,模型,分析,VOD,影片,数据,访问,特性,访问,局部,局部性,节,描述,层次,层次化,存储,存储系统,系统,替换,替换算法,换算,算法,算法,进行,模拟,分析,节,全文,总结,VOD,数据,访问,特性,系统,模型,VOD,系统,模型,处于,分布,环境,层次,式,结构,图,所示,各种类型,种类,类型,服务,服务器,务器,分布,广域,广域网,网上,Internet,图,中文,文档,服务,服务器,务器,AS,提供,后援,存储,服务,影片,存储,包括,不常,访问,冷门,电影,以是,以是,异地,之间,交换,数据,视频,服务,服务器,务器,VS,存储,热门,影片,客户,提供,点播,实时,服务,客户,客户端,机顶,机顶盒,顶盒,set,top,box,多媒体,多媒体电脑,媒体,电脑,高速,网络,代理,代理服务,代理服务器,服务,服务器,务器,EFS,相连,客户,代理,代理服务,代理服务器,服务,服务器,务器,发出,发出请求,请求,代理,代理服务,代理服务器,服务,服务器,务器,决定,是否,接收,请求,一个,特定,视频,服务,服务器,务器,相连,视频,服务,服务器,务器,客户,提供,实时,服务,视频,服务,服务器,务器,文档,服务,服务器,务器,构成,层次,层次化,结构,巨大,影片,库存,存储,光盘,磁带,组成,后援,后援存储器,存储,存储器,磁盘,构成,二级,存储,存储器,存储,访问,概率,较大,热门,影片,称之为,之为,磁盘,cache,用户,点播,数据,视频,服务,服务器,务器,磁盘,读到,内存,缓冲,缓冲区,高速,网络,发送,发送给,送给,客户,客户端,

,图,系统,模型,和服,服务,服务器,务器,结构,层次,层次化,存储,存储系统,系统,关键,关键在于,数据,访问,局部,局部性,目前,没有,大规,大规模,规模,投入,实际,运行,VOD,系统,无法,法统,统计,确切,影片,访问,特征,以利,利用,影像,出租,统计,统计资料,资料,VOD,系统,设计,服务,研究,表明,访问,概率,进行,排序,影片,访问,概率,基本,基本上,符合,Zipf,法则,N,电影,排序,i,电影,访问,概率,f,i,C,i,i,N,图,所示,客户,点播,集中,前面,一小,一小部分,小部,部分,热门,影片,体现,影片,访问,局部,局部性,影片,库容,库容量,容量,增大,这种,局部,局部性,表现,更加,明显,有研,研究,表明,单位,时间,访问,问人,人数,增加,热门,影片,访问,概率,变得,更,访问,局部,局部性,更,强,大规,大规模,规模,VOD,系统,采用,层次,层次化,存储,合适,考察,一部,影片,不同,时间,访问,概率,每部,影片,访问,概率,不同,变化,特点,上升,平稳,下降,阶段,别称,称之为,之为,成长,成长期,长期,成熟,成熟期,衰老,衰老期,显然,成长,成长期,长期,影片,存入,磁盘,cache,有利,

,图,Zipf,法则,访问,热门,影片,体现,访问,局部,局部性,层次,层次化,VOD,存储,存储系统,系统,设计,管理,一节,利用,这种,种数,数据,局部,局部性,影片,访问,概率,变化,变化规律,规律,开发,合适,替换,替换算法,换算,算法,层次,存储,存储系统,系统,管理,层次,层次化,存储,存储系统,系统,管理,主要,解决,访问,命中,问题,层次,层次化,VOD,系统,问题,主要,体现,现在,磁盘,数据,选取,磁盘,cache,替换,替换算法,换算,算法,传统,计算,计算机,计算机系,计算机系统,算机,机系统,系统,cache,替换,替换算法,换算,算法,主要,FIFO,first,in,first,out,LRU,least,recently,used,LFU,least,frequently,used,FIFO,算法,简单,最先,先进,进入,cache,数据,替换,换出,没有,考虑,数据,使用,情况,LRU,算法,法利,利用,数据,时间,局部,局部性,最近,最少,使用,数据,替换,换出,cache,LFU,算法,考虑,数据,使用,频率,使用,频率,最小,数据,替换,换出,cache,VOD,系统,影片,数据,尺寸,很大,数据,访问,顺序,时间,局部,局部性,不强,存在,访问,局部,局部性,FIFO,LRU,算法,不适,适用,用于,磁盘,cache,LFU,算法,考虑,数据,访问,频率,存在,所谓,cache,污染,问题,cache,pollution,一个,曾经,访问,多次,不再,使用,数据,不能,能及,及时,替换,换出,cache,降低,cache,命中,命中率,VOD,系统,影片,数据,使用,周期,长,访问,频率,变化,一定,规律,特点,开发,一种,周期,频率,预测,测算,算法,periodic,frequency,prognosis,简称,PFP,时间,时间轴,一定,长度,划分,分成,一个,一个个,个个,周期,T1,T2,只用,一个,周期,本周,周期,访问,频率,决定,是否,替换,较早,访问,频率,屏蔽,屏蔽掉,避免,LFU,算法,cache,污染,问题,算法,主要,思想,利用,访问,频率,变化,变化趋势,趋势,成长,成长期,长期,影片,尽早,换入,磁盘,衰老,衰老期,影片,尽早,换出,磁盘,周期,中间,时刻,使用,现行,行频,频率,法,周期,结束,时刻,使用,预测,法,提高,替换,替换算法,换算,算法,命中,命中率,Ti,表示,i,周期,i,自然,自然数,Pk,k,电影,总数,N,影片,库,表示,
S,Pk,k,N,fki,Pk,Ti,访问,概率,热门,电影,表示,Shot,Pk,fki,冷门,电影,表示,Scold,Pk,fki,电影,访问,概率,阈值,目标,热门,电影,放到,磁盘,盘中,中去,算法,固定,一个,热门,电影,影集,统计,影片,访问,频率,访问,频率,影片,访问,概率,Nki,Pk,Ti,访问,次数,Fki,Pk,T1,Ti,访问,次数,Wki,Pk,Ti,Ti,访问,次数,增量,Wki,Nki,Nki,每次,请求,到来,来时,都统,统计,访问,次数,每部,影片,保留,一个,三元,三元组,元组,Fki,Fki,Fki,计算,Nki,Wki,Nki,Fki,Fki,Wki,Nki,Nki,a,每个,周期,中间,使用,请调,法,现在,时刻,t,k,影片,访问,次数,Fk,本周,周期,现在,访问,次数,Nk,Nk,Fk,Fki,磁盘,cache,影片,访问,频率,变化,化分,分为,上升,集,下降,集,上升,集,Sa,Pk,Wki,下降,集,Sd,Pk,Wki,后援,后援存储器,存储,存储器,处于,上升,上升期,访问,频率,大于,阈值,影片,定义,一个,换入,集,
Sin,Pk,Nki,Wki,K,影片,请求,到来,来时,命中,Pk,Sin,满足,换入,条件,磁盘,足够,空间,换入,以下,顺序,换出,影片,Sd,当前,时间,周期,期内,访问,频率,加上,上上,一周,周期,访问,频率,Nk,1+Ni,最小,小者,Pk,Nki,Nk,i,Pk,换出,退出,Sa,当前,时间,周期,期内,访问,频率,加上,上上,一周,周期,访问,频率,Nk,1+Ni,最小,小者,Pk,Nki,Nk,i,Pk,换出,b,周期,结束,时刻,使用,预调,法,阶,线性,法则,预测,一个,时间,周期,访问,频率,Nki+1,Nki+Wki,定义,换入,阈值,in,换出,阈值,out,满足,换入,条件,Nki+1,in,Wki,影片,列入,换入,集,Sin,满足,换出,条件,Nki+1,out,Wki,影片,列入,换出,集,Sout,特定,换出,集中,影片,换出,Nki+1,大小,顺序,换入,集中,影片,依次,换入,磁盘,磁盘空间,空间,完,符合,Zipf,法则,随机,访问,序列,简单,模拟,替换,替换算法,换算,算法,效率,图,所示,显示,周期,频率,预测,替换,替换算法,换算,算法,PFP,命中,命中率,最高,FIFO,LRU,命中,命中率,低,差别,不大,FIFO,替换,替换法,换法,热门,影片,时间,推移,替换,换出,磁盘,cache,命中,命中率,最低,LRU,最近,最少,使用,影片,替换,换出,磁盘,cache,热门,影片,经常,使用,保留,留在,磁盘,cache,冷门,影片,一定,定会,替换,换入,磁盘,cache,必将,替换,换出,热门,影片,增加,替换,次数,降低,命中,命中率,访问,频率,算法,热门,影片,保留,留在,磁盘,cache,冷门,影片,访问,频率,低,不能,替换,换入,cache,不会,挤占,热门,影片,磁盘,磁盘空间,空间,命中,命中率,最高,

,图,替换,替换算法,换算,算法,性能,模拟,结束,结束语,大规,大规模,规模,VOD,系统,影片,数据,具有,访问,局部,局部性,利用,这种,访问,局部,局部性,提出,一种,层次,层次化,存储,存储体,存储体系,体系,VOD,影片,数据,访问,频率,变化,特性,开发,周期,频率,预测,替换,替换算法,换算,算法,PFP,这种,替换,替换算法,换算,算法,解决,LFU,算法,cache,污染,问题,模拟,模拟实验,实验,显示,LRU,算法,FIFO,算法,法相,相比,算法,效率,最高,VOD,层次,层次化,存储,存储系统,系统,统还,内容,需要,研究,磁盘,cache,大小,设置,后援,服务,服务器,务器,服务,策略,客户,访问,模型,对系统,系统,系统性,性能,影响,很大,目前,没有,精确,模型,描述,需要,进一步,一步,深入,研究,本文,研究,得到,并行,分布,处理,国家,重点,实验,实验室,基金,资助,本文,通讯,通讯联系,联系,联系人,李,勇,长沙,410073,长沙,工学,工学院,学院,计算,计算机,计算机系,算机,系,研究,研究生,队,作者,作者简介,简介,李,勇,1970,生,博士,博士生,主要,研究,领域,分布,分布式,布式,多媒体,媒体,高性,高性能,性能,视频,服务,服务器,务器,连续,媒体,网络,传输,吴,飞,1968,生,博士,博士后,主要,研究,领域,计算,计算机,算机,机组,组织,系统,系统结构,结构,分布,分布式,布式,多媒体,多媒体技术,媒体,技术,陈,福,1935,生,教授,博士,博士生,导师,主要,研究,领域,高性,高性能,性能,计算,计算机,算机,机体,体系,体系结构,结构,分布,分布式,布式,多媒体,多媒体技术,媒体,技术,作者,单位,长沙,工学,工学院,学院,计算,计算机,计算机系,算机,系,长沙,410073
Email,yli,nudt,edu,cn
,参考,参考文献,文献,Gemmell,D,J,et,al,Multimedia,storage,servers,a,tutorial,IEEE,Computer,1992,28,40,49
,Rangan,P,V,Vin,H,M,Ramanathan,Design,an,on,demand,multimedia,service,IEEE,Communication,Magazine,1994,30,56,64
,Lougher,P,Shepherd,D,The,design,of,a,storage,server,for,continuous,media,The,Computer,Journal,1993,36,32,42
,Banu,Ozden,Rajeev,Rastogi,Avi,Silberschatz,On,the,design,of,a,low,cost,video,on,demand,storage,system,Multimedia,System,1996,40,54
,Brubeck,D,W,Rowe,L,A,Hierarchical,storage,management,in,a,distributed,VOD,system,IEEE,Multimedia,1996,37,47
,吴,飞,陈,福,王,朴,一个,一个支,支持,并行,流,多媒体,媒体,服务,系统,软件,学报,1997,327,334
,Wu,Fei,Chen,Fu,jie,Wang,Pu,A,multimedia,service,system,supporting,parallel,streams,Journal,of,Software,1997,328,334,Ramakrisna,Karedla,Love,J,S,Wherry,B,G,Cacheing,strategies,to,improve,disk,system,performance,IEEE,Computer,1995,27,38,46
,本文,1998,01,22,收到,原稿,1998,05,04,收到,修改,修改稿,改稿